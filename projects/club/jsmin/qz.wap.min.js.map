{"version":3,"sources":["qz.wap.min.js","qz.wap.js"],"names":["pgMoredataUrl","pgMoredataUrlComm","pgMoredataUrlLike","pgMoredataAllTopic","qzConfig","isCanLoading","loadingDom","loadedDom","loadnullDom","qzFunc","setRem","pw","$","window","width","css","font-size","createCard","cdp","cardDom","cardid","head","user","vauth","editauth","createtime","spectop","specvalue","url","text","piclist","each","i","item","ext","origin","large","size","picbig","video","src","pic","fromUrl","from","countlike","countcomment","addSwpOnce","swp","append","photoSwp","initPhotoSwipeFromDOM","gallerySelector","parseThumbnailElements","el","figureEl","linkEl","thumbElements","childNodes","numNodes","length","items","nodeType","children","getAttribute","split","w","parseInt","h","ori","title","innerHTML","msrc","push","closest","fn","parentNode","onThumbnailsClick","e","event","preventDefault","returnValue","eTarget","target","srcElement","clickedListItem","tagName","toUpperCase","index","clickedGallery","numChildNodes","nodeIndex","openPhotoSwipe","galleryElement","disableAnimation","fromURL","setOrigin","num","attr","gallery","options","pswpElement","shareEl","fullscreenEl","zoomEl","bgOpacity","showHideOpacity","galleryUID","history","getThumbBoundsFn","thumbnail","getElementsByTagName","pageYScroll","pageYOffset","document","documentElement","scrollTop","rect","getBoundingClientRect","x","left","y","top","galleryPIDs","j","pid","isNaN","showAnimationDuration","PhotoSwipe","PhotoSwipeUI_Default","init","listen","getCurrentIndex","animate","opacity","galleryElements","querySelectorAll","l","setAttribute","onclick","insertCard","tar","dt","insDom","html","openVideoPop","appendCard","addContext","insertContext","scrolltopval","setAreaSize","$qzPop","find","on","val","textsth","scrollHeight","closePop","removeClass","setTimeout","remove","comDom","addClass","context","console","log","st","addComment","insertComment","cid","rename","placeholder","$this","this","data","count","open","addLike","initPage","tarInsert","ajax","dataType","beforeSend","success","fakeDate","page","cardgroup","initPageTopic","initPageContext","infiniteLoadCl","loadFunc","selid","nowPage","dataPage","fakeCommData","appendCardComment","commlist","fakeLikeData","appendCardLike","likelist","scrollJudge","dh","height","wh","scroll","commtar","commurl","insertCardComment","infiniteLoad","callback","topicMore","$moreBtn","tabNav","navFunc","fixNav","navTop","$navPos","offset","srlTop","$navWrap","scrollLoading","$html","hh","navSt","scrollLoaded","clearTimeout","loadedTimer","$nav","dataUrl","tarCon","tabCl","$con","liketar","likeurl","undefined","pageGoto","openId","stopPropagation","createCardComment","cmdt","commDom","commid","name","reply","replytime","createCardLike","lkdt","likeDom","likeid","insertCardLike","videoPop","vdsrc","$pop","popDom","vdurl","ykSign","ykIndexOfBegin","indexOf","ykIndexOfEnd","substring","createAllTopic","topicDom","id","countjoin","countcomm","allTopic","createList","listDom","$topicList","addList","getListData","dataOriUrl","listData","fakeAlltopic","data-page","data-infiload","topiclist","$main","main","resize"],"mappings":"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","file":"qz.wap.min.js","sourcesContent":["'use strict';\n\n/*\r\n * 开发完请删掉console.log()和注释！\r\n * 开发完请删掉console.log()和注释！\r\n * 开发完请删掉console.log()和注释！\r\n * 开发完请删掉console.log()和注释！\r\n * 开发完请删掉console.log()和注释！\r\n * **2017.11.22 更新查看原图\r\n * **v0.0.2 begin\r\n * **qzFunc.createCard,qzFunc.addSwpOnce,qzFunc.photoSwp 三个函数有修改\r\n * **v0.0.2 end\r\n * **2017.11.23 更新 全部话题 创建及无限加载\r\n * **v0.0.3 begin\r\n * **qzFunc.createAllTopic,qzFunc.allTopic 二个函数新增\r\n * **v0.0.3 end\r\n * **2017.11.27 更新 优酷标题调用\r\n * **v0.0.4 begin\r\n * **qzFunc.createAllTopic,qzFunc.allTopic 二个函数新增\r\n * **v0.0.4 end\r\n */\n(function () {\n    //模拟加载更多用测试数据begin\n    var pgMoredataUrl = 'http://j.gamersky.com/user/club/wap/data/fake.data.pg2.js';\n    var pgMoredataUrlComm = 'http://j.gamersky.com/user/club/wap/data/fake.comm.pg2.js';\n    var pgMoredataUrlLike = 'http://j.gamersky.com/user/club/wap/data/fake.like.pg2.js';\n    var pgMoredataAllTopic = 'http://j.gamersky.com/user/club/wap/data/fake.alltopic.pg2.js';\n    //模拟加载更多用测试数据end\n    var qzConfig = {\n        // 判断是否开始无限加载\n        isCanLoading: true,\n        //加载中 结构\n        loadingDom: '<div class=\"qz-loading\">正在加载</div>',\n        //全部加载完成 结构\n        loadedDom: '<div class=\"qz-loaded\">全部加载完成</div>',\n        //内容为空 结构\n        loadnullDom: '<div class=\"qz-loadnull\">还没有内容</div>'\n    };\n    var qzFunc = {\n        //设置屏幕缩放\n        setRem: function setRem() {\n            var pw = $(window).width();\n            if (pw >= 640) {\n                pw = 640;\n            }\n            $('html').css({ 'font-size': pw / 6.4 + 'px' });\n        },\n        //构建卡片\n        createCard: function createCard(cdp) {\n            var cardDom = '';\n            //插入卡片ID cdp.cardid\n            cardDom += '<div class=\"qz-card qzCard\" data-cid=\"' + cdp.cardid + '\">';\n            //头部 begin\n            //插入用户头像 cdp.head\n            cardDom += '<header><a class=\"head\"><img src=\"' + cdp.head + '\" alt=\"head\"></a>';\n            cardDom += '<div class=\"info\"><h5>';\n            //插入用户名 cdp.user\n            cardDom += '<a>' + cdp.user + '</a>';\n            //是否加V图标\n            if (cdp.vauth === true) {\n                cardDom += '<i class=\"member member-v1\"></i>';\n            }\n            //是否加编辑V图标\n            if (cdp.editauth === true) {\n                cardDom += '<i class=\"member member-v2\"></i>';\n            }\n            cardDom += '</h5><p>';\n            //插入创建时间 cdp.createtime\n            cardDom += '<span class=\"time\">' + cdp.createtime + '</span>';\n            cardDom += '</p>';\n            cardDom += '</div>';\n            //是否加置顶 cdp.spectop 和 精 cdp.specvalue 图标\n            if (cdp.spectop === true || cdp.specvalue === true) {\n                cardDom += '<div class=\"spec-icons\">';\n                if (cdp.spectop === true) {\n                    cardDom += '<a class=\"spec-top\">置顶</a>';\n                }\n                if (cdp.specvalue === true) {\n                    cardDom += '<a class=\"spec-value\">精</a>';\n                }\n                cardDom += '</div>';\n            }\n            cardDom += '</header>';\n            //头部 end\n            //主体 begin\n            //插入卡片跳转地址 cdp.url\n            cardDom += '<section class=\"detail qzZoneHref\" data-href=\"' + cdp.url + '\">';\n            //插入卡片内容 cdp.text\n            cardDom += '<div class=\"content\">' + cdp.text + '</div>';\n            //判断 插入 图片列表 cdp.piclist\n            if (cdp.piclist) {\n                cardDom += '<div class=\"media-pic-list\"><div class=\"clearfix qz-figs qzPicPswp\">';\n                $.each(cdp.piclist, function (i, item) {\n                    cardDom += '<figure class=\"qzPicPswpBtn';\n                    //输出数据文件中的图片样式item.ext\n                    if (item.ext === 'gif') {\n                        cardDom += ' gif\"';\n                    } else if (item.ext === 'long') {\n                        cardDom += ' long\"';\n                    }\n                    //原始图像地址item.origin，大图地址item.large,尺寸item.size,缩略图地址item.url\n                    cardDom += '\"><a data-origin=\"http://www.gamersky.com/showimage/id_gamersky.shtml?' + item.origin + '\"  data-large=\"' + item.large + '\" data-size=\"' + item.size + '\"><img src=\"' + item.url + '\"></a></figure>';\n                });\n                cardDom += '</div></div>';\n            }\n            //判断是否插入大图\n            if (cdp.picbig) {\n                cardDom += '<div class=\"qzPicPswp media-pic\"><figure class=\"';\n                //输出数据文件中的图片样式 item.ext\n                if (cdp.picbig.ext === 'gif') {\n                    cardDom += ' gif';\n                } else if (cdp.picbig.ext === 'long') {\n                    cardDom += ' long';\n                }\n                //原始图像地址cdp.picbig.large，大图地址cdp.picbig.large,尺寸cdp.picbig.size,缩略图地址cdp.picbig.url\n                cardDom += '\"><a data-origin=\"http://www.gamersky.com/showimage/id_gamersky.shtml?' + cdp.picbig.origin + '\" data-large=\"' + cdp.picbig.large + '\" data-size=\"' + cdp.picbig.size + '\"><img src=\"' + cdp.picbig.url + '\" class=\"qzPicPswpBtn\"></a></figure></div>';\n            }\n            //判断是否插入视频\n            if (cdp.video) {\n                cardDom += '<div class=\"media-video';\n                //视频跳转地址 cdp.video.src,视频缩略图 cdp.video.pic\n                cardDom += '\"><a class=\"qzVideoPopBtn\" data-href=\"' + cdp.video.src + '\"><img src=\"' + cdp.video.pic + '\" alt=\"\"></a></div>';\n            }\n            cardDom += '</section>';\n            //判断是否输出来源\n            if (cdp.fromUrl) {\n                //来源地址cdp.fromUrl,来源名称cdp.from\n                cardDom += '<div class=\"from\">来自：<a href=\"' + cdp.fromUrl + '\">' + cdp.from + '</a></div>';\n            }\n            //主体 end\n            //底部 begin\n            cardDom += '<footer>';\n            //点赞数cdp.countlike\n            cardDom += '<a class=\"btn-like qzBtnLike\" data-likecount=\"' + cdp.countlike + '\"><i></i><b>' + cdp.countlike + '</b></a><span></span>';\n            //评论数 cdp.countcomment,卡片ID cdp.cardid\n            cardDom += '<a class=\"btn-comment qzBtnComment\" data-commcount=\"' + cdp.countcomment + '\" data-commid=\"' + cdp.cardid + '\"  data-href=\"' + cdp.url + '\">' + cdp.countcomment + '</a>';\n            cardDom += '</footer>';\n            //底部 end\n            cardDom += '</div>';\n            cardDom += '';\n            cardDom += '';\n\n            return cardDom;\n        },\n        //图片弹出层 默认执行,一般情况不需要修改\n        addSwpOnce: function addSwpOnce() {\n            var swp = '<div class=\"pswp\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"pswp__bg\"></div><div class=\"pswp__scroll-wrap\"><div class=\"pswp__container\"><div class=\"pswp__item\"></div><div class=\"pswp__item\"></div><div class=\"pswp__item\"></div></div><div class=\"pswp__ui pswp__ui--hidden\"><div class=\"pswp__top-bar\"><div class=\"pswp__counter\"></div><button class=\"pswp__button pswp__button--close\" title=\"Close (Esc)\"></button><a class=\"pswp__button pswpBtnOrigin pswp__single-tap\" title=\"查看原图\"></a> <button class=\"pswp__button pswp__button--share\" title=\"Share\"></button> <button class=\"pswp__button pswp__button--fs\" title=\"Toggle fullscreen\"></button> <button class=\"pswp__button pswp__button--zoom\" title=\"Zoom in/out\"></button><div class=\"pswp__preloader\"><div class=\"pswp__preloader__icn\"><div class=\"pswp__preloader__cut\"><div class=\"pswp__preloader__donut\"></div></div></div></div></div><div class=\"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\"><div class=\"pswp__share-tooltip\"></div></div><button class=\"pswp__button pswp__button--arrow--left\" title=\"Previous (arrow left)\"></button> <button class=\"pswp__button pswp__button--arrow--right\" title=\"Next (arrow right)\"></button><div class=\"pswp__caption\"><div class=\"pswp__caption__center\"></div></div></div></div></div>';\n            $('body').append(swp);\n        },\n        //图片弹出层方法 默认执行,一般情况不需要修改\n        photoSwp: function photoSwp() {\n            var initPhotoSwipeFromDOM = function initPhotoSwipeFromDOM(gallerySelector) {\n                var parseThumbnailElements = function parseThumbnailElements(el) {\n                    var thumbElements = el.childNodes,\n                        numNodes = thumbElements.length,\n                        items = [],\n                        figureEl,\n                        linkEl,\n                        size,\n                        item;\n                    for (var i = 0; i < numNodes; i++) {\n                        figureEl = thumbElements[i];\n                        if (figureEl.nodeType !== 1) {\n                            continue;\n                        }\n                        linkEl = figureEl.children[0];\n                        size = linkEl.getAttribute('data-size').split('x');\n                        item = {\n                            src: linkEl.getAttribute('data-large'),\n                            w: parseInt(size[0], 10),\n                            h: parseInt(size[1], 10),\n                            ori: linkEl.getAttribute('data-origin')\n                        };\n                        if (figureEl.children.length > 1) {\n                            item.title = figureEl.children[1].innerHTML;\n                        }\n                        if (linkEl.children.length > 0) {\n                            item.msrc = linkEl.children[0].getAttribute('src');\n                        }\n                        item.el = figureEl;\n                        items.push(item);\n                    }\n                    return items;\n                };\n                var closest = function closest(el, fn) {\n                    return el && (fn(el) ? el : closest(el.parentNode, fn));\n                };\n                var onThumbnailsClick = function onThumbnailsClick(e) {\n                    e = e || window.event;\n                    e.preventDefault ? e.preventDefault() : e.returnValue = false;\n                    var eTarget = e.target || e.srcElement;\n                    var clickedListItem = closest(eTarget, function (el) {\n                        return el.tagName && el.tagName.toUpperCase() === 'FIGURE';\n                    });\n                    if (!clickedListItem) {\n                        return;\n                    }\n                    var clickedGallery = clickedListItem.parentNode,\n                        childNodes = clickedListItem.parentNode.childNodes,\n                        numChildNodes = childNodes.length,\n                        nodeIndex = 0,\n                        index;\n                    for (var i = 0; i < numChildNodes; i++) {\n                        if (childNodes[i].nodeType !== 1) {\n                            continue;\n                        }\n                        if (childNodes[i] === clickedListItem) {\n                            index = nodeIndex;\n                            break;\n                        }\n                        nodeIndex++;\n                    }\n                    if (index >= 0) {\n                        openPhotoSwipe(index, clickedGallery);\n                    }\n                    return false;\n                };\n\n                var openPhotoSwipe = function openPhotoSwipe(index, galleryElement, disableAnimation, fromURL) {\n                    var pswpElement = $('.pswp')[0],\n                        gallery,\n                        options,\n                        items;\n                    items = parseThumbnailElements(galleryElement);\n                    options = {\n                        shareEl: false,\n                        fullscreenEl: false,\n                        zoomEl: false,\n                        bgOpacity: 1,\n                        showHideOpacity: 0,\n                        galleryUID: galleryElement.getAttribute('data-pswp-uid'),\n                        history: false,\n                        getThumbBoundsFn: function getThumbBoundsFn(index) {\n                            var thumbnail = items[index].el.getElementsByTagName('img')[0],\n                                pageYScroll = window.pageYOffset || document.documentElement.scrollTop,\n                                rect = thumbnail.getBoundingClientRect();\n                            return { x: rect.left, y: rect.top + pageYScroll, w: rect.width };\n                        }\n                    };\n                    if (fromURL) {\n                        if (options.galleryPIDs) {\n                            for (var j = 0; j < items.length; j++) {\n                                if (items[j].pid == index) {\n                                    options.index = j;\n                                    break;\n                                }\n                            }\n                        } else {\n                            options.index = parseInt(index, 10) - 1;\n                        }\n                    } else {\n                        options.index = parseInt(index, 10);\n                    }\n                    if (isNaN(options.index)) {\n                        return;\n                    }\n                    if (disableAnimation) {\n                        options.showAnimationDuration = 0;\n                    }\n                    gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);\n                    gallery.init();\n                    function setOrigin(num) {\n                        $('.pswpBtnOrigin').attr('href', items[num].ori);\n                    }\n                    gallery.listen('initialZoomIn', function () {\n                        setOrigin(gallery.getCurrentIndex());\n                        $('.pswp').animate({ 'opacity': 1 }, 333);\n                    });\n                    gallery.listen('initialZoomOut', function () {\n                        $('.pswp').animate({ 'opacity': 0 }, 200);\n                    });\n                    gallery.listen('afterChange', function () {\n                        setOrigin(gallery.getCurrentIndex());\n                    });\n                };\n                var galleryElements = document.querySelectorAll(gallerySelector);\n                for (var i = 0, l = galleryElements.length; i < l; i++) {\n                    galleryElements[i].setAttribute('data-pswp-uid', i + 1);\n                    galleryElements[i].onclick = onThumbnailsClick;\n                }\n            };\n            initPhotoSwipeFromDOM('.qzPicPswp');\n        },\n        //插入卡片\n        insertCard: function insertCard(tar, dt) {\n            var insDom = '';\n            $.each(dt, function (i, item) {\n                //使用返回数据 构建卡片\n                insDom += qzFunc.createCard(item);\n            });\n            $(tar).html(insDom);\n            //构建完成后调用图片弹出层\n            qzFunc.photoSwp();\n            //开启视频弹窗\n            qzFunc.openVideoPop();\n        },\n        //加载更多卡片\n        appendCard: function appendCard(tar, dt) {\n            var insDom = '';\n            $.each(dt, function (i, item) {\n                //使用返回数据 构建卡片\n                insDom += qzFunc.createCard(item);\n            });\n            $(tar).append(insDom);\n            //构建完成后调用图片弹出层\n            qzFunc.photoSwp();\n            //开启视频弹窗\n            qzFunc.openVideoPop();\n        },\n        //发布/参与\n        addContext: function addContext() {\n            function insertContext(scrolltopval) {\n                var comDom = '';\n                comDom += '<div class=\"qz-pop qzPop\">';\n                comDom += '<header>发布内容<a class=\"qz-pop-close qzPopClose\"></a><a class=\"qz-pop-smt qzPopSmt\">发布</a></header>';\n                comDom += '<div class=\"pop-con\">';\n                comDom += '<div class=\"pop-srl\"><textarea class=\"realIpt\" placeholder=\"分享你的游戏心得...\"></textarea><textarea class=\"mathIpt\" rows=\"3\"></textarea></div>';\n                //上传图片后显示，不传图片不显示 begin\n                comDom += '<div class=\"clearfix qz-pic-list\">';\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://imgs.gamersky.com/pic/2017/20171102_zy_164_666.jpg\"><a class=\"qz-img-remove\"></a></div>';\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://img1.gamersky.com/image2017/11/20171105_gtz_412_2/gamersky_04origin_07_2017115106F5F.jpg\"><a class=\"qz-img-remove\"></a></div>';\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://img1.gamersky.com/image2017/11/20171105_gtz_412_1/gamersky_02small_04_20171159476F0.jpg\"><a class=\"qz-img-remove\"></a></div>';\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://img1.gamersky.com/image2017/11/20171105_gtz_412_1/gamersky_03small_06_2017115947DAC.jpg\"><a class=\"qz-img-remove\"></a></div>';\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://img1.gamersky.com/image2017/11/20171105_gtz_412_1/gamersky_01small_02_2017115947F5B.jpg\"><a class=\"qz-img-remove\"></a></div>';\n                comDom += '<div class=\"qz-pic-list-li\"><label for=\"qzSelectPhoto\" class=\"qz-pic-list-add\"></label></div>';\n                comDom += '</div>';\n                //上传图片后显示，不传图片不显示 end\n                comDom += '</div>';\n                comDom += '<footer><label for=\"qzSelectPhoto\" class=\"qz-upload-pic qzUploadPic\">图片</label><select class=\"qz-pop-sel\">';\n                //右下角选项\n                comDom += '<option value=\"\">发往圈子</option>';\n                comDom += '<option value=\"\">发往gamersky</option>';\n                comDom += '<option value=\"\">发往游民之家</option>';\n                comDom += '<option value=\"\">发往圈子3</option>';\n                comDom += '</select>';\n                //隐藏的上传input\n                comDom += '<input id=\"qzSelectPhoto\" class=\"qz-select-photo\" type=\"file\" accept=\"image/gif,image/jpeg,image/jpg,image/png,image/bmp\">';\n                comDom += '</footer></div>';\n                //输出弹层\n                $('body').append(comDom);\n                var $qzPop = $('.qzPop');\n                //添加弹层动画\n                setTimeout(function () {\n                    $qzPop.addClass('cur');\n                }, 10);\n                //设置textarea尺寸\n                function setAreaSize() {\n                    $qzPop.find('.realIpt').on('input', function () {\n                        $qzPop.find('.mathIpt').val($qzPop.find('.realIpt').val());\n                        var textsth = $qzPop.find('.mathIpt')[0].scrollHeight;\n                        $qzPop.find('.realIpt').css('height', textsth);\n                    });\n                }\n                setAreaSize();\n                //关闭弹层\n                function closePop() {\n                    $qzPop.removeClass('cur');\n                    $('html,body').removeClass('hideScroll').animate({ scrollTop: scrolltopval }, 0);\n                    //等待弹层动画执行完后移除弹层\n                    setTimeout(function () {\n                        $qzPop.remove();\n                    }, 250);\n                }\n                //关闭按钮\n                $('.qzPopClose').on('click', closePop);\n                //发布按钮\n                $('.qzPopSmt').on('click', function () {\n                    var context = $qzPop.find('.realIpt').val();\n                    //数据提交后执行下面函数\n                    console.log('发布成功:' + context);\n                    closePop();\n                });\n            }\n            //绑定发布按钮事件\n            $('#qzMain').on('click', '.qzBtnContext', function () {\n                var st = $('html').scrollTop();\n                if (st === 0) {\n                    st = $('body').scrollTop();\n                }\n                setTimeout(function () {\n                    $('html,body').addClass('hideScroll');\n                }, 300);\n                //打开弹层\n                insertContext(st);\n            });\n        },\n        //评论\n        addComment: function addComment() {\n            function insertComment(scrolltopval, cid, rename) {\n                var comDom = '',\n                    placeholder = rename ? '回复 ' + rename + '：' : '我来说两句...';\n                comDom += '<div class=\"qz-pop qzPop\">';\n                comDom += '<header>评论<a class=\"qz-pop-close qzPopClose\"></a><a class=\"qz-pop-smt qzPopSmt\">发布</a></header>';\n                comDom += '<div class=\"pop-con\"><div class=\"pop-srl\"><textarea class=\"realIpt\" placeholder=\"' + placeholder + '\"></textarea><textarea class=\"mathIpt\" rows=\"3\"></textarea></div></div>';\n                comDom += '</div>';\n                $('body').append(comDom);\n                var $qzPop = $('.qzPop');\n                setTimeout(function () {\n                    $qzPop.addClass('cur');\n                }, 10);\n                //设置textarea尺寸\n                function setAreaSize() {\n                    $qzPop.find('.realIpt').on('input', function () {\n                        $qzPop.find('.mathIpt').val($qzPop.find('.realIpt').val());\n                        var textsth = $qzPop.find('.mathIpt')[0].scrollHeight;\n                        $qzPop.find('.realIpt').css('height', textsth);\n                    });\n                }\n                setAreaSize();\n\n                console.log('给 cid = ' + cid + ' 评论添加评论 *** cid 为按钮传入的评论卡片id,供开发使用');\n                function closePop() {\n                    $qzPop.removeClass('cur');\n                    $('html,body').removeClass('hideScroll').animate({ scrollTop: scrolltopval }, 0);\n                    setTimeout(function () {\n                        $qzPop.remove();\n                    }, 250);\n                }\n                //关闭按钮\n                $('.qzPopClose').on('click', closePop);\n                //发布按钮\n                $('.qzPopSmt').on('click', function () {\n                    var context = $qzPop.find('.realIpt').val();\n                    //数据提交后执行下面函数\n                    console.log('cid:' + cid + ',发布成功:' + context);\n                    closePop();\n                });\n            }\n\n            $('#qzMain').on('click', '.qzBtnComment', function () {\n                var st = $('html').scrollTop(),\n                    $this = $(this),\n                    cid = $this.data('commid'),\n\n                //评论数量\n                count = $this.data('commcount'),\n\n                //单页卡片地址\n                url = $this.data('href'),\n\n                //回复的用户名\n                rename = $this.attr('data-name');\n                //判断是否单页 单页直接打开弹层，不判断评论数\n                if ($('#qzCardContext').length > 0) {\n                    if (st === 0) {\n                        st = $('body').scrollTop();\n                    }\n                    setTimeout(function () {\n                        $('html,body').addClass('hideScroll');\n                    }, 300);\n                    //打开弹层\n                    insertComment(st, cid, rename);\n                    return false;\n                }\n                if (count === 0) {\n                    if (st === 0) {\n                        st = $('body').scrollTop();\n                    }\n                    setTimeout(function () {\n                        $('html,body').addClass('hideScroll');\n                    }, 300);\n                    //打开弹层\n                    insertComment(st, cid);\n                } else {\n                    //如果评论数不为0 跳转到卡片单页\n                    //window.location.href = url;\n                    window.open(url, '_blank');\n                }\n            });\n        },\n        //点赞\n        addLike: function addLike() {\n            $('#qzMain').on('click', '.qzBtnLike', function () {\n                var $this = $(this),\n                    cid = $this.closest('.qzCard').data('cid'),\n\n                //赞的数量\n                count = $this.attr('data-likecount');\n                //判断是否喜欢过,data-islike=1为点过赞，再次点击删除赞，同时设置data-islike=0\n                if (parseInt($this.attr('data-islike')) === 1) {\n                    //删除赞 数据提交后回调\n                    $this.removeClass('cur').attr('data-islike', '0').attr('data-likecount', parseInt(count) - 1).find('b').html(parseInt(count) - 1);\n                    console.log('删除赞');\n                } else {\n                    //添加赞数 据提交后回调\n                    $this.addClass('cur').attr('data-islike', '1').attr('data-likecount', parseInt(count) + 1).find('b').html(parseInt(count) + 1);\n                    console.log('喜欢了 cid = ' + cid + ' 的卡片 *** cid 为按钮传入的卡片id,供开发使用');\n                }\n            });\n        },\n        //初始化内容 卡片列表\n        initPage: function initPage() {\n            var tar = '#qzCardList',\n                tarInsert = $(tar);\n            if (tarInsert.length > 0) {\n                //获取数据，具体参数和方式后端自定义\n                var dt = tarInsert.data('from');\n                $.ajax({\n                    dataType: 'Script',\n                    url: dt,\n                    beforeSend: function beforeSend() {\n                        //插入加载动画\n                        tarInsert.append(qzConfig.loadingDom);\n                    },\n                    success: function success() {\n                        //判断数据状态\n                        if (fakeDate.dataType === 'ok') {\n                            //处理获取的数据\n                            tarInsert.attr('data-page', fakeDate.page);\n                            //允许无限加载\n                            tarInsert.attr('data-infiload', 'open');\n                            qzFunc.insertCard(tar, fakeDate.cardgroup);\n                        } else {\n                            //数据为空是插入提示\n                            tarInsert.html(qzConfig.loadnullDom);\n                        }\n                    }\n                });\n            }\n        },\n        //初始化内容 话题上部\n        initPageTopic: function initPageTopic() {\n            var tar = '#qzCardListTopic',\n                tarInsert = $(tar);\n            if (tarInsert.length > 0) {\n                //获取数据，具体参数和方式后端自定义\n                var dt = tarInsert.data('from');\n                $.ajax({\n                    dataType: 'Script',\n                    url: dt,\n                    beforeSend: function beforeSend() {\n                        //插入加载动画\n                        tarInsert.append(qzConfig.loadingDom);\n                    },\n                    success: function success() {\n                        //判断数据状态\n                        if (fakeDate.dataType === 'ok') {\n                            //处理获取的数据\n                            tarInsert.attr('data-page', fakeDate.page);\n                            //允许无限加载\n                            tarInsert.attr('data-moreload', 'open');\n                            qzFunc.insertCard(tar, fakeDate.cardgroup);\n                        } else {\n                            //数据为空是插入提示\n                            tarInsert.html(qzConfig.loadnullDom);\n                        }\n                    }\n                });\n            }\n        },\n        //初始化内容 内容单页\n        initPageContext: function initPageContext() {\n            var tar = '#qzCardContext',\n                tarInsert = $(tar);\n            if (tarInsert.length > 0) {\n                //评论/赞 无限加载\n                var infiniteLoadCl = function infiniteLoadCl() {\n                    function loadFunc() {\n                        var selid = $('.qzClCon.cur').attr('id'),\n                            tar,\n                            tarInsert;\n                        if (selid === 'qzClComment') {\n                            tar = '#qzClComment';\n                            tarInsert = $(tar);\n                            if (tarInsert.attr('data-infiload') === 'open') {\n                                $.ajax({\n                                    dataType: 'Script',\n                                    url: pgMoredataUrlComm,\n                                    beforeSend: function beforeSend() {\n                                        //插入加载动画\n                                        tarInsert.append(qzConfig.loadingDom);\n                                    },\n                                    success: function success() {\n                                        var nowPage = tarInsert.attr('data-page'),\n                                            dataPage = fakeCommData.page;\n                                        //加载成功后移除加载动画\n                                        tarInsert.find('.qz-loading').remove();\n                                        //判断时候还有当前数据页码是否加载完成\n                                        if (dataPage > nowPage) {\n                                            //设置新页码\n                                            tarInsert.attr('data-page', dataPage);\n                                            //插入更多数据\n                                            qzFunc.appendCardComment(tar, fakeCommData.commlist);\n                                        } else {\n                                            if (tarInsert.attr('data-infiload') === 'open') {\n                                                //全部加载完成 关闭加载\n                                                tarInsert.attr('data-infiload', 'close');\n                                                //插入 全部加载完成 提示\n                                                tarInsert.append(qzConfig.loadedDom);\n                                            }\n                                        }\n                                        qzConfig.isCanLoading = true;\n                                    }\n                                });\n                            } else {\n                                qzConfig.isCanLoading = true;\n                            }\n                        } else if (selid === 'qzClLike') {\n                            tar = '#qzClLike';\n                            tarInsert = $(tar);\n                            if (tarInsert.attr('data-infiload') === 'open') {\n                                $.ajax({\n                                    dataType: 'Script',\n                                    url: pgMoredataUrlLike,\n                                    beforeSend: function beforeSend() {\n                                        //插入加载动画\n                                        tarInsert.append(qzConfig.loadingDom);\n                                    },\n                                    success: function success() {\n                                        var nowPage = tarInsert.attr('data-page'),\n                                            dataPage = fakeLikeData.page;\n                                        //加载成功后移除加载动画\n                                        tarInsert.find('.qz-loading').remove();\n                                        //判断时候还有当前数据页码是否加载完成\n                                        if (dataPage > nowPage) {\n                                            //设置新页码\n                                            tarInsert.attr('data-page', dataPage);\n                                            //插入更多数据\n                                            qzFunc.appendCardLike(tar, fakeLikeData.likelist);\n                                        } else {\n                                            if (tarInsert.attr('data-infiload') === 'open') {\n                                                //全部加载完成 关闭加载\n                                                tarInsert.attr('data-infiload', 'close');\n                                                //插入 全部加载完成 提示\n                                                tarInsert.append(qzConfig.loadedDom);\n                                            }\n                                        }\n                                        qzConfig.isCanLoading = true;\n                                    }\n                                });\n                            } else {\n                                qzConfig.isCanLoading = true;\n                            }\n                        }\n                    }\n                    function scrollJudge() {\n                        var st = $('html').scrollTop(),\n                            dh = $(document).height(),\n                            wh = $(window).height();\n                        if (st === 0) {\n                            st = $('body').scrollTop();\n                        }\n                        if (st > dh - wh - 20 && st > wh - dh && qzConfig.isCanLoading === true) {\n                            qzConfig.isCanLoading = false;\n                            loadFunc();\n                        }\n                    }\n                    if ($(tar).length > 0) {\n                        $(window).scroll(function () {\n                            scrollJudge();\n                        });\n                    }\n                };\n\n                //获取数据，具体参数和方式后端自定义\n                var dt = tarInsert.data('from');\n                $.ajax({\n                    dataType: 'Script',\n                    url: dt,\n                    beforeSend: function beforeSend() {\n                        //插入加载动画\n                        tarInsert.append(qzConfig.loadingDom);\n                    },\n                    success: function success() {\n                        //判断数据状态\n                        if (fakeDate.dataType === 'ok') {\n                            //处理获取的数据\n                            tarInsert.attr('data-page', fakeDate.page);\n                            qzFunc.insertCard(tar, fakeDate.cardgroup);\n                        } else {\n                            //数据为空是插入提示\n                            tarInsert.html(qzConfig.loadnullDom);\n                        }\n                    }\n                });\n                var commtar = '#qzClComment',\n                    commurl = $(commtar).data('from');\n                $.ajax({\n                    dataType: 'Script',\n                    url: commurl,\n                    beforeSend: function beforeSend() {\n                        //插入加载动画\n                        $(commtar).append(qzConfig.loadingDom);\n                    },\n                    success: function success() {\n                        //判断数据状态\n                        if (fakeCommData.dataType === 'ok') {\n                            //处理获取的数据\n                            $(commtar).attr('data-page', fakeCommData.page);\n                            $(commtar).attr('data-infiload', 'open');\n                            qzFunc.insertCardComment(commtar, fakeCommData.commlist);\n                        } else {\n                            //数据为空时插入提示\n                            $(commtar).html(qzConfig.loadnullDom);\n                        }\n                    }\n                });\n                infiniteLoadCl();\n            }\n        },\n        //无限加载\n        infiniteLoad: function infiniteLoad(tar, callback) {\n            function loadFunc() {\n                var tarInsert = $(tar);\n                //判断列表是否开启无限加载\n                if (tarInsert.attr('data-infiload') === 'open') {\n                    //获取数据，具体参数和方式后端自定义\n                    if (typeof callback === 'function') {\n                        callback(tar, tarInsert);\n                    }\n                }\n            }\n            function scrollJudge() {\n                var st = $('html').scrollTop(),\n                    dh = $(document).height(),\n                    wh = $(window).height();\n                if (st === 0) {\n                    st = $('body').scrollTop();\n                }\n                if (st > dh - wh - 20 && st > wh - dh && qzConfig.isCanLoading === true) {\n                    qzConfig.isCanLoading = false;\n                    loadFunc();\n                }\n            }\n            if ($(tar).length > 0) {\n                $(window).scroll(function () {\n                    scrollJudge();\n                });\n            }\n        },\n        //话题页上部加载更多按钮\n        topicMore: function topicMore() {\n            var $moreBtn = $('.qzCardMoreBtn');\n            $moreBtn.on('click', function () {\n                var tarInsert = $('#qzCardListTopic');\n                //判断列表是否开启查看更多\n                if (tarInsert.length > 0 && tarInsert.attr('data-moreload') === 'open') {\n                    //获取数据，具体参数和方式后端自定义\n                    $.ajax({\n                        dataType: 'Script',\n                        url: pgMoredataUrl,\n                        beforeSend: function beforeSend() {\n                            //插入加载动画\n                            tarInsert.append(qzConfig.loadingDom);\n                        },\n                        success: function success() {\n                            var nowPage = tarInsert.attr('data-page'),\n                                dataPage = fakeDate.page;\n                            //加载成功后移除加载动画\n                            tarInsert.find('.qz-loading').remove();\n                            //判断时候还有当前数据页码是否加载完成\n                            if (dataPage > nowPage) {\n                                //设置新页码\n                                tarInsert.attr('data-page', dataPage);\n                                //插入更多数据\n                                qzFunc.appendCard('#qzCardListTopic', fakeDate.cardgroup);\n                            } else {\n                                if (tarInsert.attr('data-moreload') === 'open') {\n                                    //全部加载完成 关闭加载\n                                    tarInsert.attr('data-moreload', 'close');\n                                    //按钮 改变提示文字\n                                    $moreBtn.html('全部加载完成');\n                                }\n                            }\n                        }\n                    });\n                }\n            });\n        },\n        //列表切换\n        tabNav: function tabNav() {\n            function navFunc() {\n                var $nav = $('.qzNavFx'),\n\n                //浮动导航层\n                $navWrap = $('.qzNavFxW'),\n\n                //固定不动的占位导航\n                $navPos = $('.qzNavPos'),\n                    loadedTimer;\n                //判断滚动距离添加浮动导航\n                function fixNav() {\n                    var navTop = $navPos.offset().top,\n                        srlTop = $('html').scrollTop();\n                    if (srlTop === 0) {\n                        srlTop = $('body').scrollTop();\n                    }\n                    if (srlTop >= navTop) {\n                        $navWrap.addClass('openQzNavFixed');\n                    } else {\n                        $navWrap.removeClass('openQzNavFixed');\n                    }\n                }\n                fixNav();\n                $(window).scroll(function () {\n                    fixNav();\n                });\n                //加载tab内容前 页面位置\n                function scrollLoading() {\n                    var $html = $('html'),\n                        hh = $html.height(),\n                        navSt = $navPos.offset().top,\n                        srlTop = $html.scrollTop();\n                    if (srlTop === 0) {\n                        srlTop = $('body').scrollTop();\n                    }\n                    $html.css('height', hh);\n                    if (srlTop > navSt) {\n                        $('html,body').animate({ scrollTop: navSt }, 0);\n                    }\n                }\n                //加载tab内容后 页面位置\n                function scrollLoaded() {\n                    var $html = $('html');\n                    clearTimeout(loadedTimer);\n                    loadedTimer = setTimeout(function () {\n                        $html.css('height', '');\n                    }, 200);\n                }\n                //点击切换绑定事件\n                $nav.find('a').on('click', function () {\n                    var $this = $(this),\n                        dataUrl = $this.data('from'),\n                        tarCon = '#qzCardList';\n                    //设置按钮点击后样式\n                    $nav.find('a').removeClass('cur');\n                    $this.addClass('cur');\n                    //获取数据，具体参数和方式后端自定义\n                    $.ajax({\n                        dataType: 'Script',\n                        url: dataUrl,\n                        beforeSend: function beforeSend() {\n                            scrollLoading();\n                            //关闭其他加载\n                            qzConfig.isCanLoading = false;\n                            //插入加载动画\n                            $(tarCon).html(qzConfig.loadingDom);\n                        },\n                        success: function success() {\n                            qzConfig.isCanLoading = true;\n                            //判断数据状态\n                            if (fakeDate.dataType === 'ok') {\n                                //插入当前页码\n                                $(tarCon).attr('data-page', fakeDate.page);\n                                //是否开启无限加载\n                                $(tarCon).attr('data-infiload', 'open');\n                                qzFunc.insertCard(tarCon, fakeDate.cardgroup);\n                            } else {\n                                //数据为空是插入提示\n                                $(tarCon).html(qzConfig.loadnullDom);\n                            }\n                            scrollLoaded();\n                        }\n                    });\n                });\n            }\n            if ($('.qzNavFx').length > 0) {\n                navFunc();\n            }\n        },\n        //内容单页赞-评论切换\n        tabCl: function tabCl() {\n            var $nav = $('.tabNavCl'),\n                $con = $('.qzClCon');\n            $nav.find('a').on('click', function () {\n                var $this = $(this),\n                    tar = $this.data('tar');\n                $nav.find('a').removeClass('cur');\n                $con.removeClass('cur');\n                $this.addClass('cur');\n                $('.' + tar).addClass('cur');\n                //数据获取后端自定义\n                if (tar === 'qzClLike') {\n                    var liketar = '#qzClLike',\n                        likeurl = $(liketar).data('from');\n                    if ($(liketar).attr('data-page') === undefined) {\n                        $.ajax({\n                            dataType: 'Script',\n                            url: likeurl,\n                            beforeSend: function beforeSend() {\n                                //插入加载动画\n                                $(liketar).append(qzConfig.loadingDom);\n                            },\n                            success: function success() {\n                                $(liketar).find('.qz-loading').remove();\n                                //判断数据状态\n                                if (fakeLikeData.dataType === 'ok') {\n                                    //处理获取的数据\n                                    $(liketar).attr('data-page', fakeLikeData.page);\n                                    $(liketar).attr('data-infiload', 'open');\n                                    qzFunc.appendCardLike(liketar, fakeLikeData.likelist);\n                                } else {\n                                    //数据为空时插入提示\n                                    $(commtar).html(qzConfig.loadnullDom);\n                                }\n                            }\n                        });\n                    }\n                }\n            });\n        },\n        //单页跳转\n        pageGoto: function pageGoto() {\n            var openId = $('.qz-card-list');\n            //点击其他区域跳转到单页\n            openId.on('click', '.qzCard .qzZoneHref', function () {\n                var $this = $(this),\n                    url = $this.data('href');\n                //window.location.href = url;\n                window.open(url, '_blank');\n            });\n            //阻止事件冒泡\n            openId.on('click', '.qzZoneHref figure,.qzZoneHref a', function (event) {\n                event.stopPropagation();\n            });\n        },\n        //构建卡片内评论\n        createCardComment: function createCardComment(cmdt) {\n            var commDom = '';\n            commDom += '<li data-commid=\"' + cmdt.commid + '\"><a class=\"head\">';\n            commDom += '<img src=\"' + cmdt.head + '\" alt=\"' + cmdt.name + '\"></a>';\n            commDom += '<div class=\"info qzBtnComment\" data-commid=\"' + cmdt.commid + '\" data-name=\"' + cmdt.name + '\">';\n            commDom += '<h5>' + cmdt.name;\n            if (cmdt.reply) {\n                commDom += '<b>回复</b>' + cmdt.reply;\n            }\n            commDom += '</h5>';\n            commDom += '<p class=\"time\">' + cmdt.replytime + '</p>';\n            commDom += '<div class=\"context\">';\n            commDom += cmdt.context;\n            commDom += '</div></div></li>';\n            return commDom;\n        },\n        //插入卡片内评论\n        insertCardComment: function insertCardComment(tar, dt) {\n            var insDom = '';\n            $.each(dt, function (i, item) {\n                //使用返回数据 构建卡片\n                insDom += qzFunc.createCardComment(item);\n            });\n            $(tar).html(insDom);\n        },\n        //插入卡片内更多评论\n        appendCardComment: function appendCardComment(tar, dt) {\n            var insDom = '';\n            $.each(dt, function (i, item) {\n                //使用返回数据 构建卡片\n                insDom += qzFunc.createCardComment(item);\n            });\n            $(tar).append(insDom);\n        },\n        //构建卡片内赞\n        createCardLike: function createCardLike(lkdt) {\n            var likeDom = '';\n            likeDom += '<li data-likeid=\"' + lkdt.likeid + '\"><a class=\"head\">';\n            likeDom += '<img src=\"' + lkdt.head + '\" alt=\"' + lkdt.name + '\"></a>';\n            likeDom += '<div class=\"name\"><a>' + lkdt.name + '</a></div>';\n            likeDom += '</div></li>';\n            return likeDom;\n        },\n        //插入卡片内赞\n        insertCardLike: function insertCardLike(tar, dt) {\n            var insDom = '';\n            $.each(dt, function (i, item) {\n                //使用返回数据 构建卡片\n                insDom += qzFunc.createCardLike(item);\n            });\n            $(tar).html(insDom);\n        },\n        //插入卡片内更多赞\n        appendCardLike: function appendCardLike(tar, dt) {\n            var insDom = '';\n            $.each(dt, function (i, item) {\n                //使用返回数据 构建卡片\n                insDom += qzFunc.createCardLike(item);\n            });\n            $(tar).append(insDom);\n        },\n        //打开视频弹窗\n        openVideoPop: function openVideoPop() {\n            function videoPop(vdsrc) {\n                var popDom = '';\n                popDom += '<div class=\"qz-video-pop qzVideoPop\">';\n                popDom += '<div class=\"qz-video-pop-con\">';\n                popDom += '<iframe height=\"100%\" width=\"100%\" src=\"http://player.youku.com/embed/' + vdsrc + '\" frameborder=0 allowfullscreen></iframe>';\n                popDom += '</div>';\n                popDom += '<div class=\"qz-video-bar\"><a class=\"qz-video-pop-close qzVideoPopClose\"></div></a>';\n                popDom += '</div>';\n                $('body').append(popDom);\n                var $pop = $('.qzVideoPop');\n                setTimeout(function () {\n                    $pop.addClass('cur');\n                }, 10);\n                function closePop() {\n                    $pop.removeClass('cur');\n                    setTimeout(function () {\n                        $pop.remove();\n                    }, 250);\n                }\n                $pop.on('click', closePop);\n                $pop.on('click', 'iframe', function (event) {\n                    event.stopPropagation();\n                });\n            }\n            $('.qzVideoPopBtn').on('click', function () {\n                var $this = $(this),\n                    vdurl = $this.data('href'),\n                    vdsrc = '';\n                var ykSign = 'http://v.youku.com/v_show/id_',\n                    ykIndexOfBegin = vdurl.indexOf(ykSign) + ykSign.length,\n                    ykIndexOfEnd = vdurl.indexOf('==.html');\n                vdsrc = vdurl.substring(ykIndexOfBegin, ykIndexOfEnd);\n                videoPop(vdsrc);\n            });\n        },\n        //构建全部话题列表\n        createAllTopic: function createAllTopic(dt) {\n            var topicDom = '';\n            topicDom += '<li data-topicid=\"' + dt.id + '\"><a href=\"' + dt.url + '\"><b>#' + dt.title + '#</b><span><i class=\"num-in\">' + dt.countjoin + '</i>人参与<i class=\"num-comm\">' + dt.countcomm + '</i>条讨论</span></a></li>';\n            return topicDom;\n        },\n        //插入全部话题列表\n        allTopic: function allTopic() {\n            var $topicList = $('#qzAllTopicList');\n            function createList(dt) {\n                var listDom = '';\n                $.each(dt, function (i, item) {\n                    listDom += qzFunc.createAllTopic(item);\n                });\n                $topicList.html(listDom);\n            }\n            function addList(dt) {\n                var listDom = '';\n                $.each(dt, function (i, item) {\n                    listDom += qzFunc.createAllTopic(item);\n                });\n                $topicList.append(listDom);\n            }\n            function getListData() {\n                var dataOriUrl = $topicList.data('from');\n                $.ajax({\n                    dataType: 'script',\n                    url: dataOriUrl,\n                    success: function success() {\n                        var listData = fakeAlltopic;\n                        $topicList.attr({ 'data-page': listData.page, 'data-infiload': 'open' });\n                        createList(listData.topiclist);\n                    }\n                });\n            }\n            if ($topicList.length > 0) {\n                getListData();\n                qzFunc.infiniteLoad('#qzAllTopicList', function (tar, tarInsert) {\n                    var $main = $('#qzMain');\n                    $.ajax({\n                        dataType: 'Script',\n                        url: pgMoredataAllTopic,\n                        beforeSend: function beforeSend() {\n                            //插入加载动画\n                            $main.append(qzConfig.loadingDom);\n                        },\n                        success: function success() {\n                            var nowPage = tarInsert.attr('data-page'),\n                                dataPage = fakeAlltopic.page;\n                            //加载成功后移除加载动画\n                            $main.find('.qz-loading').remove();\n                            //判断时候还有当前数据页码是否加载完成\n                            if (dataPage > nowPage) {\n                                //设置新页码\n                                tarInsert.attr('data-page', dataPage);\n                                //插入更多数据\n                                addList(fakeAlltopic.topiclist);\n                            } else {\n                                if (tarInsert.attr('data-infiload') === 'open') {\n                                    //全部加载完成 关闭加载\n                                    tarInsert.attr('data-infiload', 'close');\n                                    //插入 全部加载完成 提示\n                                    $main.append(qzConfig.loadedDom);\n                                }\n                            }\n                            qzConfig.isCanLoading = true;\n                        }\n                    });\n                });\n            }\n        },\n        //入口\n        main: function main() {\n            //设置屏幕缩放\n            qzFunc.setRem();\n            //插入图片弹层，只需执行一次\n            qzFunc.addSwpOnce();\n            //开启评论\n            qzFunc.addComment();\n            //开启赞喜欢\n            qzFunc.addLike();\n            //开启发布/参与\n            qzFunc.addContext();\n            //插入测试数据\n            qzFunc.initPage();\n            //插入测试数据 话题页\n            qzFunc.initPageTopic();\n            //插入测试数据 内容单页\n            qzFunc.initPageContext();\n            //列表切换导航\n            qzFunc.tabNav();\n            //插入测试数据 模拟无限加载\n            qzFunc.infiniteLoad('#qzCardList', function (tar, tarInsert) {\n                $.ajax({\n                    dataType: 'Script',\n                    url: pgMoredataUrl,\n                    beforeSend: function beforeSend() {\n                        //插入加载动画\n                        tarInsert.append(qzConfig.loadingDom);\n                    },\n                    success: function success() {\n                        var nowPage = tarInsert.attr('data-page'),\n                            dataPage = fakeDate.page;\n                        //加载成功后移除加载动画\n                        tarInsert.find('.qz-loading').remove();\n                        //判断时候还有当前数据页码是否加载完成\n                        if (dataPage > nowPage) {\n                            //设置新页码\n                            tarInsert.attr('data-page', dataPage);\n                            //插入更多数据\n                            qzFunc.appendCard(tar, fakeDate.cardgroup);\n                        } else {\n                            if (tarInsert.attr('data-infiload') === 'open') {\n                                //全部加载完成 关闭加载\n                                tarInsert.attr('data-infiload', 'close');\n                                //插入 全部加载完成 提示\n                                tarInsert.append(qzConfig.loadedDom);\n                            }\n                        }\n                        qzConfig.isCanLoading = true;\n                    }\n                });\n            });\n            //开启 话题页上部加载更多按钮功能\n            qzFunc.topicMore();\n            //开启 内容单页评论和赞的切换功能\n            qzFunc.tabCl();\n            //开启 内容单页 跳转功能\n            qzFunc.pageGoto();\n            //加载 全部话题 列表\n            qzFunc.allTopic();\n            //旋转屏幕需要执行的函数\n            $(window).resize(function () {\n                qzFunc.setRem();\n            });\n        }\n    };\n    qzFunc.main();\n})();","/*\r\n * 开发完请删掉console.log()和注释！\r\n * 开发完请删掉console.log()和注释！\r\n * 开发完请删掉console.log()和注释！\r\n * 开发完请删掉console.log()和注释！\r\n * 开发完请删掉console.log()和注释！\r\n * **2017.11.22 更新查看原图\r\n * **v0.0.2 begin\r\n * **qzFunc.createCard,qzFunc.addSwpOnce,qzFunc.photoSwp 三个函数有修改\r\n * **v0.0.2 end\r\n * **2017.11.23 更新 全部话题 创建及无限加载\r\n * **v0.0.3 begin\r\n * **qzFunc.createAllTopic,qzFunc.allTopic 二个函数新增\r\n * **v0.0.3 end\r\n * **2017.11.27 更新 优酷标题调用\r\n * **v0.0.4 begin\r\n * **qzFunc.createAllTopic,qzFunc.allTopic 二个函数新增\r\n * **v0.0.4 end\r\n */\r\n(function () {\r\n    //模拟加载更多用测试数据begin\r\n    var pgMoredataUrl = 'http://j.gamersky.com/user/club/wap/data/fake.data.pg2.js';\r\n    var pgMoredataUrlComm = 'http://j.gamersky.com/user/club/wap/data/fake.comm.pg2.js';\r\n    var pgMoredataUrlLike = 'http://j.gamersky.com/user/club/wap/data/fake.like.pg2.js';\r\n    var pgMoredataAllTopic = 'http://j.gamersky.com/user/club/wap/data/fake.alltopic.pg2.js';\r\n    //模拟加载更多用测试数据end\r\n    var qzConfig = {\r\n        // 判断是否开始无限加载\r\n        isCanLoading:true,\r\n        //加载中 结构\r\n        loadingDom:'<div class=\"qz-loading\">正在加载</div>',\r\n        //全部加载完成 结构\r\n        loadedDom:'<div class=\"qz-loaded\">全部加载完成</div>',\r\n        //内容为空 结构\r\n        loadnullDom:'<div class=\"qz-loadnull\">还没有内容</div>'\r\n    };\r\n    var qzFunc={\r\n        //设置屏幕缩放\r\n        setRem:function () {\r\n            var pw = $(window).width();\r\n            if(pw >= 640){\r\n                pw = 640;\r\n            }\r\n            $('html').css({'font-size':pw/6.4 + 'px'});\r\n        },\r\n        //构建卡片\r\n        createCard:function (cdp) {\r\n            var cardDom = '';\r\n            //插入卡片ID cdp.cardid\r\n            cardDom += '<div class=\"qz-card qzCard\" data-cid=\"'+cdp.cardid+'\">';\r\n            //头部 begin\r\n            //插入用户头像 cdp.head\r\n            cardDom += '<header><a class=\"head\"><img src=\"'+cdp.head+'\" alt=\"head\"></a>';\r\n            cardDom += '<div class=\"info\"><h5>';\r\n            //插入用户名 cdp.user\r\n            cardDom += '<a>'+cdp.user+'</a>';\r\n            //是否加V图标\r\n            if(cdp.vauth === true){\r\n                cardDom += '<i class=\"member member-v1\"></i>';\r\n            }\r\n            //是否加编辑V图标\r\n            if(cdp.editauth === true){\r\n                cardDom += '<i class=\"member member-v2\"></i>';\r\n            }\r\n            cardDom += '</h5><p>';\r\n            //插入创建时间 cdp.createtime\r\n            cardDom += '<span class=\"time\">'+cdp.createtime+'</span>';\r\n            cardDom += '</p>';\r\n            cardDom += '</div>';\r\n            //是否加置顶 cdp.spectop 和 精 cdp.specvalue 图标\r\n            if(cdp.spectop === true||cdp.specvalue === true){\r\n                cardDom += '<div class=\"spec-icons\">';\r\n                if(cdp.spectop === true){\r\n                    cardDom += '<a class=\"spec-top\">置顶</a>';\r\n                }\r\n                if(cdp.specvalue === true){\r\n                    cardDom += '<a class=\"spec-value\">精</a>';\r\n                }\r\n                cardDom += '</div>';\r\n            }\r\n            cardDom += '</header>';\r\n            //头部 end\r\n            //主体 begin\r\n            //插入卡片跳转地址 cdp.url\r\n            cardDom += '<section class=\"detail qzZoneHref\" data-href=\"'+cdp.url+'\">';\r\n            //插入卡片内容 cdp.text\r\n            cardDom += '<div class=\"content\">'+cdp.text+'</div>';\r\n            //判断 插入 图片列表 cdp.piclist\r\n            if(cdp.piclist){\r\n                cardDom += '<div class=\"media-pic-list\"><div class=\"clearfix qz-figs qzPicPswp\">';\r\n                $.each(cdp.piclist,function (i,item) {\r\n                    cardDom += '<figure class=\"qzPicPswpBtn';\r\n                    //输出数据文件中的图片样式item.ext\r\n                    if(item.ext === 'gif'){\r\n                        cardDom += ' gif\"';\r\n                    }else if(item.ext === 'long'){\r\n                        cardDom += ' long\"';\r\n                    }\r\n                    //原始图像地址item.origin，大图地址item.large,尺寸item.size,缩略图地址item.url\r\n                    cardDom += '\"><a data-origin=\"http://www.gamersky.com/showimage/id_gamersky.shtml?'+item.origin+'\"  data-large=\"'+item.large+'\" data-size=\"'+item.size+'\"><img src=\"'+item.url+'\"></a></figure>';\r\n                });\r\n                cardDom += '</div></div>';\r\n            }\r\n            //判断是否插入大图\r\n            if(cdp.picbig){\r\n                cardDom += '<div class=\"qzPicPswp media-pic\"><figure class=\"';\r\n                //输出数据文件中的图片样式 item.ext\r\n                if(cdp.picbig.ext === 'gif'){\r\n                    cardDom += ' gif';\r\n                }else if(cdp.picbig.ext === 'long'){\r\n                    cardDom += ' long';\r\n                }\r\n                //原始图像地址cdp.picbig.large，大图地址cdp.picbig.large,尺寸cdp.picbig.size,缩略图地址cdp.picbig.url\r\n                cardDom += '\"><a data-origin=\"http://www.gamersky.com/showimage/id_gamersky.shtml?'+cdp.picbig.origin+'\" data-large=\"'+cdp.picbig.large+'\" data-size=\"'+cdp.picbig.size+'\"><img src=\"'+cdp.picbig.url+'\" class=\"qzPicPswpBtn\"></a></figure></div>';\r\n            }\r\n            //判断是否插入视频\r\n            if(cdp.video){\r\n                cardDom += '<div class=\"media-video';\r\n                //视频跳转地址 cdp.video.src,视频缩略图 cdp.video.pic\r\n                cardDom += '\"><a class=\"qzVideoPopBtn\" data-href=\"'+cdp.video.src+'\"><img src=\"'+cdp.video.pic+'\" alt=\"\"></a></div>'\r\n            }\r\n            cardDom += '</section>';\r\n            //判断是否输出来源\r\n            if(cdp.fromUrl){\r\n                //来源地址cdp.fromUrl,来源名称cdp.from\r\n                cardDom += '<div class=\"from\">来自：<a href=\"'+cdp.fromUrl+'\">'+cdp.from+'</a></div>';\r\n            }\r\n            //主体 end\r\n            //底部 begin\r\n            cardDom += '<footer>';\r\n            //点赞数cdp.countlike\r\n            cardDom += '<a class=\"btn-like qzBtnLike\" data-likecount=\"'+cdp.countlike+'\"><i></i><b>'+cdp.countlike+'</b></a><span></span>';\r\n            //评论数 cdp.countcomment,卡片ID cdp.cardid\r\n            cardDom += '<a class=\"btn-comment qzBtnComment\" data-commcount=\"'+cdp.countcomment+'\" data-commid=\"'+cdp.cardid+'\"  data-href=\"'+cdp.url+'\">'+cdp.countcomment+'</a>';\r\n            cardDom += '</footer>';\r\n            //底部 end\r\n            cardDom += '</div>';\r\n            cardDom += '';\r\n            cardDom += '';\r\n\r\n            return cardDom;\r\n        },\r\n        //图片弹出层 默认执行,一般情况不需要修改\r\n        addSwpOnce:function () {\r\n            var swp = '<div class=\"pswp\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"pswp__bg\"></div><div class=\"pswp__scroll-wrap\"><div class=\"pswp__container\"><div class=\"pswp__item\"></div><div class=\"pswp__item\"></div><div class=\"pswp__item\"></div></div><div class=\"pswp__ui pswp__ui--hidden\"><div class=\"pswp__top-bar\"><div class=\"pswp__counter\"></div><button class=\"pswp__button pswp__button--close\" title=\"Close (Esc)\"></button><a class=\"pswp__button pswpBtnOrigin pswp__single-tap\" title=\"查看原图\"></a> <button class=\"pswp__button pswp__button--share\" title=\"Share\"></button> <button class=\"pswp__button pswp__button--fs\" title=\"Toggle fullscreen\"></button> <button class=\"pswp__button pswp__button--zoom\" title=\"Zoom in/out\"></button><div class=\"pswp__preloader\"><div class=\"pswp__preloader__icn\"><div class=\"pswp__preloader__cut\"><div class=\"pswp__preloader__donut\"></div></div></div></div></div><div class=\"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\"><div class=\"pswp__share-tooltip\"></div></div><button class=\"pswp__button pswp__button--arrow--left\" title=\"Previous (arrow left)\"></button> <button class=\"pswp__button pswp__button--arrow--right\" title=\"Next (arrow right)\"></button><div class=\"pswp__caption\"><div class=\"pswp__caption__center\"></div></div></div></div></div>';\r\n            $('body').append(swp);\r\n        },\r\n        //图片弹出层方法 默认执行,一般情况不需要修改\r\n        photoSwp:function () {\r\n            var initPhotoSwipeFromDOM = function(gallerySelector) {\r\n                var parseThumbnailElements = function(el) {\r\n                    var thumbElements = el.childNodes,\r\n                        numNodes = thumbElements.length,\r\n                        items = [],\r\n                        figureEl,\r\n                        linkEl,\r\n                        size,\r\n                        item;\r\n                    for(var i = 0; i < numNodes; i++) {\r\n                        figureEl = thumbElements[i];\r\n                        if(figureEl.nodeType !== 1) {\r\n                            continue;\r\n                        }\r\n                        linkEl = figureEl.children[0];\r\n                        size = linkEl.getAttribute('data-size').split('x');\r\n                        item = {\r\n                            src: linkEl.getAttribute('data-large'),\r\n                            w: parseInt(size[0], 10),\r\n                            h: parseInt(size[1], 10),\r\n                            ori:linkEl.getAttribute('data-origin')\r\n                        };\r\n                        if(figureEl.children.length > 1) {\r\n                            item.title = figureEl.children[1].innerHTML;\r\n                        }\r\n                        if(linkEl.children.length > 0) {\r\n                            item.msrc = linkEl.children[0].getAttribute('src');\r\n                        }\r\n                        item.el = figureEl;\r\n                        items.push(item);\r\n                    }\r\n                    return items;\r\n                };\r\n                var closest = function closest(el, fn) {\r\n                    return el && ( fn(el) ? el : closest(el.parentNode, fn) );\r\n                };\r\n                var onThumbnailsClick = function(e) {\r\n                    e = e || window.event;\r\n                    e.preventDefault ? e.preventDefault() : e.returnValue = false;\r\n                    var eTarget = e.target || e.srcElement;\r\n                    var clickedListItem = closest(eTarget, function(el) {\r\n                        return (el.tagName && el.tagName.toUpperCase() === 'FIGURE');\r\n                    });\r\n                    if(!clickedListItem) {\r\n                        return;\r\n                    }\r\n                    var clickedGallery = clickedListItem.parentNode,\r\n                        childNodes = clickedListItem.parentNode.childNodes,\r\n                        numChildNodes = childNodes.length,\r\n                        nodeIndex = 0,\r\n                        index;\r\n                    for (var i = 0; i < numChildNodes; i++) {\r\n                        if(childNodes[i].nodeType !== 1) {\r\n                            continue;\r\n                        }\r\n                        if(childNodes[i] === clickedListItem) {\r\n                            index = nodeIndex;\r\n                            break;\r\n                        }\r\n                        nodeIndex++;\r\n                    }\r\n                    if(index >= 0) {\r\n                        openPhotoSwipe( index, clickedGallery );\r\n                    }\r\n                    return false;\r\n                };\r\n\r\n                var openPhotoSwipe = function(index, galleryElement, disableAnimation, fromURL) {\r\n                    var pswpElement = $('.pswp')[0],\r\n                        gallery,\r\n                        options,\r\n                        items;\r\n                    items = parseThumbnailElements(galleryElement);\r\n                    options = {\r\n                        shareEl:false,\r\n                        fullscreenEl: false,\r\n                        zoomEl:false,\r\n                        bgOpacity:1,\r\n                        showHideOpacity:0,\r\n                        galleryUID: galleryElement.getAttribute('data-pswp-uid'),\r\n                        history:false,\r\n                        getThumbBoundsFn: function(index) {\r\n                            var thumbnail = items[index].el.getElementsByTagName('img')[0],\r\n                                pageYScroll = window.pageYOffset || document.documentElement.scrollTop,\r\n                                rect = thumbnail.getBoundingClientRect();\r\n                            return {x:rect.left, y:rect.top + pageYScroll, w:rect.width};\r\n                        }\r\n                    };\r\n                    if(fromURL) {\r\n                        if(options.galleryPIDs) {\r\n                            for(var j = 0; j < items.length; j++) {\r\n                                if(items[j].pid == index) {\r\n                                    options.index = j;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        } else {\r\n                            options.index = parseInt(index, 10) - 1;\r\n                        }\r\n                    } else {\r\n                        options.index = parseInt(index, 10);\r\n                    }\r\n                    if( isNaN(options.index) ) {\r\n                        return;\r\n                    }\r\n                    if(disableAnimation) {\r\n                        options.showAnimationDuration = 0;\r\n                    }\r\n                    gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options);\r\n                    gallery.init();\r\n                    function setOrigin(num) {\r\n                        $('.pswpBtnOrigin').attr('href',items[num].ori)\r\n                    }\r\n                    gallery.listen('initialZoomIn', function() {\r\n                        setOrigin(gallery.getCurrentIndex());\r\n                        $('.pswp').animate({'opacity':1},333);\r\n                    });\r\n                    gallery.listen('initialZoomOut', function() {\r\n                        $('.pswp').animate({'opacity':0},200);\r\n                    });\r\n                    gallery.listen('afterChange', function() {\r\n                        setOrigin(gallery.getCurrentIndex());\r\n                    });\r\n                };\r\n                var galleryElements = document.querySelectorAll( gallerySelector );\r\n                for(var i = 0, l = galleryElements.length; i < l; i++) {\r\n                    galleryElements[i].setAttribute('data-pswp-uid', i+1);\r\n                    galleryElements[i].onclick = onThumbnailsClick;\r\n                }\r\n            };\r\n            initPhotoSwipeFromDOM('.qzPicPswp');\r\n        },\r\n        //插入卡片\r\n        insertCard:function (tar,dt) {\r\n            var insDom = '';\r\n            $.each(dt,function (i,item) {\r\n                //使用返回数据 构建卡片\r\n                insDom += qzFunc.createCard(item);\r\n            });\r\n            $(tar).html(insDom);\r\n            //构建完成后调用图片弹出层\r\n            qzFunc.photoSwp();\r\n            //开启视频弹窗\r\n            qzFunc.openVideoPop();\r\n        },\r\n        //加载更多卡片\r\n        appendCard:function (tar,dt) {\r\n            var insDom = '';\r\n            $.each(dt,function (i,item) {\r\n                //使用返回数据 构建卡片\r\n                insDom += qzFunc.createCard(item);\r\n            });\r\n            $(tar).append(insDom);\r\n            //构建完成后调用图片弹出层\r\n            qzFunc.photoSwp();\r\n            //开启视频弹窗\r\n            qzFunc.openVideoPop();\r\n        },\r\n        //发布/参与\r\n        addContext:function () {\r\n            function insertContext(scrolltopval) {\r\n                var comDom = '';\r\n                comDom += '<div class=\"qz-pop qzPop\">';\r\n                comDom += '<header>发布内容<a class=\"qz-pop-close qzPopClose\"></a><a class=\"qz-pop-smt qzPopSmt\">发布</a></header>';\r\n                comDom += '<div class=\"pop-con\">';\r\n                comDom += '<div class=\"pop-srl\"><textarea class=\"realIpt\" placeholder=\"分享你的游戏心得...\"></textarea><textarea class=\"mathIpt\" rows=\"3\"></textarea></div>';\r\n                //上传图片后显示，不传图片不显示 begin\r\n                comDom += '<div class=\"clearfix qz-pic-list\">';\r\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://imgs.gamersky.com/pic/2017/20171102_zy_164_666.jpg\"><a class=\"qz-img-remove\"></a></div>';\r\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://img1.gamersky.com/image2017/11/20171105_gtz_412_2/gamersky_04origin_07_2017115106F5F.jpg\"><a class=\"qz-img-remove\"></a></div>';\r\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://img1.gamersky.com/image2017/11/20171105_gtz_412_1/gamersky_02small_04_20171159476F0.jpg\"><a class=\"qz-img-remove\"></a></div>';\r\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://img1.gamersky.com/image2017/11/20171105_gtz_412_1/gamersky_03small_06_2017115947DAC.jpg\"><a class=\"qz-img-remove\"></a></div>';\r\n                comDom += '<div class=\"qz-pic-list-li\"><img src=\"http://img1.gamersky.com/image2017/11/20171105_gtz_412_1/gamersky_01small_02_2017115947F5B.jpg\"><a class=\"qz-img-remove\"></a></div>';\r\n                comDom += '<div class=\"qz-pic-list-li\"><label for=\"qzSelectPhoto\" class=\"qz-pic-list-add\"></label></div>';\r\n                comDom += '</div>';\r\n                //上传图片后显示，不传图片不显示 end\r\n                comDom += '</div>';\r\n                comDom += '<footer><label for=\"qzSelectPhoto\" class=\"qz-upload-pic qzUploadPic\">图片</label><select class=\"qz-pop-sel\">';\r\n                //右下角选项\r\n                comDom += '<option value=\"\">发往圈子</option>';\r\n                comDom += '<option value=\"\">发往gamersky</option>';\r\n                comDom += '<option value=\"\">发往游民之家</option>';\r\n                comDom += '<option value=\"\">发往圈子3</option>';\r\n                comDom += '</select>';\r\n                //隐藏的上传input\r\n                comDom += '<input id=\"qzSelectPhoto\" class=\"qz-select-photo\" type=\"file\" accept=\"image/gif,image/jpeg,image/jpg,image/png,image/bmp\">';\r\n                comDom += '</footer></div>';\r\n                //输出弹层\r\n                $('body').append(comDom);\r\n                var $qzPop = $('.qzPop');\r\n                //添加弹层动画\r\n                setTimeout(function () {\r\n                    $qzPop.addClass('cur');\r\n                },10);\r\n                //设置textarea尺寸\r\n                function setAreaSize() {\r\n                    $qzPop.find('.realIpt').on('input',function () {\r\n                        $qzPop.find('.mathIpt').val($qzPop.find('.realIpt').val());\r\n                        var textsth = $qzPop.find('.mathIpt')[0].scrollHeight;\r\n                        $qzPop.find('.realIpt').css('height',textsth);\r\n                    })\r\n                }\r\n                setAreaSize();\r\n                //关闭弹层\r\n                function closePop() {\r\n                    $qzPop.removeClass('cur');\r\n                    $('html,body').removeClass('hideScroll').animate({scrollTop:scrolltopval},0);\r\n                    //等待弹层动画执行完后移除弹层\r\n                    setTimeout(function () {\r\n                        $qzPop.remove();\r\n                    },250);\r\n                }\r\n                //关闭按钮\r\n                $('.qzPopClose').on('click',closePop);\r\n                //发布按钮\r\n                $('.qzPopSmt').on('click',function () {\r\n                    var context = $qzPop.find('.realIpt').val();\r\n                    //数据提交后执行下面函数\r\n                    console.log('发布成功:'+context);\r\n                    closePop();\r\n                });\r\n            }\r\n            //绑定发布按钮事件\r\n            $('#qzMain').on('click','.qzBtnContext',function () {\r\n                var st = $('html').scrollTop();\r\n                if(st === 0){\r\n                    st = $('body').scrollTop();\r\n                }\r\n                setTimeout(function () {\r\n                    $('html,body').addClass('hideScroll');\r\n                },300);\r\n                //打开弹层\r\n                insertContext(st);\r\n            });\r\n        },\r\n        //评论\r\n        addComment:function () {\r\n            function insertComment(scrolltopval,cid,rename) {\r\n                var comDom = '',placeholder = rename?'回复 '+rename+'：':'我来说两句...';\r\n                comDom += '<div class=\"qz-pop qzPop\">';\r\n                comDom += '<header>评论<a class=\"qz-pop-close qzPopClose\"></a><a class=\"qz-pop-smt qzPopSmt\">发布</a></header>';\r\n                comDom += '<div class=\"pop-con\"><div class=\"pop-srl\"><textarea class=\"realIpt\" placeholder=\"'+placeholder+'\"></textarea><textarea class=\"mathIpt\" rows=\"3\"></textarea></div></div>';\r\n                comDom += '</div>';\r\n                $('body').append(comDom);\r\n                var $qzPop = $('.qzPop');\r\n                setTimeout(function () {\r\n                    $qzPop.addClass('cur');\r\n                },10);\r\n                //设置textarea尺寸\r\n                function setAreaSize() {\r\n                    $qzPop.find('.realIpt').on('input',function () {\r\n                        $qzPop.find('.mathIpt').val($qzPop.find('.realIpt').val());\r\n                        var textsth = $qzPop.find('.mathIpt')[0].scrollHeight;\r\n                        $qzPop.find('.realIpt').css('height',textsth);\r\n                    })\r\n                }\r\n                setAreaSize();\r\n\r\n                console.log('给 cid = '+cid+' 评论添加评论 *** cid 为按钮传入的评论卡片id,供开发使用');\r\n                function closePop() {\r\n                    $qzPop.removeClass('cur');\r\n                    $('html,body').removeClass('hideScroll').animate({scrollTop:scrolltopval},0);\r\n                    setTimeout(function () {\r\n                        $qzPop.remove();\r\n                    },250);\r\n                }\r\n                //关闭按钮\r\n                $('.qzPopClose').on('click',closePop);\r\n                //发布按钮\r\n                $('.qzPopSmt').on('click',function () {\r\n                    var context = $qzPop.find('.realIpt').val();\r\n                    //数据提交后执行下面函数\r\n                    console.log('cid:'+cid+',发布成功:'+context);\r\n                    closePop();\r\n                });\r\n            }\r\n\r\n            $('#qzMain').on('click','.qzBtnComment',function () {\r\n                var st = $('html').scrollTop(),$this = $(this),\r\n                    cid = $this.data('commid'),\r\n                    //评论数量\r\n                    count = $this.data('commcount'),\r\n                    //单页卡片地址\r\n                    url = $this.data('href'),\r\n                    //回复的用户名\r\n                    rename = $this.attr('data-name');\r\n                //判断是否单页 单页直接打开弹层，不判断评论数\r\n                if($('#qzCardContext').length > 0){\r\n                    if(st === 0){\r\n                        st = $('body').scrollTop();\r\n                    }\r\n                    setTimeout(function () {\r\n                        $('html,body').addClass('hideScroll');\r\n                    },300);\r\n                    //打开弹层\r\n                    insertComment(st,cid,rename);\r\n                    return false;\r\n                }\r\n                if(count === 0){\r\n                    if(st === 0){\r\n                        st = $('body').scrollTop();\r\n                    }\r\n                    setTimeout(function () {\r\n                        $('html,body').addClass('hideScroll');\r\n                    },300);\r\n                    //打开弹层\r\n                    insertComment(st,cid);\r\n                }else{\r\n                    //如果评论数不为0 跳转到卡片单页\r\n                    //window.location.href = url;\r\n                    window.open(url, '_blank');\r\n                }\r\n\r\n            });\r\n        },\r\n        //点赞\r\n        addLike:function () {\r\n            $('#qzMain').on('click','.qzBtnLike',function () {\r\n                var $this = $(this),\r\n                    cid = $this.closest('.qzCard').data('cid'),\r\n                    //赞的数量\r\n                    count = $this.attr('data-likecount');\r\n                //判断是否喜欢过,data-islike=1为点过赞，再次点击删除赞，同时设置data-islike=0\r\n                if(parseInt($this.attr('data-islike')) === 1){\r\n                    //删除赞 数据提交后回调\r\n                    $this.removeClass('cur').attr('data-islike','0').attr('data-likecount',parseInt(count)-1).find('b').html(parseInt(count)-1);\r\n                    console.log('删除赞');\r\n                }else{\r\n                    //添加赞数 据提交后回调\r\n                    $this.addClass('cur').attr('data-islike','1').attr('data-likecount',parseInt(count)+1).find('b').html(parseInt(count)+1);\r\n                    console.log('喜欢了 cid = '+cid+' 的卡片 *** cid 为按钮传入的卡片id,供开发使用');\r\n                }\r\n            })\r\n        },\r\n        //初始化内容 卡片列表\r\n        initPage:function () {\r\n            var tar = '#qzCardList',tarInsert = $(tar);\r\n            if(tarInsert.length>0){\r\n                //获取数据，具体参数和方式后端自定义\r\n                var dt = tarInsert.data('from');\r\n                $.ajax({\r\n                    dataType:'Script',\r\n                    url:dt,\r\n                    beforeSend:function () {\r\n                        //插入加载动画\r\n                        tarInsert.append(qzConfig.loadingDom);\r\n                    },\r\n                    success:function () {\r\n                        //判断数据状态\r\n                        if(fakeDate.dataType === 'ok'){\r\n                            //处理获取的数据\r\n                            tarInsert.attr('data-page',fakeDate.page);\r\n                            //允许无限加载\r\n                            tarInsert.attr('data-infiload','open');\r\n                            qzFunc.insertCard(tar,fakeDate.cardgroup);\r\n                        }else{\r\n                            //数据为空是插入提示\r\n                            tarInsert.html(qzConfig.loadnullDom);\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        //初始化内容 话题上部\r\n        initPageTopic:function () {\r\n            var tar = '#qzCardListTopic',tarInsert = $(tar);\r\n            if(tarInsert.length>0){\r\n                //获取数据，具体参数和方式后端自定义\r\n                var dt = tarInsert.data('from');\r\n                $.ajax({\r\n                    dataType:'Script',\r\n                    url:dt,\r\n                    beforeSend:function () {\r\n                        //插入加载动画\r\n                        tarInsert.append(qzConfig.loadingDom);\r\n                    },\r\n                    success:function () {\r\n                        //判断数据状态\r\n                        if(fakeDate.dataType === 'ok'){\r\n                            //处理获取的数据\r\n                            tarInsert.attr('data-page',fakeDate.page);\r\n                            //允许无限加载\r\n                            tarInsert.attr('data-moreload','open');\r\n                            qzFunc.insertCard(tar,fakeDate.cardgroup);\r\n                        }else{\r\n                            //数据为空是插入提示\r\n                            tarInsert.html(qzConfig.loadnullDom);\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        //初始化内容 内容单页\r\n        initPageContext:function () {\r\n            var tar = '#qzCardContext',tarInsert = $(tar);\r\n            if(tarInsert.length>0){\r\n                //获取数据，具体参数和方式后端自定义\r\n                var dt = tarInsert.data('from');\r\n                $.ajax({\r\n                    dataType:'Script',\r\n                    url:dt,\r\n                    beforeSend:function () {\r\n                        //插入加载动画\r\n                        tarInsert.append(qzConfig.loadingDom);\r\n                    },\r\n                    success:function () {\r\n                        //判断数据状态\r\n                        if(fakeDate.dataType === 'ok'){\r\n                            //处理获取的数据\r\n                            tarInsert.attr('data-page',fakeDate.page);\r\n                            qzFunc.insertCard(tar,fakeDate.cardgroup);\r\n                        }else{\r\n                            //数据为空是插入提示\r\n                            tarInsert.html(qzConfig.loadnullDom);\r\n                        }\r\n                    }\r\n                });\r\n                var commtar = '#qzClComment',commurl = $(commtar).data('from');\r\n                $.ajax({\r\n                    dataType:'Script',\r\n                    url:commurl,\r\n                    beforeSend:function () {\r\n                        //插入加载动画\r\n                        $(commtar).append(qzConfig.loadingDom);\r\n                    },\r\n                    success:function () {\r\n                        //判断数据状态\r\n                        if(fakeCommData.dataType === 'ok'){\r\n                            //处理获取的数据\r\n                            $(commtar).attr('data-page',fakeCommData.page);\r\n                            $(commtar).attr('data-infiload','open');\r\n                            qzFunc.insertCardComment(commtar,fakeCommData.commlist);\r\n                        }else{\r\n                            //数据为空时插入提示\r\n                            $(commtar).html(qzConfig.loadnullDom);\r\n                        }\r\n                    }\r\n                });\r\n                //评论/赞 无限加载\r\n                function infiniteLoadCl() {\r\n                    function loadFunc() {\r\n                        var selid = $('.qzClCon.cur').attr('id'),tar,tarInsert;\r\n                        if(selid === 'qzClComment'){\r\n                            tar = '#qzClComment';\r\n                            tarInsert = $(tar);\r\n                            if(tarInsert.attr('data-infiload') === 'open'){\r\n                                $.ajax({\r\n                                    dataType:'Script',\r\n                                    url:pgMoredataUrlComm,\r\n                                    beforeSend:function () {\r\n                                        //插入加载动画\r\n                                        tarInsert.append(qzConfig.loadingDom);\r\n                                    },\r\n                                    success:function () {\r\n                                        var nowPage = tarInsert.attr('data-page'),dataPage = fakeCommData.page;\r\n                                        //加载成功后移除加载动画\r\n                                        tarInsert.find('.qz-loading').remove();\r\n                                        //判断时候还有当前数据页码是否加载完成\r\n                                        if(dataPage>nowPage){\r\n                                            //设置新页码\r\n                                            tarInsert.attr('data-page',dataPage);\r\n                                            //插入更多数据\r\n                                            qzFunc.appendCardComment(tar,fakeCommData.commlist);\r\n                                        }else{\r\n                                            if(tarInsert.attr('data-infiload') === 'open'){\r\n                                                //全部加载完成 关闭加载\r\n                                                tarInsert.attr('data-infiload','close');\r\n                                                //插入 全部加载完成 提示\r\n                                                tarInsert.append(qzConfig.loadedDom);\r\n                                            }\r\n                                        }\r\n                                        qzConfig.isCanLoading = true;\r\n                                    }\r\n                                })\r\n                            }else{\r\n                                qzConfig.isCanLoading = true;\r\n                            }\r\n\r\n                        }else if(selid === 'qzClLike'){\r\n                            tar = '#qzClLike';\r\n                            tarInsert = $(tar);\r\n                            if(tarInsert.attr('data-infiload') === 'open'){\r\n                                $.ajax({\r\n                                    dataType:'Script',\r\n                                    url:pgMoredataUrlLike,\r\n                                    beforeSend:function () {\r\n                                        //插入加载动画\r\n                                        tarInsert.append(qzConfig.loadingDom);\r\n                                    },\r\n                                    success:function () {\r\n                                        var nowPage = tarInsert.attr('data-page'),dataPage = fakeLikeData.page;\r\n                                        //加载成功后移除加载动画\r\n                                        tarInsert.find('.qz-loading').remove();\r\n                                        //判断时候还有当前数据页码是否加载完成\r\n                                        if(dataPage>nowPage){\r\n                                            //设置新页码\r\n                                            tarInsert.attr('data-page',dataPage);\r\n                                            //插入更多数据\r\n                                            qzFunc.appendCardLike(tar,fakeLikeData.likelist);\r\n                                        }else{\r\n                                            if(tarInsert.attr('data-infiload') === 'open'){\r\n                                                //全部加载完成 关闭加载\r\n                                                tarInsert.attr('data-infiload','close');\r\n                                                //插入 全部加载完成 提示\r\n                                                tarInsert.append(qzConfig.loadedDom);\r\n                                            }\r\n                                        }\r\n                                        qzConfig.isCanLoading = true;\r\n                                    }\r\n                                })\r\n                            }else{\r\n                                qzConfig.isCanLoading = true;\r\n                            }\r\n                        }\r\n                    }\r\n                    function scrollJudge() {\r\n                        var st = $('html').scrollTop(),dh = $(document).height(),wh = $(window).height();\r\n                        if(st === 0){\r\n                            st = $('body').scrollTop();\r\n                        }\r\n                        if(st > dh - wh - 20 && st > wh - dh && qzConfig.isCanLoading===true){\r\n                            qzConfig.isCanLoading = false;\r\n                            loadFunc();\r\n                        }\r\n                    }\r\n                    if($(tar).length>0){\r\n                        $(window).scroll(function () {\r\n                            scrollJudge();\r\n                        });\r\n                    }\r\n                }\r\n                infiniteLoadCl();\r\n            }\r\n        },\r\n        //无限加载\r\n        infiniteLoad:function (tar,callback) {\r\n            function loadFunc() {\r\n                var tarInsert = $(tar);\r\n                //判断列表是否开启无限加载\r\n                if(tarInsert.attr('data-infiload') === 'open'){\r\n                    //获取数据，具体参数和方式后端自定义\r\n                    if(typeof callback === 'function'){\r\n                        callback(tar,tarInsert);\r\n                    }\r\n                }\r\n            }\r\n            function scrollJudge() {\r\n                var st = $('html').scrollTop(),dh = $(document).height(),wh = $(window).height();\r\n                if(st === 0){\r\n                    st = $('body').scrollTop();\r\n                }\r\n                if(st > dh - wh - 20 && st > wh - dh && qzConfig.isCanLoading===true){\r\n                    qzConfig.isCanLoading = false;\r\n                    loadFunc();\r\n                }\r\n            }\r\n            if($(tar).length>0){\r\n                $(window).scroll(function () {\r\n                    scrollJudge();\r\n                });\r\n            }\r\n        },\r\n        //话题页上部加载更多按钮\r\n        topicMore:function () {\r\n            var $moreBtn = $('.qzCardMoreBtn');\r\n            $moreBtn.on('click',function () {\r\n                var tarInsert = $('#qzCardListTopic');\r\n                //判断列表是否开启查看更多\r\n                if(tarInsert.length>0 && tarInsert.attr('data-moreload') === 'open'){\r\n                    //获取数据，具体参数和方式后端自定义\r\n                    $.ajax({\r\n                        dataType:'Script',\r\n                        url:pgMoredataUrl,\r\n                        beforeSend:function () {\r\n                            //插入加载动画\r\n                            tarInsert.append(qzConfig.loadingDom);\r\n                        },\r\n                        success:function () {\r\n                            var nowPage = tarInsert.attr('data-page'),dataPage = fakeDate.page;\r\n                            //加载成功后移除加载动画\r\n                            tarInsert.find('.qz-loading').remove();\r\n                            //判断时候还有当前数据页码是否加载完成\r\n                            if(dataPage>nowPage){\r\n                                //设置新页码\r\n                                tarInsert.attr('data-page',dataPage);\r\n                                //插入更多数据\r\n                                qzFunc.appendCard('#qzCardListTopic',fakeDate.cardgroup);\r\n                            }else{\r\n                                if(tarInsert.attr('data-moreload') === 'open'){\r\n                                    //全部加载完成 关闭加载\r\n                                    tarInsert.attr('data-moreload','close');\r\n                                    //按钮 改变提示文字\r\n                                    $moreBtn.html('全部加载完成');\r\n                                }\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n        },\r\n        //列表切换\r\n        tabNav:function () {\r\n            function navFunc() {\r\n                var $nav = $('.qzNavFx'),\r\n                    //浮动导航层\r\n                    $navWrap = $('.qzNavFxW'),\r\n                    //固定不动的占位导航\r\n                    $navPos = $('.qzNavPos'),\r\n                    loadedTimer;\r\n                //判断滚动距离添加浮动导航\r\n                function fixNav() {\r\n                    var navTop = $navPos.offset().top,srlTop = $('html').scrollTop();\r\n                    if(srlTop === 0){\r\n                        srlTop = $('body').scrollTop();\r\n                    }\r\n                    if(srlTop >= navTop){\r\n                        $navWrap.addClass('openQzNavFixed');\r\n                    }else{\r\n                        $navWrap.removeClass('openQzNavFixed');\r\n                    }\r\n                }\r\n                fixNav();\r\n                $(window).scroll(function () {\r\n                    fixNav();\r\n                });\r\n                //加载tab内容前 页面位置\r\n                function scrollLoading() {\r\n                    var $html = $('html'),hh = $html.height(),\r\n                        navSt = $navPos.offset().top,srlTop = $html.scrollTop();\r\n                    if(srlTop === 0){\r\n                        srlTop = $('body').scrollTop();\r\n                    }\r\n                    $html.css('height',hh);\r\n                    if(srlTop > navSt){\r\n                        $('html,body').animate({scrollTop:navSt},0);\r\n                    }\r\n                }\r\n                //加载tab内容后 页面位置\r\n                function scrollLoaded() {\r\n                    var $html = $('html');\r\n                    clearTimeout(loadedTimer);\r\n                    loadedTimer = setTimeout(function () {\r\n                        $html.css('height','');\r\n                    },200);\r\n                }\r\n                //点击切换绑定事件\r\n                $nav.find('a').on('click',function () {\r\n                    var $this = $(this),dataUrl = $this.data('from'),tarCon = '#qzCardList';\r\n                    //设置按钮点击后样式\r\n                    $nav.find('a').removeClass('cur');\r\n                    $this.addClass('cur');\r\n                    //获取数据，具体参数和方式后端自定义\r\n                    $.ajax({\r\n                        dataType:'Script',\r\n                        url:dataUrl,\r\n                        beforeSend:function () {\r\n                            scrollLoading();\r\n                            //关闭其他加载\r\n                            qzConfig.isCanLoading = false;\r\n                            //插入加载动画\r\n                            $(tarCon).html(qzConfig.loadingDom);\r\n                        },\r\n                        success:function () {\r\n                            qzConfig.isCanLoading = true;\r\n                            //判断数据状态\r\n                            if(fakeDate.dataType === 'ok'){\r\n                                //插入当前页码\r\n                                $(tarCon).attr('data-page',fakeDate.page);\r\n                                //是否开启无限加载\r\n                                $(tarCon).attr('data-infiload','open');\r\n                                qzFunc.insertCard(tarCon,fakeDate.cardgroup);\r\n                            }else{\r\n                                //数据为空是插入提示\r\n                                $(tarCon).html(qzConfig.loadnullDom);\r\n                            }\r\n                            scrollLoaded();\r\n                        }\r\n                    });\r\n                })\r\n            }\r\n            if($('.qzNavFx').length>0){\r\n                navFunc();\r\n            }\r\n        },\r\n        //内容单页赞-评论切换\r\n        tabCl:function () {\r\n            var $nav = $('.tabNavCl'),$con = $('.qzClCon');\r\n            $nav.find('a').on('click',function () {\r\n                var $this = $(this),tar = $this.data('tar');\r\n                $nav.find('a').removeClass('cur');\r\n                $con.removeClass('cur');\r\n                $this.addClass('cur');\r\n                $('.'+tar).addClass('cur');\r\n                //数据获取后端自定义\r\n                if(tar === 'qzClLike'){\r\n                    var liketar = '#qzClLike',likeurl = $(liketar).data('from');\r\n                    if($(liketar).attr('data-page') === undefined){\r\n                        $.ajax({\r\n                            dataType:'Script',\r\n                            url:likeurl,\r\n                            beforeSend:function () {\r\n                                //插入加载动画\r\n                                $(liketar).append(qzConfig.loadingDom);\r\n                            },\r\n                            success:function () {\r\n                                $(liketar).find('.qz-loading').remove();\r\n                                //判断数据状态\r\n                                if(fakeLikeData.dataType === 'ok'){\r\n                                    //处理获取的数据\r\n                                    $(liketar).attr('data-page',fakeLikeData.page);\r\n                                    $(liketar).attr('data-infiload','open');\r\n                                    qzFunc.appendCardLike(liketar,fakeLikeData.likelist);\r\n                                }else{\r\n                                    //数据为空时插入提示\r\n                                    $(commtar).html(qzConfig.loadnullDom);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        //单页跳转\r\n        pageGoto:function () {\r\n            var openId = $('.qz-card-list');\r\n            //点击其他区域跳转到单页\r\n            openId.on('click','.qzCard .qzZoneHref',function () {\r\n                var $this = $(this),url = $this.data('href');\r\n                //window.location.href = url;\r\n                window.open(url, '_blank');\r\n            });\r\n            //阻止事件冒泡\r\n            openId.on('click','.qzZoneHref figure,.qzZoneHref a',function (event) {\r\n                event.stopPropagation();\r\n            });\r\n        },\r\n        //构建卡片内评论\r\n        createCardComment:function (cmdt) {\r\n            var commDom = '';\r\n            commDom += '<li data-commid=\"'+cmdt.commid+'\"><a class=\"head\">';\r\n            commDom += '<img src=\"'+cmdt.head+'\" alt=\"'+cmdt.name+'\"></a>';\r\n            commDom += '<div class=\"info qzBtnComment\" data-commid=\"'+cmdt.commid+'\" data-name=\"'+cmdt.name+'\">';\r\n            commDom += '<h5>'+cmdt.name;\r\n            if(cmdt.reply){\r\n                commDom += '<b>回复</b>'+cmdt.reply;\r\n            }\r\n            commDom += '</h5>';\r\n            commDom += '<p class=\"time\">'+cmdt.replytime+'</p>';\r\n            commDom += '<div class=\"context\">';\r\n            commDom += cmdt.context;\r\n            commDom += '</div></div></li>';\r\n            return commDom;\r\n        },\r\n        //插入卡片内评论\r\n        insertCardComment:function (tar,dt) {\r\n            var insDom = '';\r\n            $.each(dt,function (i,item) {\r\n                //使用返回数据 构建卡片\r\n                insDom += qzFunc.createCardComment(item);\r\n            });\r\n            $(tar).html(insDom);\r\n        },\r\n        //插入卡片内更多评论\r\n        appendCardComment:function (tar,dt) {\r\n            var insDom = '';\r\n            $.each(dt,function (i,item) {\r\n                //使用返回数据 构建卡片\r\n                insDom += qzFunc.createCardComment(item);\r\n            });\r\n            $(tar).append(insDom);\r\n        },\r\n        //构建卡片内赞\r\n        createCardLike:function (lkdt) {\r\n            var likeDom = '';\r\n            likeDom += '<li data-likeid=\"'+lkdt.likeid+'\"><a class=\"head\">';\r\n            likeDom += '<img src=\"'+lkdt.head+'\" alt=\"'+lkdt.name+'\"></a>';\r\n            likeDom += '<div class=\"name\"><a>'+lkdt.name+'</a></div>';\r\n            likeDom += '</div></li>';\r\n            return likeDom;\r\n        },\r\n        //插入卡片内赞\r\n        insertCardLike:function (tar,dt) {\r\n            var insDom = '';\r\n            $.each(dt,function (i,item) {\r\n                //使用返回数据 构建卡片\r\n                insDom += qzFunc.createCardLike(item);\r\n            });\r\n            $(tar).html(insDom);\r\n        },\r\n        //插入卡片内更多赞\r\n        appendCardLike:function (tar,dt) {\r\n            var insDom = '';\r\n            $.each(dt,function (i,item) {\r\n                //使用返回数据 构建卡片\r\n                insDom += qzFunc.createCardLike(item);\r\n            });\r\n            $(tar).append(insDom);\r\n        },\r\n        //打开视频弹窗\r\n        openVideoPop:function () {\r\n            function videoPop(vdsrc) {\r\n                var popDom = '';\r\n                popDom += '<div class=\"qz-video-pop qzVideoPop\">';\r\n                popDom += '<div class=\"qz-video-pop-con\">';\r\n                popDom += '<iframe height=\"100%\" width=\"100%\" src=\"http://player.youku.com/embed/'+vdsrc+'\" frameborder=0 allowfullscreen></iframe>';\r\n                popDom += '</div>';\r\n                popDom += '<div class=\"qz-video-bar\"><a class=\"qz-video-pop-close qzVideoPopClose\"></div></a>';\r\n                popDom += '</div>';\r\n                $('body').append(popDom);\r\n                var $pop = $('.qzVideoPop');\r\n                setTimeout(function () {\r\n                    $pop.addClass('cur');\r\n                },10);\r\n                function closePop() {\r\n                    $pop.removeClass('cur');\r\n                    setTimeout(function () {\r\n                        $pop.remove();\r\n                    },250);\r\n                }\r\n                $pop.on('click',closePop);\r\n                $pop.on('click','iframe',function (event) {\r\n                    event.stopPropagation();\r\n                });\r\n            }\r\n            $('.qzVideoPopBtn').on('click',function () {\r\n                var $this = $(this),vdurl = $this.data('href'),vdsrc = '';\r\n                var ykSign = 'http://v.youku.com/v_show/id_',ykIndexOfBegin = vdurl.indexOf(ykSign)+ykSign.length,ykIndexOfEnd = vdurl.indexOf('==.html');\r\n                vdsrc = vdurl.substring(ykIndexOfBegin,ykIndexOfEnd);\r\n                videoPop(vdsrc);\r\n            })\r\n        },\r\n        //构建全部话题列表\r\n        createAllTopic:function (dt) {\r\n            var topicDom = '';\r\n            topicDom += '<li data-topicid=\"'+dt.id+'\"><a href=\"'+dt.url+'\"><b>#'+dt.title+'#</b><span><i class=\"num-in\">'+dt.countjoin+'</i>人参与<i class=\"num-comm\">'+dt.countcomm+'</i>条讨论</span></a></li>';\r\n            return topicDom;\r\n        },\r\n        //插入全部话题列表\r\n        allTopic:function () {\r\n            var $topicList = $('#qzAllTopicList');\r\n            function createList(dt) {\r\n                var listDom = '';\r\n                $.each(dt,function (i,item) {\r\n                    listDom += qzFunc.createAllTopic(item);\r\n                });\r\n                $topicList.html(listDom);\r\n            }\r\n            function addList(dt) {\r\n                var listDom = '';\r\n                $.each(dt,function (i,item) {\r\n                    listDom += qzFunc.createAllTopic(item);\r\n                });\r\n                $topicList.append(listDom);\r\n            }\r\n            function getListData() {\r\n                var dataOriUrl = $topicList.data('from');\r\n                $.ajax({\r\n                    dataType:'script',\r\n                    url:dataOriUrl,\r\n                    success:function () {\r\n                        var listData = fakeAlltopic;\r\n                        $topicList.attr({'data-page':listData.page,'data-infiload':'open'});\r\n                        createList(listData.topiclist);\r\n                    }\r\n                })\r\n            }\r\n            if($topicList.length>0){\r\n                getListData();\r\n                qzFunc.infiniteLoad('#qzAllTopicList',function (tar,tarInsert) {\r\n                    var $main = $('#qzMain');\r\n                    $.ajax({\r\n                        dataType:'Script',\r\n                        url:pgMoredataAllTopic,\r\n                        beforeSend:function () {\r\n                            //插入加载动画\r\n                            $main.append(qzConfig.loadingDom);\r\n                        },\r\n                        success:function () {\r\n                            var nowPage = tarInsert.attr('data-page'),dataPage = fakeAlltopic.page;\r\n                            //加载成功后移除加载动画\r\n                            $main.find('.qz-loading').remove();\r\n                            //判断时候还有当前数据页码是否加载完成\r\n                            if(dataPage>nowPage){\r\n                                //设置新页码\r\n                                tarInsert.attr('data-page',dataPage);\r\n                                //插入更多数据\r\n                                addList(fakeAlltopic.topiclist);\r\n                            }else{\r\n                                if(tarInsert.attr('data-infiload') === 'open'){\r\n                                    //全部加载完成 关闭加载\r\n                                    tarInsert.attr('data-infiload','close');\r\n                                    //插入 全部加载完成 提示\r\n                                    $main.append(qzConfig.loadedDom);\r\n                                }\r\n                            }\r\n                            qzConfig.isCanLoading = true;\r\n                        }\r\n                    })\r\n                })\r\n            }\r\n        },\r\n        //入口\r\n        main:function () {\r\n            //设置屏幕缩放\r\n            qzFunc.setRem();\r\n            //插入图片弹层，只需执行一次\r\n            qzFunc.addSwpOnce();\r\n            //开启评论\r\n            qzFunc.addComment();\r\n            //开启赞喜欢\r\n            qzFunc.addLike();\r\n            //开启发布/参与\r\n            qzFunc.addContext();\r\n            //插入测试数据\r\n            qzFunc.initPage();\r\n            //插入测试数据 话题页\r\n            qzFunc.initPageTopic();\r\n            //插入测试数据 内容单页\r\n            qzFunc.initPageContext();\r\n            //列表切换导航\r\n            qzFunc.tabNav();\r\n            //插入测试数据 模拟无限加载\r\n            qzFunc.infiniteLoad('#qzCardList',function (tar,tarInsert) {\r\n                $.ajax({\r\n                    dataType:'Script',\r\n                    url:pgMoredataUrl,\r\n                    beforeSend:function () {\r\n                        //插入加载动画\r\n                        tarInsert.append(qzConfig.loadingDom);\r\n                    },\r\n                    success:function () {\r\n                        var nowPage = tarInsert.attr('data-page'),dataPage = fakeDate.page;\r\n                        //加载成功后移除加载动画\r\n                        tarInsert.find('.qz-loading').remove();\r\n                        //判断时候还有当前数据页码是否加载完成\r\n                        if(dataPage>nowPage){\r\n                            //设置新页码\r\n                            tarInsert.attr('data-page',dataPage);\r\n                            //插入更多数据\r\n                            qzFunc.appendCard(tar,fakeDate.cardgroup);\r\n                        }else{\r\n                            if(tarInsert.attr('data-infiload') === 'open'){\r\n                                //全部加载完成 关闭加载\r\n                                tarInsert.attr('data-infiload','close');\r\n                                //插入 全部加载完成 提示\r\n                                tarInsert.append(qzConfig.loadedDom);\r\n                            }\r\n                        }\r\n                        qzConfig.isCanLoading = true;\r\n                    }\r\n                })\r\n            });\r\n            //开启 话题页上部加载更多按钮功能\r\n            qzFunc.topicMore();\r\n            //开启 内容单页评论和赞的切换功能\r\n            qzFunc.tabCl();\r\n            //开启 内容单页 跳转功能\r\n            qzFunc.pageGoto();\r\n            //加载 全部话题 列表\r\n            qzFunc.allTopic();\r\n            //旋转屏幕需要执行的函数\r\n            $(window).resize(function () {\r\n                qzFunc.setRem();\r\n            });\r\n        }\r\n    };\r\n    qzFunc.main();\r\n})();"]}