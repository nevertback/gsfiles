!function(t){var a="dev",e={getWapCardComment:function(a,e,n){var i="./data/fake.comment.page1.json";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapCardContext:function(a,e,n){var i="http://192.168.0.100:9009/apis/club/api/getwapcardcontext";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapClubContext:function(a,e,n){var i="http://192.168.0.100:9009/apis/club/api/getwapclubcontent";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getCommentCount:function(a,e,n){var i="http://192.168.0.100:9009/apis/club/api/getcommentcount";t.ajax({type:"get",dataType:"jsonp",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapClubComment:function(a,e,n){var i="http://192.168.0.100:9009/apis/club/api/getwapclubcomment";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getwapclubuserlike:function(a,e,n){var i="http://192.168.0.100:9009/apis/club/api/getwapclubuserlike";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getLike:function(a,e,n){var i="http://192.168.0.100:9009/apis/club/api/getlike";t.ajax({type:"get",dataType:"jsonp",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},addLike:function(a,e,n){var i="http://192.168.0.100:9009/apis/club/api/addlike";t.ajax({type:"get",dataType:"jsonp",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapCardCommentPage2:function(a,e,n){var i="./data/fake.comment.page2.json";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapCardCommentPageOne:function(a,e,n){var i="./data/fake.comment.one.json";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapCardCommentPageOnePage2:function(a,e,n){var i="./data/fake.comment.one.page2.json";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})}},n={listNavSetter:{"new":{sort:1,type:0},hot:{sort:2,type:0},best:{sort:1,type:1}},innerCommentState:"close"},i=function(t){return"undefined"!=typeof t&&t.replace(/(^\s*)|(\s*$)/g,"")};t.fn.extend({textareaAutoHeight:function(a){this._options={minHeight:0,maxHeight:1e3},this.init=function(){for(var e in a)this._options[e]=a[e];0==this._options.minHeight&&(this._options.minHeight=parseFloat(t(this).height()));for(var e in this._options)null==t(this).attr(e)&&t(this).attr(e,this._options[e]);t(this).keyup(this.resetHeight).change(this.resetHeight).focus(this.resetHeight)},this.resetHeight=function(){var a=parseFloat(t(this).attr("minHeight")),e=parseFloat(t(this).attr("maxHeight"));t.browser.msie||t(this).height(0);var n=parseFloat(this.scrollHeight);n=n<a?a:n>e?e:n,t(this).height(n).scrollTop(n),t(this).css("overflow-y",n>=e?"scroll":"hidden")},this.init()}});var o={isCanLoading:!0,loadingDom:'<div class="qz-loading">正在加载</div>',loadedDom:'<div class="qz-loaded">全部加载完成</div>',loadnullDom:'<div class="qz-loadnull">还没有内容</div>'},c={setRem:function(){var a=t(window).width();a>=640&&(a=640),t("html").css({"font-size":a/6.4+"px"})},popCommon:{open:function(){t("html").addClass("hideScroll"),t(".ymw-backtotop").css("display","none")},close:function(){t("html").removeClass("hideScroll"),t(".ymw-backtotop").css("display","block")}},createCard:function(a){var e="";if(e+='<div class="qz-card qzCard" data-cid="'+a.cardid+'">',e+='<header><a class="head"><img src="'+a.head+'" alt="head"></a>',e+='<div class="info"><h5>',e+="<a>"+a.user+"</a>",i(a.vauth)&&(e+='<img src="'+a.vauth+'">'),e+="</h5><p>",e+='<span class="time">'+a.createtime+"</span>",e+="</p>",e+="</div>",a.spectop!==!0&&a.specvalue!==!0||(e+='<div class="spec-icons">',a.spectop===!0&&(e+='<a class="spec-top">置顶</a>'),a.specvalue===!0&&(e+='<a class="spec-value">精</a>'),e+="</div>"),e+="</header>",e+='<section class="detail qzZoneHref" data-href="'+a.url+'">',e+='<div class="content">',a.isVideo?(e+=a.text,e+="<a href="+a.video.src+' class="link-video">'+a.video.videoTitle+"</a>"):e+=a.text,e+="</div>",a.piclist.length>0&&(e+='<div class="media-pic-list"><div class="clearfix qz-figs qzPicPswp">',t.each(a.piclist,function(t,a){e+='<figure class="qzPicPswpBtn',"gif"===a.ext?(e+=' gif"',a.large=a.origin):"long"===a.ext&&(e+=' long"'),e+='"><a data-picType="'+a.ext+'" data-origin="'+a.origin+'"  data-large="'+a.large+'" data-size="'+a.size+'"><img src="'+a.url+'"></a></figure>'}),e+="</div></div>"),void 0!=a.picbig.large){a.picbig.large=a.picbig.url;var n="";e+='<div class="qzPicPswp media-pic',"gif"===a.picbig.ext?(n=" gif",a.picbig.large=a.picbig.origin):"long"===a.picbig.ext&&(n=" long"),e+='"><figure class="'+n+'"><a  data-picType="'+a.picbig.ext+'" data-origin="'+a.picbig.origin+'" data-large="'+a.picbig.large+'" data-size="'+a.picbig.size+'"><img src="'+a.picbig.url+'" class="qzPicPswpBtn"></a></figure></div>'}return a.isVideo&&(e+='<div class="media-video">',e+='<a class="qzVideoPopBtn" data-href="'+a.video.src+'"><img src="'+a.video.pic+'" alt=""></a></div>'),e+="</section>",a.fromUrl&&(e+='<div class="from">来自：<a href="'+a.fromUrl+'" >'+a.from+"</a></div>"),e+="<footer>",e+='<a class="btn-share qzBtnShare" data-shareid="'+a.cardid+'">分享</a>',e+='<span></span><a class="btn-comment qzBtnComment" data-commcount=""  data-clubcontentid="'+a.cardid+'"   data-href="'+a.url+'">0</a>',e+='<span></span><a class="btn-like qzBtnLike" data-likecount="" data-clubcontentid="'+a.cardid+'" ><i></i><b>0</b></a>',e+="</footer>",e+="</div>",e+="",e+=""},addSwpOnce:function(){var a='<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button><a target="_blank" class="pswp__button pswpBtnOrigin pswp__single-tap" title="查看原图"></a> <button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div>';t("body").append(a)},photoSwp:function(){var a=function(a){for(var e=function(t){for(var a,e,n,i,o=t.childNodes,c=o.length,s=[],d=0;d<c;d++)a=o[d],1===a.nodeType&&(e=a.children[0],n=e.getAttribute("data-size").split("x"),i={src:e.getAttribute("data-large"),w:parseInt(n[0],10),h:parseInt(n[1],10),ori:e.getAttribute("data-origin"),picType:e.getAttribute("data-picType")},a.children.length>1&&(i.title=a.children[1].innerHTML),e.children.length>0&&(i.msrc=e.children[0].getAttribute("src")),i.el=a,s.push(i));return s},n=function l(t,a){return t&&(a(t)?t:l(t.parentNode,a))},i=function(t){t=t||window.event,t.preventDefault?t.preventDefault():t.returnValue=!1;var a=t.target||t.srcElement,e=n(a,function(t){return t.tagName&&"FIGURE"===t.tagName.toUpperCase()});if(e){for(var i,c=e.parentNode,s=e.parentNode.childNodes,d=s.length,l=0,r=0;r<d;r++)if(1===s[r].nodeType){if(s[r]===e){i=l;break}l++}return i>=0&&o(i,c),!1}},o=function(a,n,i,o){function c(a){t(".pswpBtnOrigin").attr("href",l[a].ori)}var s,d,l,r=t(".pswp")[0];if(l=e(n),d={shareEl:!1,fullscreenEl:!1,zoomEl:!1,bgOpacity:1,showHideOpacity:0,galleryUID:n.getAttribute("data-pswp-uid"),history:!1,tapToClose:!0,getThumbBoundsFn:function(t){var a=l[t].el.getElementsByTagName("img")[0],e=window.pageYOffset||document.documentElement.scrollTop,n=a.getBoundingClientRect();return{x:n.left,y:n.top+e,w:n.width}}},o)if(d.galleryPIDs){for(var p=0;p<l.length;p++)if(l[p].pid==a){d.index=p;break}}else d.index=parseInt(a,10)-1;else d.index=parseInt(a,10);isNaN(d.index)||(i&&(d.showAnimationDuration=0),s=new PhotoSwipe(r,PhotoSwipeUI_Default,l,d),s.init(),s.listen("initialZoomIn",function(){c(s.getCurrentIndex()),t(".pswp").animate({opacity:1},333)}),s.listen("initialZoomOut",function(){t(".pswp").animate({opacity:0},200)}),s.listen("afterChange",function(){c(s.getCurrentIndex())}))},c=document.querySelectorAll(a),s=0,d=c.length;s<d;s++)c[s].setAttribute("data-pswp-uid",s+1),c[s].onclick=i};a(".qzPicPswp")},insertCard:function(a,e){var n="";t.each(e,function(t,a){n+=c.createCard(a)}),t(a).html(n),t(".qzBtnLike").like(),t(".qzBtnLike").addLike(),t(".qzCard .content").removeTarget(),t(".qzBtnComment").commentCount(),c.photoSwp(),c.openVideoPop()},appendCard:function(a,e){var n="";t.each(e,function(t,a){n+=c.createCard(a)}),t(a).append(n),t(".qzBtnLike").like(),t(".qzBtnLike").addLike(),t(".qzCard .content").removeTarget(),t(".qzBtnComment").commentCount(),c.photoSwp(),c.openVideoPop()},addContext:function(){function e(a){function e(){s.find(".realIpt").on("input",function(){s.find(".mathIpt").val(s.find(".realIpt").val());var t=s.find(".mathIpt")[0].scrollHeight;s.find(".realIpt").css("height",t)})}function n(){s.removeClass("cur"),t("html,body").removeClass("hideScroll").animate({scrollTop:a},0),setTimeout(function(){s.remove()},250)}var o=t(".topic").attr("data-topic");""==o&&(o=t(".topic").attr("data-selecttopic"));var c="";c+='<div class="qz-pop qzPop">',c+='<header>发布内容<a class="qz-pop-close qzPopClose"></a><a class="qz-pop-smt qzPopSmt">发布</a></header>',c+='<div class="pop-con">',c+='<div class="pop-srl"><textarea class="realIpt" placeholder="分享你的游戏心得...">',i(o)&&(c+=o),c+='</textarea > <textarea class="mathIpt" rows="3"></textarea></div > ',c+='<div class="clearfix qz-pic-list">',c+='<div class="qz-pic-list-li"><label for="qzSelectPhoto" class="qz-pic-list-add"></label></div>',c+="</div>",c+='<input id="fileupload" data-imagesize="5120"  type="file" style="display:none" name="files" method="POST" multiple="">',c+="</div>",c+='<footer><label for="qzSelectPhoto" class="qz-upload-pic qzUploadPic">图片</label><select class="qz-pop-sel">',c+="</select>",c+="</footer></div>",t("body").append(c);var s=t(".qzPop"),d=t(".clubList").html();t(".qz-pop-sel").html(d),t(".qz-pic-list-add,.qzUploadPic").selectPhoto(),t(".qz-pop-sel").change(function(a){a.preventDefault();var e=t(this).find("option:selected").val();t(".clubId").attr("data-selectclubid",e)}),setTimeout(function(){s.addClass("cur")},10),e(),t(".qzPopClose").on("click",n),s.fabuSubmit(a)}t("#qzMain").on("click",".qzBtnContext",function(){t(this).UserOnline(function(n){if("ok"==n.status||"dev"===a){var i=t("html").scrollTop();0===i&&(i=t("body").scrollTop()),setTimeout(function(){t("html,body").addClass("hideScroll")},300),e(i)}})})},addComment:function(){function e(a,e,n,i,o){function c(){r.find(".realIpt").on("input",function(){r.find(".mathIpt").val(r.find(".realIpt").val());var t=r.find(".mathIpt")[0].scrollHeight;r.find(".realIpt").css("height",t)})}function s(){r.removeClass("cur"),t("html,body").removeClass("hideScroll").animate({scrollTop:a},0),setTimeout(function(){r.remove()},250)}var d="",l=i?"回复 "+i+"：":"我来说两句...";d+='<div class="qz-pop qzPop">',d+='<header>评论<a class="qz-pop-close qzPopClose"></a><a data-userId="'+o+'" data-clubContentId="'+e+'"  data-commentId="'+n+'" class="qz-pop-smt qzPopSmt">发布</a></header>',d+='<div class="pop-con"><div class="pop-srl"><textarea class="realIpt" placeholder="'+l+'"></textarea><textarea class="mathIpt" rows="3"></textarea></div></div>',d+="</div>",t("body").append(d);var r=t(".qzPop");setTimeout(function(){r.addClass("cur")},10),c(),t(".qzPopClose").on("click",s),t(".qzPopSmt").on("click",function(){r.find(".realIpt").val();t(this).addComment(a)})}function n(n){n.UserOnline(function(i){if("ok"==i.status||"dev"===a){var o=t("html").scrollTop(),c=n.data("clubcontentid"),s=(n.data("commcount"),n.data("href"),n.data("userid")),d=n.data("commid"),l=n.attr("data-name");0===o&&(o=t("body").scrollTop()),setTimeout(function(){t("html,body").addClass("hideScroll")},300),e(o,c,d,l,s)}})}t("#qzMain").on("click",".qzBtnComment",function(){var n=t(this),i=n.data("commcount"),o=n.data("href");return i>0&&t("#qzCardContext").length<1?(window.open(o,"_blank"),!1):void n.UserOnline(function(i){if("ok"==i.status||"dev"===a){var o=t("html").scrollTop(),c=n.data("clubcontentid"),s=n.data("commcount"),d=n.data("userid"),l=n.data("commid"),r=n.attr("data-name");if(t("#qzCardContext").length>0)return 0===o&&(o=t("body").scrollTop()),setTimeout(function(){t("html,body").addClass("hideScroll")},300),e(o,c,l,r,d),!1;0!==s&&""!=s||(0===o&&(o=t("body").scrollTop()),setTimeout(function(){t("html,body").addClass("hideScroll")},300),e(o,c,l,r,d))}})}),t("#qzMain").on("click",".qzBtnCommentInner",function(){var a=t(this);n(a)})},initPageTopic:function(){var a="#qzCardListTopic",e=t(a);if(e.length>0){var n="http://192.168.0.100:9009/apis/club/api/GetWapClubContentByTopic",i=t(".clubId").attr("data-selectClubId"),s=t(".topic").attr("data-topic"),d={clubId:i,topicTitle:s,pageIndex:0};t.ajax({type:"post",dataType:"json",url:n,data:{jsondata:JSON.stringify(d)},beforeSend:function(){e.append(o.loadingDom)},success:function(n){var i=t.parseJSON(n.body);"ok"===i.dataType&&i.cardgroup.length>0?(t(".comeFrom").html(i.cardgroup[0].from),e.attr("data-page",i.page),e.attr("data-moreload","open"),c.insertCard(a,i.cardgroup),i.count<=1&&t(".qzCardMoreBtn").remove(),t(".qz-rem").css("display","block")):e.html(o.loadnullDom)}})}},initPageContext:function(){var a="#qzCardContext",n=t(a);if(n.length>0){var i={clubContentId:n.attr("data-cid")},s={jsondata:JSON.stringify(i)};e.getWapCardContext(s,function(e){var i=t.parseJSON(e.body);"ok"===i.dataType?(n.attr("data-page",i.page),c.insertCard(a,i.cardgroup)):n.html(o.loadnullDom)},function(){n.append(o.loadingDom)});var d="#qzClComment",l={clubContentId:t(d).attr("data-cid"),pageIndex:parseInt(t(d).attr("data-page"))+1,pageSize:10},r={jsondata:JSON.stringify(l)};e.getWapCardComment(r,function(a){var e=a.body,n=!1;"ok"===e.dataType?(t(".commentNum i,#qzCardContext .qzBtnComment").html(e.count),t(d).attr("data-page",e.page).addClass("qz-cl-comment-full"),e.page<Math.ceil(e.count/e.sumcount)&&(n=!0),c.insertCardComment(d,e.commlist,n)):t(d).html(o.loadnullDom)},function(){t(d).append(o.loadingDom)}),t(document).on("tap",".clubCardCommentMore",function(){var a=t(this),n=a.data("clk");if("can"===n){var i="#qzClComment",s=t(i),d=s.attr("data-cid"),l=s.find("li:first").attr("data-commid"),r=parseInt(s.attr("data-page"))+1,p=10,u={clubContentId:d,pageIndex:r,pageSize:p,excludeCommentId:l},m={jsondata:JSON.stringify(u)};e.getWapCardCommentPage2(m,function(t){s.find(".qz-loading").remove();var a=t.body,e=!1;"ok"===a.dataType&&(a.page<Math.ceil(a.count/a.sumcount)&&(e=!0),c.appendCardComment(i,a.commlist,e))},function(){s.find(".club-card-comment-more").remove(),s.append(o.loadingDom)})}})}},infiniteLoad:function(a,e){function n(){var n=t(a);"open"===n.attr("data-infiload")&&"function"==typeof e&&e(a,n)}function i(){var a=t("html").scrollTop(),e=t(document).height(),i=t(window).height();0===a&&(a=t("body").scrollTop()),a>e-i-20&&a>i-e&&o.isCanLoading===!0&&(o.isCanLoading=!1,n())}t(a).length>0&&t(window).scroll(function(){i()})},topicMore:function(){var a=t(".qzCardMoreBtn");a.on("click",function(){var e=t("#qzCardListTopic");if(e.length>0&&"open"===e.attr("data-moreload")){var n="http://192.168.0.100:9009/apis/club/api/GetWapClubContentByTopic",i=t(".clubId").attr("data-selectClubId"),s=t(".topic").attr("data-topic"),d=e.find(".qzCard").attr("data-cid"),l=parseInt(e.attr("data-pageIndex")),r=0==l?9:10;l=0==l?1:l+1;var p={clubId:i,topicTitle:s,excludeclubContentId:d,pageIndex:l,pageSize:r};t.ajax({type:"get",dataType:"json",url:n,data:{jsondata:JSON.stringify(p)},beforeSend:function(){e.append(o.loadingDom)},success:function(n){var i=t.parseJSON(n.body);e.find(".qz-loading").remove(),i.cardgroup.length>0?(e.attr("data-pageIndex",l),c.appendCard("#qzCardListTopic",i.cardgroup),i.cardgroup.length<r&&(e.attr("data-moreload","close"),a.html("全部加载完成"))):"open"===e.attr("data-moreload")&&(e.attr("data-moreload","close"),a.html("全部加载完成"))}})}})},tabNav:function(){function a(){function a(){var a=d.offset().top,e=t("html").scrollTop();0===e&&(e=t("body").scrollTop()),e>=a?s.addClass("openQzNavFixed"):s.removeClass("openQzNavFixed")}function e(){var a=t("html"),e=a.height(),n=d.offset().top,i=a.scrollTop();0===i&&(i=t("body").scrollTop()),a.css("height",e),i>n&&t("html,body").animate({scrollTop:n},0)}function n(){var a=t("html");clearTimeout(i),i=setTimeout(function(){a.css("height","")},200)}var i,c=t(".qzNavFx"),s=t(".qzNavFxW"),d=t(".qzNavPos");a(),t(window).scroll(function(){a()}),c.find("a").on("click",function(){var a=t(this),i="#qzCardList";c.find("a").removeClass("cur"),a.addClass("cur"),t(i).html("").attr("data-pageIndex",0).attr("data-loading",!1),o.isCanLoading=!1,e(),t(i).getClub(function(){n()})})}t(".qzNavFx").length>0&&a()},pageGoto:function(){var a=t(".qz-card-list");a.on("click",".qzCard .qzZoneHref",function(){var a=t(this),e=a.data("href");window.open(e,"_blank")}),a.on("click",".qzZoneHref figure,.qzZoneHref a",function(t){t.stopPropagation()})},createCardComment:function(t){var a="";return a+='<li data-commid="'+t.commid+'"><a class="head">',a+='<img src="'+t.head+'" alt="'+t.name+'"></a>',a+='<div class="info qzBtnComment" data-clubcontentid="'+t.clubContentId+'" data-commid="'+t.commid+'" data-name="'+t.name+'"  data-userId="'+t.useId+'">',a+="<h5>"+t.name,t.reply&&(a+="<b>回复</b>"+t.reply),a+="</h5>",a+='<p class="time">'+t.replytime+"</p>",a+='<div class="context">',a+=t.context,a+="</div></div></li>"},createCommentReply:function(t,a){var e="";return e+='<div class="ic-item qzBtnCommentInner" data-clubcontentid="'+a+'" data-commid="'+t.commid+'" data-name="'+t.name+'" data-userid="'+t.useId+'"><a class="ici-name">'+t.name+"</a>",null!==t.reply&&(e+='<i class="ici-rpy">回复</i><a class="ici-name">'+t.reply+"</a>"),e+='<a class="ici-name">：&nbsp;</a><span class="ici-context">'+t.context+"</span></div>"},createCardCommentFull:function(a){var e="",n=this;return e+='<li data-commid="'+a.commid+'"',e+=a.replylike>=5?' class="with-hot-tags">':">",e+='<a class="head">',e+='<img src="'+a.head+'" alt="'+a.name+'"></a>',e+='<div class="info">',e+="<h5>"+a.name,a.editauth&&(e+='<img src="'+a.editauth+'" alt="编辑">'),e+='<a class="info-like">'+a.replylike+"</a>",e+="</h5>",e+='<div class="info-others"><span class="info-time">'+a.replytime+'</span><span class="info-device">来自'+a.replydevice+"</span></div>",e+='<div class="context qzBtnCommentInner" data-clubcontentid="'+a.clubContentId+'" data-commid="'+a.commid+'" data-name="'+a.name+'" data-userid="'+a.useId+'">',e+=a.context,e+="</div>",null!==a.reply&&(e+='<div class="info-comment">',t.each(a.reply,function(t,i){t<2&&(e+=n.createCommentReply(i,a.commid))}),a.reply.length>2&&(e+='<a class="info-comment-more">查看全部'+a.replycount+"条回复</a>"),e+="</div>"),e+="</div></li>"},createCardCommentList:function(t){var a="";return a+='<li data-commid="'+t.commid+'"><a class="head">',a+='<img src="'+t.head+'" alt="'+t.name+'"></a>',a+='<div class="info qzBtnCommentInner" data-clubcontentid="'+t.clubContentId+'" data-commid="'+t.commid+'" data-name="'+t.name+'"  data-userId="'+t.useId+'">',a+="<h5>"+t.name,t.reply&&(a+="<b>回复</b>"+t.reply),a+="</h5>",a+='<p class="time">'+t.replytime+"</p>",a+='<div class="context">',a+=t.context,a+="</div></div></li>"},insertCardComment:function(a,e,n){var i="";t.each(e,function(t,a){i+=c.createCardCommentFull(a)}),i+=n===!0?'<a class="club-card-comment-more clubCardCommentMore" data-clk="can">查看更多</a>':'<a class="club-card-comment-more">全部加载完成</a>',t(a).html(i)},appendCardComment:function(a,e,n){var i="";t.each(e,function(t,a){i+=c.createCardCommentFull(a)}),i+=n===!0?'<a class="club-card-comment-more clubCardCommentMore" data-clk="can">查看更多</a>':'<a class="club-card-comment-more">全部加载完成</a>',t(a).append(i)},createCardLike:function(t){var a="";return a+='<li data-likeid="'+t.likeid+'"><a class="head">',a+='<img src="'+t.head+'" alt="'+t.name+'"></a>',a+='<div class="name"><a>'+t.name+"</a></div>",a+="</div></li>"},insertCardLike:function(a,e){var n="";t.each(e,function(t,a){n+=c.createCardLike(a)}),t(a).html(n)},appendCardLike:function(a,e){var n="";t.each(e,function(t,a){n+=c.createCardLike(a)}),t(a).append(n)},openVideoPop:function(){function a(a){function e(){i.removeClass("cur"),setTimeout(function(){i.remove()},250)}var n="";n+='<div class="qz-video-pop qzVideoPop">',n+='<div class="qz-video-pop-con">',n+='<iframe height="100%" width="100%" src="http://player.youku.com/embed/'+a+'" frameborder=0 allowfullscreen></iframe>',n+="</div>",n+='<div class="qz-video-bar"><a class="qz-video-pop-close qzVideoPopClose"></div></a>',n+="</div>",t("body").append(n);var i=t(".qzVideoPop");setTimeout(function(){i.addClass("cur")},10),i.on("click",e),i.on("click","iframe",function(t){t.stopPropagation()})}t(".qzVideoPopBtn").on("click",function(){var e=t(this),n=e.data("href"),i="",o="http://v.youku.com/v_show/id_",c=n.indexOf(o)+o.length,s=n.indexOf("==.html");i=n.substring(c,s),a(i)})},createAllTopic:function(t){var a="";return a+='<li data-topicid="'+t.Id+'" data-topic="'+t.Title+'"><a href="http://192.168.0.100:9009/apis/m/topic/'+t.Id+'"><b>'+t.Title+'</b><span><i class="num-in">0</i>人参与<i class="num-comm">0</i>条主题</span></a></li>'},allTopic:function(){function a(a){var e="";t.each(a,function(t,a){e+=c.createAllTopic(a)}),i.html(e),t("#qzAllTopicList li").allTopicJoinCount()}function e(a){var e="";t.each(a,function(t,a){e+=c.createAllTopic(a)}),i.append(e),t("#qzAllTopicList li").allTopicJoinCount()}function n(){var e=parseInt(i.attr("data-page"))+1,n={pageIndex:e,pageSize:d};t.ajax({type:"get",dataType:"jsonp",url:s,data:{jsondata:JSON.stringify(n)},success:function(t){i.attr({"data-page":e,"data-infiload":"open"}),a(t)}})}var i=t("#qzAllTopicList"),s="http://192.168.0.100:9009/apis/club/api/gettopicall",d=i.attr("data-pageSize");i.length>0&&(n(),c.infiniteLoad("#qzAllTopicList",function(a,n){var c=t("#qzMain"),l=parseInt(i.attr("data-page"))+1,r={pageIndex:l,pageSize:d};t.ajax({type:"get",dataType:"jsonp",url:s,data:{jsondata:JSON.stringify(r)},beforeSend:function(){c.append(o.loadingDom)},success:function(t){c.find(".qz-loading").remove(),t.length>0?(n.attr("data-page",l),e(t)):"open"===n.attr("data-infiload")&&(n.attr("data-infiload","close"),c.append(o.loadedDom)),o.isCanLoading=!0}})}))},cardInnerCommentPageTop:function(t){var a="";return a+='<div class="cc-one-top">',a+='<a class="head"><img class="head-pic" src="'+t.head+'" alt="'+t.name+'"><h5>'+t.name+"</h5>",t.editauth&&(a+='<img class="head-icon" src="'+t.editauth+'" alt="编辑">'),a+="</a>",a+='<div class="info">',a+='<div class="context">'+t.context+"</div>",a+='<div class="info-bottom">',a+='<span class="info-time">'+t.replytime+'</span><span class="info-device">'+t.replydevice+"</span>",a+='<a class="info-like">'+t.replylike+'</a><a class="info-reply qzBtnCommentInner" data-clubcontentid="'+t.clubContentId+'" data-commid="'+t.commid+'" data-name="'+t.name+'" data-userid="'+t.useId+'">回复</a><a class="info-delete clubCommentDelete">删除</a>',a+="</div></div>",a+="</div>"},cardInnerCommentPageList:function(a){var e="";return e+='<div class="cc-one-list">',t.each(a.reply,function(t,n){e+="<li>",e+='<a class="head"><img src="'+n.head+'" alt="'+n.name+'"></a>',e+='<div class="info">',e+="<h5>"+n.name,n.editauth&&(e+='<img src="'+n.editauth+'" alt="编辑">'),e+="</h5>",e+='<div class="context">',null!==n.reply&&(e+='<span class="context-reply-tags">回复</span><span class="context-reply">'+n.reply+":</span>"),e+=n.context+"</div>",e+='<div class="info-bottom">',e+='<span class="info-time">'+n.replytime+'</span><span class="info-device">'+n.replydevice+"</span>",e+='<a class="info-like">'+n.replylike+'</a><a class="info-reply qzBtnCommentInner"  data-clubcontentid="'+a.clubContentId+'" data-commid="'+n.commid+'" data-name="'+n.name+'" data-userid="'+a.useId+'">回复</a>',e+="</div></div>",e+="</li>"}),e+="</div>"},cardInnerCommentPage:function(){function a(){function a(){var a={commid:i.data("cid"),page:l++};e.getWapCardCommentPageOnePage2(a,function(a){i.find(".qz-loading").remove();var e=a.body,n="";if("ok"===e.dataType){var o=e.commlist[0];n+=c.cardInnerCommentPageList(o),o.replyPage*o.replysize<o.replycount?i.find(".club-comment-one-more").html("查看更多"):i.find(".club-comment-one-more").removeClass("clubCommentOneMore").addClass("club-comment-one-more-all").html("全部加载完成"),t(n).insertBefore(".club-comment-one-bottom")}},function(){t(o.loadingDom).insertBefore(".club-comment-one-bottom")})}var n="",s="",d="",l=1,r={commid:i.data("cid")};e.getWapCardCommentPageOne(r,function(t){var a=t.body;if("ok"===a.dataType){var e=a.commlist[0];n+=c.cardInnerCommentPageTop(e),s+=c.cardInnerCommentPageList(e),d+=n,d+=s,d+='<div class="club-comment-one-bottom">',d+='<a class="club-comment-one-reply qzBtnCommentInner" data-clubcontentid="'+e.clubContentId+'" data-commid="'+e.commid+'" data-name="'+e.name+'" data-userid="'+e.useId+'">发表回复</a>',d+=e.reply.length<e.replycount?'<a class="club-comment-one-more clubCommentOneMore">查看更多</a>':'<a class="club-comment-one-more club-comment-one-more-all">全部加载完成</a>',d+="</div>",i.html(d)}}),t(document).on("click",".clubCommentOneMore",function(){a()})}function n(){a(),t(document).on("click",".clubCommentDelete",function(){var t=confirm("你确定删除吗？");t===!0?console.log("确定删除"):console.log("取消")})}var i=t("#clubCommentOne"),c=this;i.length>0&&n()},popBaiduShare:function(){function a(){var t="";return t+='<div class="club-pop-baidu-mask clubPopBaidu clubPopBaiduClose"></div>',t+='<div class="club-pop-baidu-main clubPopBaidu">',t+='<div class="club-pop-baidu-head">分享</div>',t+='<div class="club-pop-baidu-body">',t+='<div class="club-pop-baidu-btns bdsharebuttonbox" data-tag="share_1"><a class="bds_tsina" data-cmd="tsina"></a><a class="bds_sqq" data-cmd="sqq"></a><a class="bds_qzone" data-cmd="qzone"></a><a class="bds_more" data-cmd="more"></a><a class="bds_count" data-cmd="count"></a></div>',t+="</div>",t+='<div class="club-pop-baidu-foot"><a class="clubPopBaiduClose">取消</a></div>',t+="</div>"}function e(){var a="http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion="+~(-new Date/36e5);"object"==typeof _bd_share_main?_bd_share_main.init():t.getScript(a)}function n(){var a=t(".clubPopBaidu");a.removeClass("cur"),setTimeout(function(){a.remove(),o.popCommon.close()},250)}function i(){var i=a();t("body").append(i),o.popCommon.open(),setTimeout(function(){t(".clubPopBaidu").addClass("cur")},50),t(".clubPopBaiduClose").on("click",function(){n()}),e()}var o=this;i()},globalBind:function(){var a=t("#qzMain"),e=this;a.on("click",".qzBtnShare",function(){e.popBaiduShare()})},main:function(){c.setRem(),c.addSwpOnce(),c.addComment(),c.addContext(),c.initPageTopic(),c.initPageContext(),c.tabNav(),c.infiniteLoad("#qzCardList",function(t,a){a.getClub()}),c.topicMore(),c.pageGoto(),c.allTopic(),c.cardInnerCommentPage(),t(window).resize(function(){c.setRem()}),c.globalBind()}};c.main(),t(document).ready(function(){t("#qzCardList").getClub(),t(".qzBtnLike").addLike(),t(".themeNum").joinCount(),t(".qz-nav-sort").change(function(a){a.preventDefault();var e=t(this).find("option:selected").attr("data-sort");t(this).attr("data-sort",e),t("#qzCardList").html("").attr("data-pageIndex",0).attr("data-loading",!1).getClub()})}),t.fn.fabuSubmit=function(a){return this.each(function(){var e=t(this),n=parseInt(e.find(".maxNum").html()),o=e.find(".mathIpt"),s=o.height(),d=parseInt(o.css("line-height")),l=15*d;o.textareaAutoHeight({minHeight:s,maxHeight:l}),e.on("focus",".mathIpt",function(){var a=t(this),e=a.attr("placeholder");a.attr("data-val",e).removeAttr("placeholder").parent().addClass("cur")}).on("blur",".mathIpt",function(){var a=t(this),e=a.attr("data-val");a.attr("placeholder",e).parent().removeClass("cur")}).on("keyup blur",".mathIpt",function(){var t=this.value.length;this.value=this.value.substr(0,n),e.find(".curNum").html(t),e.find(".fabu-num").css("display",t>0?"block":"")}),e.on("click",".qzPopSmt",function(){var e=t(".qz-pic-list-li:not(.temp)"),n=t(".fabuVideo"),o=t(".mathIpt").val(),s=""==o?t(".realIpt").html():o,d=t(".clubId").attr("data-selectClubId");if("true"!=t(this).attr("data-isclick")){t(this).attr("data-isclick",!0);var l="",r=e.length>9?9:e.length-1;if(r>0){l=[];for(var p=0;p<r;p++){var u=e.eq(p).find("img").attr("data-type"),m=e.eq(p).find("img").attr("src"),f=m.replace("tiny","small"),h=m.replace("tiny","origin"),g=m.replace("tiny","tinysquare");"gif"==u&&(h=h.replace(".jpg",".gif"));var v=e.eq(p).find("img").attr("data-height"),b=e.eq(p).find("img").attr("data-width");l.push({tiny:m,tinysquare:g,small:f,origin:h,height:v,width:b,imageType:u})}}var C="";if(n.length>0){var y="",z="",q="",I="",k="";void 0==n.attr("data-tit")?z="视频链接":(y=n.attr("data-vid"),z=n.attr("data-tit"),I=n.attr("data-img"),k=n.attr("data-sitename")),q=n.attr("data-url"),C={image:I,title:z,videoUrl:q,videoVid:y,siteName:k}}if(""==l&&""==C&&!i(s))return void alert("你还没有输入内容!");var w={content:s,images:l,videos:C,clubId:d,device:1};t.ajax({type:"post",dataType:"json",url:"http://192.168.0.100:9009/apis/club/api/addclubcontent",data:{jsondata:JSON.stringify(w)},success:function(e){if("ok"==e.dataType){t(this).attr("data-isclick",!1),t(".mathIpt").val("");var n=c.createCard(e.cardgroup);t("#qzCardList").prepend(n),c.photoSwp(),t(".qzBtnLike").like(),t(".qzBtnLike").addLike(),t(".qzBtnComment").commentCount(),t("html,body").removeClass("hideScroll").animate({scrollTop:a},0),setTimeout(function(){t(".qzPop").remove()},250)}else alert("发布失败，请重试！")}})}})})},t.fn.selectPhoto=function(){return this.each(function(){t(this).bind("click",function(){t("#fileupload").trigger("click"),t("#fileupload").fileupload({dataType:"json",maxFileSize:"5000000",url:"http://192.168.0.100:9009/apis/uploadpic/index",done:function(a,e){var n=e.result;if("ok"==n.status){var i=t(".qz-pic-list-li .qz-img-remove").length+1;if(i>9)alert("最多只能传9张"),t(".qz-pic-list .temp:first").remove();else{9==i&&t(".qz-pic-list-add").parent().css("display","none");var o="<img src='"+n.tiny+"' data-original='"+n.original+"' data-height=\""+n.height+'" data-width="'+n.width+'" data-type="'+n.imageclass+"\"><a class='qz-img-remove'></a>";t(".qz-pic-list .temp:first").removeClass("temp").html(o)}t(".qz-pic-list .qz-img-remove").each(function(){t(this).unbind("click"),t(this).bind("click",function(){
var a=t(this).parents(".pic").find("img").attr("data-original"),e=t(".qz-pic-list-li").not(":last").length;t(this).parent(".qz-pic-list-li").remove(),t.ajax({type:"get",dataType:"json",url:"http://192.168.0.100:9009/apis/uploadpic/delete?origin="+a,data:{},success:function(t){}}),e<9&&t(".qz-pic-list-add").parent().css("display","block")})})}else alert("包含不支持的文件格式"),t(".qz-pic-list .temp:first").remove()},change:function(a,e){var n=0,i=parseInt(t("#fileupload").attr("data-imagesize")),o=i/1024;t.each(e.files,function(a,e){if(e.size/1024>i&&n<=0)n+=1,alert("图片容量超过"+o+"MB，无法上传！");else if(e.size/1024<=i){var c='<div class="qz-pic-list-li temp"><img src="http://image.gamersky.com/webimg15/user/club/pc/loading.gif" ></div>';t(".qz-pic-list-li:first").before(c)}})}})})})},t.fn.getClub=function(a){return this.each(function(){var i=t(this),s=t(".qzNavFx a.cur").attr("data-cfg"),d=n.listNavSetter[s].type,l=n.listNavSetter[s].sort,r=t(".clubId").attr("data-clubId"),p=t(".topic").attr("data-topic"),u=t(".topic").attr("data-topicId"),m=parseInt(i.attr("data-pageIndex"))+1,f=i.attr("data-pageSize"),h=i.attr("data-loading");if("true"!=h){i.attr("data-loading","true");var g=i.find(".qzCard").length,v=0,b=i.find(".qzCard:first").attr("data-cid");void 0!=b&&null!=b||(b=""),g>=50&&(v=g-50),b+=",",i.find(".qzCard:gt("+v+")").each(function(){b+=t(this).attr("data-cid")+","});var C={contentType:d,sort:l,pageIndex:m,pageSize:f,clubId:r,topic:p,topicId:u,excludeIds:b};i.attr("data-pageIndex",m);var y={jsondata:JSON.stringify(C)};e.getWapClubContext(y,function(e){var n=t.parseJSON(e.body);i.attr("data-loading","false"),i.find(".qz-loading").remove();var s=n.cardgroup.length;1==m&&0==s?i.html(o.loadnullDom).attr("data-infiload","close"):1==m&&s>0?(c.insertCard(i,n.cardgroup),s>=f?(i.attr("data-infiload","open"),o.isCanLoading=!0):(o.isCanLoading=!1,i.attr("data-infiload","close").append(o.loadedDom))):m>1&&s>0?(c.appendCard(i,n.cardgroup),i.attr("data-infiload","open"),o.isCanLoading=!0):i.attr("data-infiload","close").append(o.loadedDom),"function"==typeof a&&a&&a()},function(){t(".qz-loadnull,.qz-loaded").remove(),i.append(o.loadingDom)})}})},t.fn.like=function(){var a="";t(this).each(function(){""!=a&&(a+=","),a+=t(this).attr("data-clubcontentid")});var n={clubContentId:a},i={jsondata:JSON.stringify(n)};e.getLike(i,function(a){if("ok"==a.status){var e=t.parseJSON(a.body);t.each(e,function(a,e){t(".qzBtnLike[data-clubcontentid='"+e.Id+"']").each(function(){t(this).find("b").html(e.digg).attr("data-likecount",e.digg)})})}})},t.fn.addLike=function(n){return this.each(function(){var n=t(this);n.unbind("click"),n.click(function(i){i.preventDefault(),t(this).UserOnline(function(t){if("ok"==t.status||"dev"===a){var i=n.attr("data-clubcontentid"),o={clubContentId:i,fromDevice:1},c={jsondata:JSON.stringify(o)};e.addLike(c,function(t){if("err"==t.status)alert(t.body);else{var a=parseInt(n.find("b").html())+1;n.find("b").html(a)}})}})})})},t.fn.commentCount=function(){function a(){var a="";t(n).each(function(){""!=a&&(a+=","),a+=t(this).attr("data-clubcontentid")});var i={clubContentId:a},o={jsondata:JSON.stringify(i)};e.getCommentCount(o,function(a){if("ok"==a.status){var e=t.parseJSON(a.body);t.each(e,function(a,e){t(".qzBtnComment[data-clubcontentid='"+e.Id+"']").each(function(){var a=t(this);t(n).parents(".qzClComment").length>0||(a.html(e.commentCount),a.attr("data-commcount",e.commentCount),t("#qzCardList").length>0&&e.commentCount>0&&a.insertListComment())})})}})}var n=this;a()},t.fn.insertListComment=function(){function a(){var a=i.closest(".qzCard"),n="",o=1,s=i.data("clubcontentid"),d={clubContentId:s,pageIndex:o,pageSize:10},l={jsondata:JSON.stringify(d)};e.getWapClubComment(l,function(e){var o=t.parseJSON(e.body);"ok"===o.dataType&&"ok"!=i.attr("data-isinsert")&&(i.attr("data-isinsert","ok"),n+='<div class="qz-comment-inlist"><ul>',t.each(o.commlist,function(t,a){t<3&&(n+=c.createCardCommentList(a))}),n+="</ul></div>",t(n).insertBefore(a.find("footer")))})}var i=t(this);"open"===n.innerCommentState&&a()},t.fn.joinCount=function(){var a="";t(this).each(function(){""!=a&&(a+=","),a+=t(this).attr("data-topic")});var e={topic:a};t.ajax({type:"get",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/club/api/getjoinarraycount",data:{jsondata:JSON.stringify(e)},success:function(a){"ok"==a.status&&t.each(a.result,function(a,e){t(".themeNum[data-topic='"+e.topic+"']").each(function(){t(this).find(".join").html(e.join+"人"),t(this).find(".theme").html(e.clubContent),t(this).find("span i").html(e.clubContent)})})}})},t.fn.allTopicJoinCount=function(){var a="";t(this).each(function(){""!=a&&(a+=","),a+=t(this).attr("data-topic")});var e={topic:a};t.ajax({type:"get",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/club/api/getjoinarraycount",data:{jsondata:JSON.stringify(e)},success:function(a){"ok"==a.status&&t.each(a.result,function(a,e){t("#qzAllTopicList li[data-topic='"+e.topic+"']").each(function(){t(this).find(".num-in").html(e.join),t(this).find(".num-comm").html(e.clubContent)})})}})},t.fn.addComment=function(a){var e=t(this);if("true"!=e.attr("data-isclick")){e.attr("data-isclick",!0);var n=t.trim(e.parent().siblings(".pop-con").find(".mathIpt").val()),i=e.data("userid"),o=e.data("clubcontentid"),s=e.data("commentid");if(""==n)return void alert("评论不能为空！");if(n.length>=5e3)return void alert("评论不能超过5000个字符！");var d={userId:i,clubContentId:o,content:n,replyId:s,fromDevice:1};t.ajax({type:"post",dataType:"json",url:"http://192.168.0.100:9009/apis/club/api/addcomment",data:{jsondata:JSON.stringify(d)},success:function(n){if("ok"==n.dataType){e.attr("data-isclick",!1);var i=t("#qzClComment");if(i.length>0){var s=c.createCardComment(n.commlist);0==i.find("li").length?i.html(s):i.prepend(s);var d=parseInt(t(".commentNum i,.qzBtnComment").html())+1;t(".commentNum i,#qzCardContext .btn-comment").html(d)}else t(".qzBtnComment[data-clubcontentid="+o+"]").html("1").attr("data-commcount",1);t(".qzPop").removeClass("cur"),t("html,body").removeClass("hideScroll").animate({scrollTop:a},0),setTimeout(function(){t(".qzPop").remove()},250)}else alert(n.body)}})}},t.fn.UserOnline=function(e){t.ajax({type:"GET",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/api/logincheck",success:function(n){"dev"===a?e(n):"ok"!==n.status?(t(".ymw-loginpop-btns").insertYmwLoginPop(),t(".ymw-loginpop-btns").QZloginForm()):e(n)}})},t.fn.QZloginForm=function(){var a=t(this);a.on("click","#qqLogin",function(t){t.preventDefault();var a=window.location.href;window.location.href="http://192.168.0.100:9009/apis/oauth/authorizelogin?authorizetype=qq&returnUrl="+encodeURI(a)}).on("click","#sinaLogin",function(t){t.preventDefault();var a=window.location.href;window.location.href="http://192.168.0.100:9009/apis/oauth/authorizelogin?authorizetype=sina&returnUrl="+encodeURI(a)})},t.fn.insertYmwLoginPop=function(){t(".gsZpPopLoginClose").show(),t(".gs_zp_pop_login").show(),t(".gsZpPopLoginClose").on("click",function(){t(".gs_zp_pop_login").hide(),t(".gsZpPopLoginClose").hide()})},t.fn.removeTarget=function(){return this.each(function(){t(this).find("a").attr("target","_self")})}}(jQuery);
//# sourceMappingURL=main.min.js.map
