!function(t){var a="dev",e={getWapCardComment:function(a,e,n){var i="./data/fake.comment.page1.json";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapCardContext:function(a,e,n){var i="http://192.168.0.100:9009/apis/club/api/getwapcardcontext";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapCardCommentPage2:function(a,e,n){var i="./data/fake.comment.page2.json";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapCardCommentPageOne:function(a,e,n){var i="./data/fake.comment.one.json";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})},getWapCardCommentPageOnePage2:function(a,e,n){var i="./data/fake.comment.one.page2.json";t.ajax({type:"get",dataType:"json",url:i,data:a,beforeSend:function(){"function"==typeof n&&n()},success:function(t){"function"==typeof e&&e(t)},error:function(t){console.log(t)}})}},n=function(t){return"undefined"!=typeof t&&t.replace(/(^\s*)|(\s*$)/g,"")};t.fn.extend({textareaAutoHeight:function(a){this._options={minHeight:0,maxHeight:1e3},this.init=function(){for(var e in a)this._options[e]=a[e];0==this._options.minHeight&&(this._options.minHeight=parseFloat(t(this).height()));for(var e in this._options)null==t(this).attr(e)&&t(this).attr(e,this._options[e]);t(this).keyup(this.resetHeight).change(this.resetHeight).focus(this.resetHeight)},this.resetHeight=function(){var a=parseFloat(t(this).attr("minHeight")),e=parseFloat(t(this).attr("maxHeight"));t.browser.msie||t(this).height(0);var n=parseFloat(this.scrollHeight);n=n<a?a:n>e?e:n,t(this).height(n).scrollTop(n),t(this).css("overflow-y",n>=e?"scroll":"hidden")},this.init()}});var i={isCanLoading:!0,loadingDom:'<div class="qz-loading">正在加载</div>',loadedDom:'<div class="qz-loaded">全部加载完成</div>',loadnullDom:'<div class="qz-loadnull">还没有内容</div>'},o={setRem:function(){var a=t(window).width();a>=640&&(a=640),t("html").css({"font-size":a/6.4+"px"})},createCard:function(a){var e="";if(e+='<div class="qz-card qzCard" data-cid="'+a.cardid+'">',e+='<header><a class="head"><img src="'+a.head+'" alt="head"></a>',e+='<div class="info"><h5>',e+="<a>"+a.user+"</a>",n(a.vauth)&&(e+='<img src="'+a.vauth+'">'),e+="</h5><p>",e+='<span class="time">'+a.createtime+"</span>",e+="</p>",e+="</div>",a.spectop!==!0&&a.specvalue!==!0||(e+='<div class="spec-icons">',a.spectop===!0&&(e+='<a class="spec-top">置顶</a>'),a.specvalue===!0&&(e+='<a class="spec-value">精</a>'),e+="</div>"),e+="</header>",e+='<section class="detail qzZoneHref" data-href="'+a.url+'">',e+='<div class="content">',a.isVideo?(e+=a.text,e+="<a href="+a.video.src+' class="link-video">'+a.video.videoTitle+"</a>"):e+=a.text,e+="</div>",a.piclist.length>0&&(e+='<div class="media-pic-list"><div class="clearfix qz-figs qzPicPswp">',t.each(a.piclist,function(t,a){e+='<figure class="qzPicPswpBtn',"gif"===a.ext?(e+=' gif"',a.large=a.origin):"long"===a.ext&&(e+=' long"'),e+='"><a data-picType="'+a.ext+'" data-origin="'+a.origin+'"  data-large="'+a.large+'" data-size="'+a.size+'"><img src="'+a.url+'"></a></figure>'}),e+="</div></div>"),void 0!=a.picbig.large){a.picbig.large=a.picbig.url;var i="";e+='<div class="qzPicPswp media-pic',"gif"===a.picbig.ext?(i=" gif",a.picbig.large=a.picbig.origin):"long"===a.picbig.ext&&(i=" long"),e+='"><figure class="'+i+'"><a  data-picType="'+a.picbig.ext+'" data-origin="'+a.picbig.origin+'" data-large="'+a.picbig.large+'" data-size="'+a.picbig.size+'"><img src="'+a.picbig.url+'" class="qzPicPswpBtn"></a></figure></div>'}return a.isVideo&&(e+='<div class="media-video">',e+='<a class="qzVideoPopBtn" data-href="'+a.video.src+'"><img src="'+a.video.pic+'" alt=""></a></div>'),e+="</section>",a.fromUrl&&(e+='<div class="from">来自：<a href="'+a.fromUrl+'" >'+a.from+"</a></div>"),e+="<footer>",e+='<a class="btn-like qzBtnLike" data-likecount="" data-clubcontentid="'+a.cardid+'" ><i></i><b>0</b></a><span></span>',e+='<a class="btn-comment qzBtnComment" data-commcount=""  data-clubcontentid="'+a.cardid+'"   data-href="'+a.url+'">0</a>',e+="</footer>",e+="</div>",e+="",e+=""},addSwpOnce:function(){var a='<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button><a target="_blank" class="pswp__button pswpBtnOrigin pswp__single-tap" title="查看原图"></a> <button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div>';t("body").append(a)},photoSwp:function(){var a=function(a){for(var e=function(t){for(var a,e,n,i,o=t.childNodes,c=o.length,d=[],s=0;s<c;s++)a=o[s],1===a.nodeType&&(e=a.children[0],n=e.getAttribute("data-size").split("x"),i={src:e.getAttribute("data-large"),w:parseInt(n[0],10),h:parseInt(n[1],10),ori:e.getAttribute("data-origin"),picType:e.getAttribute("data-picType")},a.children.length>1&&(i.title=a.children[1].innerHTML),e.children.length>0&&(i.msrc=e.children[0].getAttribute("src")),i.el=a,d.push(i));return d},n=function l(t,a){return t&&(a(t)?t:l(t.parentNode,a))},i=function(t){t=t||window.event,t.preventDefault?t.preventDefault():t.returnValue=!1;var a=t.target||t.srcElement,e=n(a,function(t){return t.tagName&&"FIGURE"===t.tagName.toUpperCase()});if(e){for(var i,c=e.parentNode,d=e.parentNode.childNodes,s=d.length,l=0,r=0;r<s;r++)if(1===d[r].nodeType){if(d[r]===e){i=l;break}l++}return i>=0&&o(i,c),!1}},o=function(a,n,i,o){function c(a){t(".pswpBtnOrigin").attr("href",l[a].ori)}var d,s,l,r=t(".pswp")[0];if(l=e(n),s={shareEl:!1,fullscreenEl:!1,zoomEl:!1,bgOpacity:1,showHideOpacity:0,galleryUID:n.getAttribute("data-pswp-uid"),history:!1,getThumbBoundsFn:function(t){var a=l[t].el.getElementsByTagName("img")[0],e=window.pageYOffset||document.documentElement.scrollTop,n=a.getBoundingClientRect();return{x:n.left,y:n.top+e,w:n.width}}},o)if(s.galleryPIDs){for(var p=0;p<l.length;p++)if(l[p].pid==a){s.index=p;break}}else s.index=parseInt(a,10)-1;else s.index=parseInt(a,10);isNaN(s.index)||(i&&(s.showAnimationDuration=0),d=new PhotoSwipe(r,PhotoSwipeUI_Default,l,s),d.init(),d.listen("initialZoomIn",function(){c(d.getCurrentIndex()),t(".pswp").animate({opacity:1},333)}),d.listen("initialZoomOut",function(){t(".pswp").animate({opacity:0},200)}),d.listen("afterChange",function(){c(d.getCurrentIndex())}))},c=document.querySelectorAll(a),d=0,s=c.length;d<s;d++)c[d].setAttribute("data-pswp-uid",d+1),c[d].onclick=i};a(".qzPicPswp")},insertCard:function(a,e){var n="";t.each(e,function(t,a){n+=o.createCard(a)}),t(a).html(n),t(".qzBtnLike").like(),t(".qzBtnLike").addLike(),t(".qzCard .content").removeTarget(),t(".qzBtnComment").commentCount(),o.photoSwp(),o.openVideoPop()},appendCard:function(a,e){var n="";t.each(e,function(t,a){n+=o.createCard(a)}),t(a).append(n),t(".qzBtnLike").like(),t(".qzBtnLike").addLike(),t(".qzCard .content").removeTarget(),t(".qzBtnComment").commentCount(),o.photoSwp(),o.openVideoPop()},addContext:function(){function a(a){function e(){d.find(".realIpt").on("input",function(){d.find(".mathIpt").val(d.find(".realIpt").val());var t=d.find(".mathIpt")[0].scrollHeight;d.find(".realIpt").css("height",t)})}function i(){d.removeClass("cur"),t("html,body").removeClass("hideScroll").animate({scrollTop:a},0),setTimeout(function(){d.remove()},250)}var o=t(".topic").attr("data-topic");""==o&&(o=t(".topic").attr("data-selecttopic"));var c="";c+='<div class="qz-pop qzPop">',c+='<header>发布内容<a class="qz-pop-close qzPopClose"></a><a class="qz-pop-smt qzPopSmt">发布</a></header>',c+='<div class="pop-con">',c+='<div class="pop-srl"><textarea class="realIpt" placeholder="分享你的游戏心得...">',n(o)&&(c+=o),c+='</textarea > <textarea class="mathIpt" rows="3"></textarea></div > ',c+='<div class="clearfix qz-pic-list">',c+='<div class="qz-pic-list-li"><label for="qzSelectPhoto" class="qz-pic-list-add"></label></div>',c+="</div>",c+='<input id="fileupload" data-imagesize="5120"  type="file" style="display:none" name="files" method="POST" multiple="">',c+="</div>",c+='<footer><label for="qzSelectPhoto" class="qz-upload-pic qzUploadPic">图片</label><select class="qz-pop-sel">',c+="</select>",c+="</footer></div>",t("body").append(c);var d=t(".qzPop"),s=t(".clubList").html();t(".qz-pop-sel").html(s),t(".qz-pic-list-add,.qzUploadPic").selectPhoto(),t(".qz-pop-sel").change(function(a){a.preventDefault();var e=t(this).find("option:selected").val();t(".clubId").attr("data-selectclubid",e)}),setTimeout(function(){d.addClass("cur")},10),e(),t(".qzPopClose").on("click",i),d.fabuSubmit(a)}t("#qzMain").on("click",".qzBtnContext",function(){t(this).UserOnline(function(e){if("ok"==e.status){var n=t("html").scrollTop();0===n&&(n=t("body").scrollTop()),setTimeout(function(){t("html,body").addClass("hideScroll")},300),a(n)}})})},addComment:function(){function e(a,e,n,i,o){function c(){r.find(".realIpt").on("input",function(){r.find(".mathIpt").val(r.find(".realIpt").val());var t=r.find(".mathIpt")[0].scrollHeight;r.find(".realIpt").css("height",t)})}function d(){r.removeClass("cur"),t("html,body").removeClass("hideScroll").animate({scrollTop:a},0),setTimeout(function(){r.remove()},250)}var s="",l=i?"回复 "+i+"：":"我来说两句...";s+='<div class="qz-pop qzPop">',s+='<header>评论<a class="qz-pop-close qzPopClose"></a><a data-userId="'+o+'" data-clubContentId="'+e+'"  data-commentId="'+n+'" class="qz-pop-smt qzPopSmt">发布</a></header>',s+='<div class="pop-con"><div class="pop-srl"><textarea class="realIpt" placeholder="'+l+'"></textarea><textarea class="mathIpt" rows="3"></textarea></div></div>',s+="</div>",t("body").append(s);var r=t(".qzPop");setTimeout(function(){r.addClass("cur")},10),c(),t(".qzPopClose").on("click",d),t(".qzPopSmt").on("click",function(){r.find(".realIpt").val();t(this).addComment(a)})}function n(n){n.UserOnline(function(i){if("ok"==i.status||"dev"===a){var o=t("html").scrollTop(),c=n.data("clubcontentid"),d=(n.data("commcount"),n.data("href"),n.data("userid")),s=n.data("commid"),l=n.attr("data-name");0===o&&(o=t("body").scrollTop()),setTimeout(function(){t("html,body").addClass("hideScroll")},300),e(o,c,s,l,d)}})}t("#qzMain").on("click",".qzBtnComment",function(){var a=t(this),n=a.data("commcount"),i=a.data("href");return n>0&&t("#qzCardContext").length<1?(window.open(i,"_blank"),!1):void a.UserOnline(function(n){if("ok"==n.status){var i=t("html").scrollTop(),o=a.data("clubcontentid"),c=a.data("commcount"),d=a.data("userid"),s=a.data("commid"),l=a.attr("data-name");if(t("#qzCardContext").length>0)return 0===i&&(i=t("body").scrollTop()),setTimeout(function(){t("html,body").addClass("hideScroll")},300),e(i,o,s,l,d),!1;0!==c&&""!=c||(0===i&&(i=t("body").scrollTop()),setTimeout(function(){t("html,body").addClass("hideScroll")},300),e(i,o,s,l,d))}})}),t("#qzMain").on("click",".qzBtnCommentInner",function(){var a=t(this);n(a)})},initPage:function(){var a="#qzCardList",e=t(a);if(e.length>0){var n=t(".qzNavFx a.cur").attr("data-type"),c=t(".qz-nav-sort").attr("data-sort"),d=t(".clubId").attr("data-clubId"),s=t(".topic").attr("data-topic"),l=t(".topic").attr("data-topicId"),r=parseInt(e.attr("data-pageIndex"))+1,p=e.attr("data-pageSize"),u="http://192.168.0.100:9009/apis/club/api/getwapclubcontent",m={contentType:n,sort:c,pageIndex:r,pageSize:p,clubId:d,topic:s,topicId:l};t.ajax({type:"get",dataType:"json",url:u,data:{jsondata:JSON.stringify(m)},beforeSend:function(){e.append(i.loadingDom)},success:function(t){"ok"===t.dataType?(e.attr("data-pageIndex",r),e.attr("data-infiload","open"),o.insertCard(a,t.cardgroup)):e.html(i.loadnullDom)}})}},initPageTopic:function(){var a="#qzCardListTopic",e=t(a);if(e.length>0){var n="http://192.168.0.100:9009/apis/club/api/GetWapClubContentByTopic",c=t(".clubId").attr("data-selectClubId"),d=t(".topic").attr("data-topic"),s={clubId:c,topicTitle:d,pageIndex:0};t.ajax({type:"post",dataType:"json",url:n,data:{jsondata:JSON.stringify(s)},beforeSend:function(){e.append(i.loadingDom)},success:function(n){var c=t.parseJSON(n.body);"ok"===c.dataType&&c.cardgroup.length>0?(t(".comeFrom").html(c.cardgroup[0].from),e.attr("data-page",c.page),e.attr("data-moreload","open"),o.insertCard(a,c.cardgroup),c.count<=1&&t(".qzCardMoreBtn").remove(),t(".qz-rem").css("display","block")):e.html(i.loadnullDom)}})}},initPageContext:function(){function a(){function a(){var a,e,n=t(".qzClCon.cur").attr("id");if("qzClLike"===n)if(a="#qzClLike",e=t(a),"open"===e.attr("data-infiload")){var c=e.attr("data-cid"),d=parseInt(e.attr("data-page"))+1,s=10,l={clubContentId:c,pageIndex:d,pageSize:s};t.ajax({type:"get",dataType:"json",url:"http://192.168.0.100:9009/apis/club/api/getwapclubuserlike",data:{jsondata:JSON.stringify(l)},beforeSend:function(){e.append(i.loadingDom)},success:function(n){var c=t.parseJSON(n.body);e.find(".qz-loading").remove(),c.likelist.length>0?(e.attr("data-page",c.page),o.appendCardLike(a,c.likelist)):"open"===e.attr("data-infiload")&&(e.attr("data-infiload","close"),e.append(i.loadedDom)),i.isCanLoading=!0}})}else i.isCanLoading=!0}function e(){var e=t("html").scrollTop(),n=t(document).height(),o=t(window).height();0===e&&(e=t("body").scrollTop()),e>n-o-20&&e>o-n&&i.isCanLoading===!0&&(i.isCanLoading=!1,a())}t(n).length>0&&t(window).scroll(function(){e()})}var n="#qzCardContext",c=t(n);if(c.length>0){var d={clubContentId:c.attr("data-cid")},s={jsondata:JSON.stringify(d)};e.getWapCardContext(s,function(a){var e=t.parseJSON(a.body);"ok"===e.dataType?(c.attr("data-page",e.page),o.insertCard(n,e.cardgroup)):c.html(i.loadnullDom)},function(){c.append(i.loadingDom)});var l="#qzClComment",r={clubContentId:t(l).attr("data-cid"),pageIndex:parseInt(t(l).attr("data-page"))+1,pageSize:10},p={jsondata:JSON.stringify(r)};e.getWapCardComment(p,function(a){var e=a.body,n=!1;"ok"===e.dataType?(t(".commentNum i,#qzCardContext .qzBtnComment").html(e.count),t(l).attr("data-page",e.page).addClass("qz-cl-comment-full"),e.page<Math.ceil(e.count/e.sumcount)&&(n=!0),o.insertCardComment(l,e.commlist,n)):t(l).html(i.loadnullDom)},function(){t(l).append(i.loadingDom)}),t(document).on("tap",".clubCardCommentMore",function(){var a=t(this),n=a.data("clk");if("can"===n){var c="#qzClComment",d=t(c),s=d.attr("data-cid"),l=d.find("li:first").attr("data-commid"),r=parseInt(d.attr("data-page"))+1,p=10,u={clubContentId:s,pageIndex:r,pageSize:p,excludeCommentId:l},m={jsondata:JSON.stringify(u)};e.getWapCardCommentPage2(m,function(t){d.find(".qz-loading").remove();var a=t.body,e=!1;"ok"===a.dataType&&(a.page<Math.ceil(a.count/a.sumcount)&&(e=!0),o.appendCardComment(c,a.commlist,e))},function(){d.find(".club-card-comment-more").remove(),d.append(i.loadingDom)})}}),a()}},infiniteLoad:function(a,e){function n(){var n=t(a);"open"===n.attr("data-infiload")&&"function"==typeof e&&e(a,n)}function o(){var a=t("html").scrollTop(),e=t(document).height(),o=t(window).height();0===a&&(a=t("body").scrollTop()),a>e-o-20&&a>o-e&&i.isCanLoading===!0&&(i.isCanLoading=!1,n())}t(a).length>0&&t(window).scroll(function(){o()})},topicMore:function(){var a=t(".qzCardMoreBtn");a.on("click",function(){var e=t("#qzCardListTopic");if(e.length>0&&"open"===e.attr("data-moreload")){var n="http://192.168.0.100:9009/apis/club/api/GetWapClubContentByTopic",c=t(".clubId").attr("data-selectClubId"),d=t(".topic").attr("data-topic"),s=e.find(".qzCard").attr("data-cid"),l=parseInt(e.attr("data-pageIndex")),r=0==l?9:10;l=0==l?1:l+1;var p={clubId:c,topicTitle:d,excludeclubContentId:s,pageIndex:l,pageSize:r};t.ajax({type:"get",dataType:"json",url:n,data:{jsondata:JSON.stringify(p)},beforeSend:function(){e.append(i.loadingDom)},success:function(n){var i=t.parseJSON(n.body);e.find(".qz-loading").remove(),i.cardgroup.length>0?(e.attr("data-pageIndex",l),o.appendCard("#qzCardListTopic",i.cardgroup),i.cardgroup.length<r&&(e.attr("data-moreload","close"),a.html("全部加载完成"))):"open"===e.attr("data-moreload")&&(e.attr("data-moreload","close"),a.html("全部加载完成"))}})}})},tabNav:function(){function a(){function a(){var a=s.offset().top,e=t("html").scrollTop();0===e&&(e=t("body").scrollTop()),e>=a?d.addClass("openQzNavFixed"):d.removeClass("openQzNavFixed")}function e(){var a=t("html"),e=a.height(),n=s.offset().top,i=a.scrollTop();0===i&&(i=t("body").scrollTop()),a.css("height",e),i>n&&t("html,body").animate({scrollTop:n},0)}function n(){var a=t("html");clearTimeout(o),o=setTimeout(function(){a.css("height","")},200)}var o,c=t(".qzNavFx"),d=t(".qzNavFxW"),s=t(".qzNavPos");a(),t(window).scroll(function(){a()}),c.find("a").on("click",function(){var a=t(this),o="#qzCardList";c.find("a").removeClass("cur"),a.addClass("cur"),t(o).html("").attr("data-pageIndex",0).attr("data-loading",!1),i.isCanLoading=!1,e(),t(o).getClub(function(){n()})})}t(".qzNavFx").length>0&&a()},tabCl:function(){var a=t(".tabNavCl"),e=t(".qzClCon");a.find("a").on("click",function(){var n=t(this),c=n.data("tar");if(a.find("a").removeClass("cur"),e.removeClass("cur"),n.addClass("cur"),t("."+c).addClass("cur"),"qzClLike"===c){var d="#qzClLike",s="http://192.168.0.100:9009/apis/club/api/getwapclubuserlike",l=t(d),r=l.attr("data-cid"),p=1,u=10,m={clubContentId:r,pageIndex:p,pageSize:u};void 0===t(d).attr("data-page")&&t.ajax({type:"post",dataType:"json",data:{jsondata:JSON.stringify(m)},url:s,beforeSend:function(){t(d).append(i.loadingDom)},success:function(a){var e=t.parseJSON(a.body);t(d).find(".qz-loading").remove(),"ok"===e.dataType?(t(d).attr("data-page",e.page),t(d).attr("data-infiload","open"),o.appendCardLike(d,e.likelist)):t(commtar).html(i.loadnullDom)}})}})},pageGoto:function(){var a=t(".qz-card-list");a.on("click",".qzCard .qzZoneHref",function(){var a=t(this),e=a.data("href");window.open(e,"_blank")}),a.on("click",".qzZoneHref figure,.qzZoneHref a",function(t){t.stopPropagation()})},createCardComment:function(t){var a="";return a+='<li data-commid="'+t.commid+'"><a class="head">',a+='<img src="'+t.head+'" alt="'+t.name+'"></a>',a+='<div class="info qzBtnComment" data-clubcontentid="'+t.clubContentId+'" data-commid="'+t.commid+'" data-name="'+t.name+'"  data-userId="'+t.useId+'">',a+="<h5>"+t.name,t.reply&&(a+="<b>回复</b>"+t.reply),a+="</h5>",a+='<p class="time">'+t.replytime+"</p>",a+='<div class="context">',a+=t.context,a+="</div></div></li>"},createCardCommentFull:function(a){var e="";return e+='<li data-commid="'+a.commid+'"',e+=a.replylike>=5?' class="with-hot-tags">':">",e+='<a class="head">',e+='<img src="'+a.head+'" alt="'+a.name+'"></a>',e+='<div class="info">',e+="<h5>"+a.name,a.editauth&&(e+='<img src="'+a.editauth+'" alt="编辑">'),e+="</h5>",e+='<div class="context">',e+=a.context,e+="</div>",null!==a.reply&&(e+='<div class="info-comment">',t.each(a.reply,function(t,a){t<2&&(e+='<div class="ic-item"><a class="ici-name">'+a.name+"</a>",null!==a.reply&&(e+='回复<a class="ici-name">'+a.reply+"</a>"),e+='：<span class="ici-context">'+a.context+"</span></div>")}),a.reply.length>2&&(e+='<a class="info-comment-more">查看全部'+a.replycount+"条回复</a>"),e+='<a target="_blank" href="'+a.url+'" class="info-comment-link"></a></div>'),e+='<div class="info-bottom"><span class="info-time">'+a.replytime+'</span><span class="info-device">'+a.replydevice+'</span><a class="info-like">'+a.replylike+'</a><a class="info-reply qzBtnCommentInner" data-clubcontentid="'+a.clubContentId+'" data-commid="'+a.commid+'" data-name="'+a.name+'" data-userid="'+a.useId+'">回复</a></div>',e+="</div></li>"},createCardCommentList:function(t){var a="";return a+='<li data-commid="'+t.commid+'"><a class="head">',a+='<img src="'+t.head+'" alt="'+t.name+'"></a>',a+='<div class="info qzBtnCommentInner" data-clubcontentid="'+t.clubContentId+'" data-commid="'+t.commid+'" data-name="'+t.name+'"  data-userId="'+t.useId+'">',a+="<h5>"+t.name,t.reply&&(a+="<b>回复</b>"+t.reply),a+="</h5>",a+='<p class="time">'+t.replytime+"</p>",a+='<div class="context">',a+=t.context,a+="</div></div></li>"},insertCardComment:function(a,e,n){var i="";t.each(e,function(t,a){i+=o.createCardCommentFull(a)}),i+=n===!0?'<a class="club-card-comment-more clubCardCommentMore" data-clk="can">查看更多</a>':'<a class="club-card-comment-more">全部加载完成</a>',t(a).html(i)},appendCardComment:function(a,e,n){var i="";t.each(e,function(t,a){i+=o.createCardCommentFull(a)}),i+=n===!0?'<a class="club-card-comment-more clubCardCommentMore" data-clk="can">查看更多</a>':'<a class="club-card-comment-more">全部加载完成</a>',t(a).append(i)},createCardLike:function(t){var a="";return a+='<li data-likeid="'+t.likeid+'"><a class="head">',a+='<img src="'+t.head+'" alt="'+t.name+'"></a>',a+='<div class="name"><a>'+t.name+"</a></div>",a+="</div></li>"},insertCardLike:function(a,e){var n="";t.each(e,function(t,a){n+=o.createCardLike(a)}),t(a).html(n)},appendCardLike:function(a,e){var n="";t.each(e,function(t,a){n+=o.createCardLike(a)}),t(a).append(n)},openVideoPop:function(){function a(a){function e(){i.removeClass("cur"),setTimeout(function(){i.remove()},250)}var n="";n+='<div class="qz-video-pop qzVideoPop">',n+='<div class="qz-video-pop-con">',n+='<iframe height="100%" width="100%" src="http://player.youku.com/embed/'+a+'" frameborder=0 allowfullscreen></iframe>',n+="</div>",n+='<div class="qz-video-bar"><a class="qz-video-pop-close qzVideoPopClose"></div></a>',n+="</div>",t("body").append(n);var i=t(".qzVideoPop");setTimeout(function(){i.addClass("cur")},10),i.on("click",e),i.on("click","iframe",function(t){t.stopPropagation()})}t(".qzVideoPopBtn").on("click",function(){var e=t(this),n=e.data("href"),i="",o="http://v.youku.com/v_show/id_",c=n.indexOf(o)+o.length,d=n.indexOf("==.html");i=n.substring(c,d),a(i)})},createAllTopic:function(t){var a="";return a+='<li data-topicid="'+t.Id+'" data-topic="'+t.Title+'"><a href="http://192.168.0.100:9009/apis/m/topic/'+t.Id+'"><b>'+t.Title+'</b><span><i class="num-in">0</i>人参与<i class="num-comm">0</i>条主题</span></a></li>'},allTopic:function(){function a(a){var e="";t.each(a,function(t,a){e+=o.createAllTopic(a)}),c.html(e),t("#qzAllTopicList li").allTopicJoinCount()}function e(a){var e="";t.each(a,function(t,a){e+=o.createAllTopic(a)}),c.append(e),t("#qzAllTopicList li").allTopicJoinCount()}function n(){var e=parseInt(c.attr("data-page"))+1,n={pageIndex:e,pageSize:s};t.ajax({type:"get",dataType:"jsonp",url:d,data:{jsondata:JSON.stringify(n)},success:function(t){c.attr({"data-page":e,"data-infiload":"open"}),a(t)}})}var c=t("#qzAllTopicList"),d="http://192.168.0.100:9009/apis/club/api/gettopicall",s=c.attr("data-pageSize");c.length>0&&(n(),o.infiniteLoad("#qzAllTopicList",function(a,n){var o=t("#qzMain"),l=parseInt(c.attr("data-page"))+1,r={pageIndex:l,pageSize:s};t.ajax({type:"get",dataType:"jsonp",url:d,data:{jsondata:JSON.stringify(r)},beforeSend:function(){o.append(i.loadingDom)},success:function(t){o.find(".qz-loading").remove(),t.length>0?(n.attr("data-page",l),e(t)):"open"===n.attr("data-infiload")&&(n.attr("data-infiload","close"),o.append(i.loadedDom)),i.isCanLoading=!0}})}))},cardInnerCommentPageTop:function(t){var a="";return a+='<div class="cc-one-top">',a+='<a class="head"><img class="head-pic" src="'+t.head+'" alt="'+t.name+'"><h5>'+t.name+"</h5>",t.editauth&&(a+='<img class="head-icon" src="'+t.editauth+'" alt="编辑">'),a+="</a>",a+='<div class="info">',a+='<div class="context">'+t.context+"</div>",a+='<div class="info-bottom">',a+='<span class="info-time">'+t.replytime+'</span><span class="info-device">'+t.replydevice+"</span>",a+='<a class="info-like">'+t.replylike+'</a><a class="info-reply qzBtnCommentInner" data-clubcontentid="'+t.clubContentId+'" data-commid="'+t.commid+'" data-name="'+t.name+'" data-userid="'+t.useId+'">回复</a><a class="info-delete clubCommentDelete">删除</a>',a+="</div></div>",a+="</div>"},cardInnerCommentPageList:function(a){var e="";return e+='<div class="cc-one-list">',t.each(a.reply,function(t,n){e+="<li>",e+='<a class="head"><img src="'+n.head+'" alt="'+n.name+'"></a>',e+='<div class="info">',e+="<h5>"+n.name,n.editauth&&(e+='<img src="'+n.editauth+'" alt="编辑">'),e+="</h5>",e+='<div class="context">',null!==n.reply&&(e+='<span class="context-reply-tags">回复</span><span class="context-reply">'+n.reply+":</span>"),e+=n.context+"</div>",e+='<div class="info-bottom">',e+='<span class="info-time">'+n.replytime+'</span><span class="info-device">'+n.replydevice+"</span>",e+='<a class="info-like">'+n.replylike+'</a><a class="info-reply qzBtnCommentInner"  data-clubcontentid="'+a.clubContentId+'" data-commid="'+n.commid+'" data-name="'+n.name+'" data-userid="'+a.useId+'">回复</a>',e+="</div></div>",e+="</li>"}),e+="</div>"},cardInnerCommentPage:function(){function a(){function a(){var a={commid:o.data("cid"),page:l++};e.getWapCardCommentPageOnePage2(a,function(a){o.find(".qz-loading").remove();var e=a.body,n="";if("ok"===e.dataType){var i=e.commlist[0];n+=c.cardInnerCommentPageList(i),i.replyPage*i.replysize<i.replycount?o.find(".club-comment-one-more").html("查看更多"):o.find(".club-comment-one-more").removeClass("clubCommentOneMore").addClass("club-comment-one-more-all").html("全部加载完成"),t(n).insertBefore(".club-comment-one-bottom")}},function(){t(i.loadingDom).insertBefore(".club-comment-one-bottom")})}var n="",d="",s="",l=1,r={commid:o.data("cid")};e.getWapCardCommentPageOne(r,function(t){var a=t.body;if("ok"===a.dataType){var e=a.commlist[0];n+=c.cardInnerCommentPageTop(e),d+=c.cardInnerCommentPageList(e),s+=n,s+=d,s+='<div class="club-comment-one-bottom">',s+='<a class="club-comment-one-reply qzBtnCommentInner" data-clubcontentid="'+e.clubContentId+'" data-commid="'+e.commid+'" data-name="'+e.name+'" data-userid="'+e.useId+'">发表回复</a>',s+=e.reply.length<e.replycount?'<a class="club-comment-one-more clubCommentOneMore">查看更多</a>':'<a class="club-comment-one-more club-comment-one-more-all">全部加载完成</a>',s+="</div>",o.html(s)}}),t(document).on("click",".clubCommentOneMore",function(){a()})}function n(){a(),t(document).on("click",".clubCommentDelete",function(){var t=confirm("你确定删除吗？");t===!0?console.log("确定删除"):console.log("取消")})}var o=t("#clubCommentOne"),c=this;o.length>0&&n()},main:function(){o.setRem(),o.addSwpOnce(),o.addComment(),o.addContext(),o.initPageTopic(),o.initPageContext(),o.tabNav(),o.infiniteLoad("#qzCardList",function(t,a){a.getClub()}),o.topicMore(),o.tabCl(),o.pageGoto(),o.allTopic(),o.cardInnerCommentPage(),t(window).resize(function(){o.setRem()})}};o.main(),t(document).ready(function(){t("#qzCardList").getClub(),t(".qzBtnLike").addLike(),t(".themeNum").joinCount(),t(".qz-nav-sort").change(function(a){a.preventDefault();var e=t(this).find("option:selected").attr("data-sort");t(this).attr("data-sort",e),t("#qzCardList").html("").attr("data-pageIndex",0).attr("data-loading",!1).getClub()})}),t.fn.fabuSubmit=function(a){return this.each(function(){var e=t(this),i=parseInt(e.find(".maxNum").html()),c=e.find(".mathIpt"),d=c.height(),s=parseInt(c.css("line-height")),l=15*s;c.textareaAutoHeight({minHeight:d,maxHeight:l}),e.on("focus",".mathIpt",function(){var a=t(this),e=a.attr("placeholder");a.attr("data-val",e).removeAttr("placeholder").parent().addClass("cur")}).on("blur",".mathIpt",function(){var a=t(this),e=a.attr("data-val");a.attr("placeholder",e).parent().removeClass("cur")}).on("keyup blur",".mathIpt",function(){var t=this.value.length;this.value=this.value.substr(0,i),e.find(".curNum").html(t),e.find(".fabu-num").css("display",t>0?"block":"")}),e.on("click",".qzPopSmt",function(){var e=t(".qz-pic-list-li:not(.temp)"),i=t(".fabuVideo"),c=t(".mathIpt").val(),d=""==c?t(".realIpt").html():c,s=t(".clubId").attr("data-selectClubId");if("true"!=t(this).attr("data-isclick")){t(this).attr("data-isclick",!0);var l="",r=e.length>9?9:e.length-1;if(r>0){l=[];for(var p=0;p<r;p++){var u=e.eq(p).find("img").attr("data-type"),m=e.eq(p).find("img").attr("src"),f=m.replace("tiny","small"),h=m.replace("tiny","origin"),g=m.replace("tiny","tinysquare");"gif"==u&&(h=h.replace(".jpg",".gif"));var v=e.eq(p).find("img").attr("data-height"),b=e.eq(p).find("img").attr("data-width");l.push({tiny:m,tinysquare:g,small:f,origin:h,height:v,width:b,imageType:u})}}var C="";if(i.length>0){var y="",z="",q="",I="",k="";void 0==i.attr("data-tit")?z="视频链接":(y=i.attr("data-vid"),z=i.attr("data-tit"),I=i.attr("data-img"),k=i.attr("data-sitename")),q=i.attr("data-url"),C={image:I,title:z,videoUrl:q,videoVid:y,siteName:k}}if(""==l&&""==C&&!n(d))return void alert("你还没有输入内容!");var w={content:d,images:l,videos:C,clubId:s,device:1};t.ajax({type:"post",dataType:"json",url:"http://192.168.0.100:9009/apis/club/api/addclubcontent",data:{jsondata:JSON.stringify(w)},success:function(e){if("ok"==e.dataType){t(this).attr("data-isclick",!1),t(".mathIpt").val("");var n=o.createCard(e.cardgroup);t("#qzCardList").prepend(n),o.photoSwp(),t(".qzBtnLike").like(),t(".qzBtnLike").addLike(),t(".qzBtnComment").commentCount(),t("html,body").removeClass("hideScroll").animate({scrollTop:a},0),setTimeout(function(){t(".qzPop").remove()},250)}else alert("发布失败，请重试！")}})}})})},t.fn.selectPhoto=function(){return this.each(function(){t(this).bind("click",function(){t("#fileupload").trigger("click"),t("#fileupload").fileupload({dataType:"json",maxFileSize:"5000000",url:"http://192.168.0.100:9009/apis/uploadpic/index",done:function(a,e){var n=e.result;if("ok"==n.status){var i=t(".qz-pic-list-li .qz-img-remove").length+1;if(i>9)alert("最多只能传9张"),t(".qz-pic-list .temp:first").remove();else{9==i&&t(".qz-pic-list-add").parent().css("display","none");var o="<img src='"+n.tiny+"' data-original='"+n.original+"' data-height=\""+n.height+'" data-width="'+n.width+'" data-type="'+n.imageclass+"\"><a class='qz-img-remove'></a>";t(".qz-pic-list .temp:first").removeClass("temp").html(o)}t(".qz-pic-list .qz-img-remove").each(function(){t(this).unbind("click"),t(this).bind("click",function(){var a=t(this).parents(".pic").find("img").attr("data-original"),e=t(".qz-pic-list-li").not(":last").length;t(this).parent(".qz-pic-list-li").remove(),t.ajax({type:"get",dataType:"json",url:"http://192.168.0.100:9009/apis/uploadpic/delete?origin="+a,data:{},success:function(t){}}),e<9&&t(".qz-pic-list-add").parent().css("display","block")})})}else alert("包含不支持的文件格式"),t(".qz-pic-list .temp:first").remove()},change:function(a,e){var n=0,i=parseInt(t("#fileupload").attr("data-imagesize")),o=i/1024;t.each(e.files,function(a,e){if(e.size/1024>i&&n<=0)n+=1,alert("图片容量超过"+o+"MB，无法上传！");else if(e.size/1024<=i){var c='<div class="qz-pic-list-li temp"><img src="http://image.gamersky.com/webimg15/user/club/pc/loading.gif" ></div>';t(".qz-pic-list-li:first").before(c)}})}})})})},t.fn.getClub=function(a){return this.each(function(){var e=t(this),n=t(".qzNavFx a.cur").attr("data-type"),c=t(".qz-nav-sort").attr("data-sort"),d=t(".clubId").attr("data-clubId"),s=t(".topic").attr("data-topic"),l=t(".topic").attr("data-topicId"),r=parseInt(e.attr("data-pageIndex"))+1,p=e.attr("data-pageSize"),u=e.attr("data-loading");
if("true"!=u){e.attr("data-loading","true");var m=e.find(".qzCard").length,f=0,h=e.find(".qzCard:first").attr("data-cid");void 0!=h&&null!=h||(h=""),m>=50&&(f=m-50),h+=",",e.find(".qzCard:gt("+f+")").each(function(){h+=t(this).attr("data-cid")+","});var g={contentType:n,sort:c,pageIndex:r,pageSize:p,clubId:d,topic:s,topicId:l,excludeIds:h};e.attr("data-pageIndex",r),t.ajax({type:"get",dataType:"json",url:"http://192.168.0.100:9009/apis/club/api/getwapclubcontent",data:{jsondata:JSON.stringify(g)},beforeSend:function(){t(".qz-loadnull,.qz-loaded").remove(),e.append(i.loadingDom)},success:function(n){var c=t.parseJSON(n.body);e.attr("data-loading","false"),e.find(".qz-loading").remove();var d=c.cardgroup.length;1==r&&0==d?e.html(i.loadnullDom).attr("data-infiload","close"):1==r&&d>0?(o.insertCard(e,c.cardgroup),d>=p?(e.attr("data-infiload","open"),i.isCanLoading=!0):(i.isCanLoading=!1,e.attr("data-infiload","close").append(i.loadedDom))):r>1&&d>0?(o.appendCard(e,c.cardgroup),e.attr("data-infiload","open"),i.isCanLoading=!0):e.attr("data-infiload","close").append(i.loadedDom),"function"==typeof a&&a&&a()}})}})},t.fn.like=function(){var a="";t(this).each(function(){""!=a&&(a+=","),a+=t(this).attr("data-clubcontentid")});var e={clubContentId:a};t.ajax({type:"get",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/club/api/getlike",data:{jsondata:JSON.stringify(e)},success:function(a){if("ok"==a.status){var e=t.parseJSON(a.body);t.each(e,function(a,e){t(".qzBtnLike[data-clubcontentid='"+e.Id+"']").each(function(){t(this).find("b").html(e.digg),t(this).attr("data-likecount",e.digg)})})}}})},t.fn.addLike=function(a){return this.each(function(){var a=t(this);a.unbind("click"),a.click(function(e){e.preventDefault(),t(this).UserOnline(function(e){if("ok"==e.status){var n=a.attr("data-clubcontentid"),i={clubContentId:n,fromDevice:1};t.ajax({type:"get",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/club/api/addlike",data:{jsondata:JSON.stringify(i)},success:function(e){if("err"==e.status)alert(e.body);else{var n=parseInt(a.find("b").html())+1;a.find("b").html(n),t(".tabNavCl a").eq(1).find("i").html(n)}}})}})})})},t.fn.commentCount=function(){var a="";t(this).each(function(){""!=a&&(a+=","),a+=t(this).attr("data-clubcontentid")});var e={clubContentId:a};t.ajax({type:"get",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/club/api/getcommentcount",data:{jsondata:JSON.stringify(e)},success:function(a){if("ok"==a.status){var e=t.parseJSON(a.body);t.each(e,function(a,e){t(".qzBtnComment[data-clubcontentid='"+e.Id+"']").each(function(){t(this).parents(".qzClComment").length>0||(t(this).html(e.commentCount),t(this).attr("data-commcount",e.commentCount),t("#qzCardList").length>0&&e.commentCount>0&&t(this).insertListComment())})})}}})},t.fn.insertListComment=function(){var a=t(this),e=a.closest(".qzCard"),n="",i="http://192.168.0.100:9009/apis/club/api/getwapclubcomment",c=1,d=a.data("clubcontentid"),s={clubContentId:d,pageIndex:c,pageSize:10};t.ajax({type:"get",dataType:"json",url:i,data:{jsondata:JSON.stringify(s)},success:function(i){var c=t.parseJSON(i.body);"ok"===c.dataType&&"ok"!=a.attr("data-isinsert")&&(a.attr("data-isinsert","ok"),n+='<div class="qz-comment-inlist"><ul>',t.each(c.commlist,function(t,a){t<3&&(n+=o.createCardCommentList(a))}),n+="</ul></div>",t(n).insertBefore(e.find("footer")))}})},t.fn.joinCount=function(){var a="";t(this).each(function(){""!=a&&(a+=","),a+=t(this).attr("data-topic")});var e={topic:a};t.ajax({type:"get",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/club/api/getjoinarraycount",data:{jsondata:JSON.stringify(e)},success:function(a){"ok"==a.status&&t.each(a.result,function(a,e){t(".themeNum[data-topic='"+e.topic+"']").each(function(){t(this).find(".join").html(e.join+"人"),t(this).find(".theme").html(e.clubContent),t(this).find("span i").html(e.clubContent)})})}})},t.fn.allTopicJoinCount=function(){var a="";t(this).each(function(){""!=a&&(a+=","),a+=t(this).attr("data-topic")});var e={topic:a};t.ajax({type:"get",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/club/api/getjoinarraycount",data:{jsondata:JSON.stringify(e)},success:function(a){"ok"==a.status&&t.each(a.result,function(a,e){t("#qzAllTopicList li[data-topic='"+e.topic+"']").each(function(){t(this).find(".num-in").html(e.join),t(this).find(".num-comm").html(e.clubContent)})})}})},t.fn.addComment=function(a){var e=t(this);if("true"!=e.attr("data-isclick")){e.attr("data-isclick",!0);var n=t.trim(e.parent().siblings(".pop-con").find(".mathIpt").val()),i=e.data("userid"),c=e.data("clubcontentid"),d=e.data("commentid");if(""==n)return void alert("评论不能为空！");if(n.length>=5e3)return void alert("评论不能超过5000个字符！");var s={userId:i,clubContentId:c,content:n,replyId:d,fromDevice:1};t.ajax({type:"post",dataType:"json",url:"http://192.168.0.100:9009/apis/club/api/addcomment",data:{jsondata:JSON.stringify(s)},success:function(n){if("ok"==n.dataType){e.attr("data-isclick",!1);var i=t("#qzClComment");if(i.length>0){var d=o.createCardComment(n.commlist);0==i.find("li").length?i.html(d):i.prepend(d);var s=parseInt(t(".commentNum i,.qzBtnComment").html())+1;t(".commentNum i,#qzCardContext .btn-comment").html(s)}else t(".qzBtnComment[data-clubcontentid="+c+"]").html("1").attr("data-commcount",1);t(".qzPop").removeClass("cur"),t("html,body").removeClass("hideScroll").animate({scrollTop:a},0),setTimeout(function(){t(".qzPop").remove()},250)}else alert(n.body)}})}},t.fn.UserOnline=function(e){t.ajax({type:"GET",dataType:"jsonp",url:"http://192.168.0.100:9009/apis/api/logincheck",success:function(n){"dev"===a?e(n):"ok"!==n.status?(t(".ymw-loginpop-btns").insertYmwLoginPop(),t(".ymw-loginpop-btns").QZloginForm()):e(n)}})},t.fn.QZloginForm=function(){var a=t(this);a.on("click","#qqLogin",function(t){t.preventDefault();var a=window.location.href;window.location.href="http://192.168.0.100:9009/apis/oauth/authorizelogin?authorizetype=qq&returnUrl="+encodeURI(a)}).on("click","#sinaLogin",function(t){t.preventDefault();var a=window.location.href;window.location.href="http://192.168.0.100:9009/apis/oauth/authorizelogin?authorizetype=sina&returnUrl="+encodeURI(a)})},t.fn.insertYmwLoginPop=function(){t(".gsZpPopLoginClose").show(),t(".gs_zp_pop_login").show(),t(".gsZpPopLoginClose").on("click",function(){t(".gs_zp_pop_login").hide(),t(".gsZpPopLoginClose").hide()})},t.fn.removeTarget=function(){return this.each(function(){t(this).find("a").attr("target","_self")})}}(jQuery);
//# sourceMappingURL=main.min.js.map
