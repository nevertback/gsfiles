$(function(){var e=function(e,i){i||(i=window.location.href);var o=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(i);return o?o[1]:0},i=window.location.pathname.split("/")[2];$.fn.extend({loginiframeForm:function(i){var o=$(this);e("server_id")||"";o.on("keyup",".ui-passport-password",function(e){13==e.keyCode&&o.find(".ui-passport-login-button").click()}).on("click",".iframeLogin",function(e){e.preventDefault();var i=o.find(".ui-passport-userName"),a=o.find(".ui-passport-password"),t=o.find("#persistentcookie").attr("checked")?"Year":"None";return""==i.val()?(alert("请填写用户名！"),void i.focus()):""==a.val()?(alert("请填写密码！"),void a.focus()):void $.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/userlogin",data:{logindata:JSON2.stringify({username:i.val(),password:a.val(),checkcode:"",expiration:t})},success:function(e){switch(e.status){case"ok":window.location.reload();break;case"err":alert(e.body)}}})})},loginUser:function(o){var a=$(this);$.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/logincheck",success:function(o){"ok"==o.status?(a.find(".regeidt").hide(),a.find(".login,.Logout").show(),a.find("#Uname").html(o.username),a.show(),a.find(".uname").find("img").attr("src",o.userface).after(o.username),a.find(".user1 .img img").attr("src",o.userface),a.find(".user1 .name").html(o.username),0==e("server_id")?$(".Recharge").attr("href","http://pay.gamersky.com/pay/?gameid="+i+"&uid="+o.userid):0==e("pay_server_id")?$(".Recharge").attr("href","http://pay.gamersky.com/pay/?gameid="+i+"&uid="+o.userid+"&serverid="+e("server_id")):$(".Recharge").attr("href","http://pay.gamersky.com/pay/?gameid="+i+"&uid="+o.userid+"&serverid="+e("pay_server_id"))):(a.find(".regeidt").show(),a.find(".login,.Logout").hide(),$(".Recharge").click(function(e){e.preventDefault(),alert("请先登录，再来充值！")})),$(window).resize(function(){var e=$(window).width(),i=$(".Top_L").outerWidth(!0)+$(".Top_R").outerWidth(!0)+10;e-i<800&&$(".Notice").width(e-i).find(".gonggao").width(e-i-80)}).trigger("resize")}}),$("#Logout,.Logout").click(function(e){e.preventDefault(),$.ajax({type:"GET",url:"//i.gamersky.com/api/userlogout",dataType:"jsonp",success:function(e){window.location.reload()}})}),$(".regeidt").keyup(function(e){13==e.keyCode&&$("#BtnLogin").click()}),a.on("click","#BtnLogin",function(e){e.preventDefault();var i=a.find(".ui-passport-userName"),o=a.find(".ui-passport-password"),t="None";return""==i.val()?(alert("请填写用户名！"),void i.focus()):""==o.val()?(alert("请填写密码！"),void o.focus()):void $.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/userlogin",data:{logindata:JSON2.stringify({username:i.val(),password:o.val(),checkcode:"",expiration:t})},success:function(e){switch(e.status){case"ok":window.location.reload();break;case"err":alert(e.body)}}})})},GameLink:function(i){var o=$(".gamesIframe").data("game"),a=0==e("server_id")?1:e("server_id");$.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/LoginGeneralGamer",data:{logindata:JSON2.stringify({serverid:a,configType:o})},success:function(e){"ok"==e.status?($(".gamesLogin").remove(),$(".gamesIframe").attr("src",e.url).show(),$("#GameID").html("玩家ID:"+e.userid),$("html").addClass("yyzq-logined"),$(".gameAreaInfos").removeClass("gameAreaInfosHide")):$(".gamesLogin").show()}})}}),$(".User-login").loginiframeForm(),$(".Login").loginUser(),$(".gamesLogin").GameLink(),$(document).on("click","#qqLogin",function(e){e.preventDefault(),window.location.href="//i.gamersky.com/oauth/authorizelogin?authorizetype=qq&returnUrl="+encodeURI(window.location.href)}).on("click","#sinaLogin",function(e){e.preventDefault(),window.location.href="//i.gamersky.com/oauth/authorizelogin?authorizetype=sina&returnUrl="+encodeURI(window.location.href)}).on("click","#weixinLogin",function(e){e.preventDefault(),window.location.href="//i.gamersky.com/oauth/authorizelogin?authorizetype=weixin&returnUrl="+encodeURI(window.location.href)})}),function(e){var i=e(".gamesIframe"),o=i.data("game"),a={setBodySize:function(){var i=e(window).height()-36;i<800?e("body").css({"overflow-y":"auto",height:"800px"}):e("body").css({"overflow-y":"",height:""})},setGameSize:function(){var i=e(".gameArea"),o=e(window).height()-36,a=e(window).width(),t=e(".gamesIframe"),n=i.data("screen");i.css({height:o,width:"100%"}),a<1280?(e(".gameAreaInfos").removeClass("cur"),e("html").css("overflow-x","auto")):(e(".gameAreaInfos").addClass("cur"),e("html").css("overflow-x","")),o=e(window).height()-36,i.css({top:"",height:o}),t.css({width:o/5*3+"px",height:o+"px"}),1===parseInt(n)&&(e(".gameAreaInfos").removeClass("cur"),e("html").css("overflow-x",""),a<1280?(i.css("top","0"),e("#QZnav").hide(),o=e(window).height()):(i.css("top",""),e("#QZnav").show(),o=e(window).height()-36),i.css("width",a+"px"),t.css({width:a+"px",height:o+"px"}))},checklogin:function(){e.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/logincheck",success:function(t){"ok"===t.status?(e(".QZlogin").removeClass("show"),i.attr("src",o).show(),e(".Bot").hide(),a.setGameSize(),e(window).resize(function(){a.setGameSize()})):(e(".QZlogin").addClass("show"),a.setBodySize(),e(window).resize(function(){a.setBodySize()}))}})},init:function(){this.checklogin()}};a.init()}(jQuery),function(e){var i=e(".gamesIframe"),o=i.data("game"),a={checklogin:function(){e.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/logincheck",success:function(a){"ok"===a.status?i.attr("src",o).show():(e(".gsZpPopLoginClose").show(),e(".gs_zp_pop_login").show())}})},init:function(){this.checklogin()}};a.init()}(jQuery);
//# sourceMappingURL=main.min.js.map
