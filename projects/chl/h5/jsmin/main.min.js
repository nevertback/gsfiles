!function(i){var n={WxCode:"//image.gamersky.com/webimg13/wap/h5/gamecenter.svg"},a={isInIframe:function(){return window.top!==window.self},createLast:function(n){var a="",o=i("#h5GameLast");a+='<h4 class="h5-title-lev1"><i></i>最近玩过</h4>',a+='<ul class="clearfix h5-game-last">',i.each(n,function(i,n){i<4&&(a+="<li>",a+='<a target="_blank" href="//h5.gamersky.com/game/'+n.file+'/">',a+='<img src="//image.gamersky.com/webimg13/web/h5/icon/'+n.file+'.jpg" alt="'+n.name+'">',a+="<span>"+n.name+"</span>",a+="</a>",a+="</li>")}),a+="</ul>",o.html(a).addClass("cur")},addLast:function(i){var n,a=window.localStorage,o=a.getItem("h5last"+i.userid);null!==o&&(n=JSON.parse(a.getItem("h5last"+i.userid)),this.createLast(n))},login:function(){var n=i(".h5HeadLogin"),a="";a+='<a class="h5-btn h5-btn-login h5Login">登录</a>',a+='<a target="_blank" class="h5-btn h5-btn-register" href="http://i.gamersky.com/user/register/">注册</a>',n.html(a),i(document).on("click",".h5Login",function(){i(".gsZpPopLoginClose").show(),i(".gs_zp_pop_login").show(),i(".gsZpPopLoginClose").on("click",function(){i(".gs_zp_pop_login").hide(),i(".gsZpPopLoginClose").hide()})})},postMsg:function(i){this.isInIframe()&&window.parent.postMessage(JSON.stringify({cmd:i}),"*")},isLogin:function(n){function a(n,a){var o=i(".h5PersonalTop"),s="";"Anonymous"===n&&(n="//image.gamersky.com/webimg15/comment/anonymous.jpg",a="未登录"),s+='<img class="h5-personal-top-face h5Login" src="'+n+'" alt="backName">',s+='<div class="h5-personal-top-name h5Login">'+a+"</div>",o.html(s)}function o(){i(".h5LoginOut").on("click",function(){i.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/userlogout",success:function(i){"ok"===i.status&&(e.postMsg("loginOut"),window.location.reload())}})})}function s(s){var t=s.username,c=s.userface.replace(/http:\/\//g,"//"),l=i(".h5HeadLogin"),h="";h+='<img class="h5-head-face" src="'+c+'" alt="backName">',h+='<div class="h5-head-name">'+t+"</div>",h+='<a class="h5-btn h5-btn-login-out h5LoginOut">退出</a>',l.html(h),"personal"===n&&(a(c,t),i("body").append('<div class="h5-personal-login h5LoginOut">退出登录</div>')),o(),window.localStorage&&e.addLast(s),e.postMsg("loginIn")}function t(o){"personal"===n&&(a("Anonymous"),i("body").append('<a class="h5-personal-login h5Login">登录</a>')),e.login()}var e=this;i.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/logincheck",success:function(i){"ok"===i.status?s(i):t(i)}})},swp:function(){var n=i(".h5Swp"),a=n.find(".swiper-pagination");new Swiper(n,{loop:!0,pagination:a,autoplay:3e3,autoplayDisableOnInteraction:!1})},announce:function(){var n=i(".h5Announce");new Swiper(n,{direction:"vertical",loop:!0,autoplay:2e3,autoplayDisableOnInteraction:!1})},giftsFnc:function(){function a(a){var o="";o+='<div class="h5-gifts-pop-mask h5GiftPop h5GiftPopClose"></div>',o+='<div class="h5-gifts-pop h5GiftPop">',o+="<h5>礼包领取说明</h5>",o+='<img class="h5-gifts-pop-svg" src="'+n.WxCode+'">',o+="<p>长按二维码或者搜索“游民星空游戏中心”<br>关注公众号在对话框中输入对应密令即可领取游戏礼包</p>",o+="<span>密令："+a+"</span>",o+='<a class="h5-gifts-pop-close h5GiftPopClose"></a>',o+="</div>",i("body").append(o),i(".h5GiftPopClose").on("click",function(){i(".h5GiftPop").remove()})}var o=window.h5GiftData,s=i("#h5GiftBox"),t="";i.each(o,function(n,a){t+='<div class="h5-gift-item">',t+='<div class="h5gi-top">',t+='<img src="'+a.icon+'">',t+="<h4>"+a.title+"</h4>",t+="</div>",t+='<div class="h5gi-gifts h5giGifts">',i.each(a.gifts,function(i,n){t+='<div class="h5gi-li">',t+='<h5><i class="gs-h5-icon gs-h5-icon-libao"></i>'+n.name+"</h5>",t+='<div class="h5gi-des">'+n.des+"</div>",t+='<a class="h5gi-psw h5giPsw" data-psw="'+n.psw+'">领取</a>',t+="</div>"}),a.gifts.length>1&&(t+='<a class="h5gi-more h5GiftMore"><span class="h5gi-more-down">查看</span><span class="h5gi-more-up">收起</span>更多礼包（共'+a.gifts.length+"个）<i></i></a>"),t+="</div>",t+="</div>"}),s.html(t),s.find(".h5GiftMore").on("click",function(){var n=i(this),a=n.closest(".h5giGifts"),o=n.attr("data-clked");"clicked"===o?(n.attr("data-clked","no"),a.removeClass("cur")):(n.attr("data-clked","clicked"),a.addClass("cur"))}),i(".h5giPsw").on("click",function(){var n=i(this),o=n.data("psw");a(o)})},personalFnc:function(){function n(){e.html("联系客服");var n="";return n+=i(".h5pPopDataService").html()}function a(){e.html("新闻资讯");var n="";return n+="",n+=i(".h5pPopDataNews").html()}function o(i){var o;o="service"===i?n():a(),c.html(o)}var s=i(".h5pPopBtn"),t=i(".h5pPop"),e=t.find(".h5pHead"),c=t.find(".h5pContext");s.on("click",function(){var n=i(this).data("sel");t.addClass("cur"),i("html").css("overflow","hidden"),o(n)}),t.on("click",".h5pPopClose",function(){t.removeClass("cur"),i("html").css("overflow","")})},init:function(){var n=this,a=i(".h5Main"),o=a.data("pos");i(".h5Nav-"+o).addClass("cur"),n.isLogin(o),"index"===o?(n.swp(),n.announce()):"gift"===o?n.giftsFnc():"personal"===o&&n.personalFnc()}};a.init()}(jQuery),function(){var i="index.html",n={isLogin:function(){function i(){var i=$(".h5PcHead");i.append('<img class="h5-pc-head-notice" src="ztimages/pc-wx.png" alt="notice">')}$.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/logincheck",success:function(n){"ok"!==n.status&&i()}})},msg:function(){window.addEventListener&&window.addEventListener("message",function(i){if(i&&i.data)try{var n=JSON.parse(i.data);switch(n.cmd){case"loginIn":setTimeout(function(){"undefined"==typeof $.cookie("UserCookie")&&window.location.reload()},200);break;case"loginOut":window.location.reload()}}catch(a){SQ.log("浏览器不支持postMessage"+i.data)}})},setTop:function(){function n(){var i,n,o,s,t=$(window),e=(t.width(),t.height());s=.874074,n=e*s,i=n/944*496,o=.07962962*e,a.css({top:o,marginLeft:-i/2+"px",width:i,height:n})}var a=$(".h5View"),o=(a.find(".h5ViewIframe"),$("#mainWapIframe"));n(),$(window).resize(function(){n()}),setTimeout(function(){o.attr("src",i)},500)},init:function(){this.setTop(),this.msg(),this.isLogin()}};n.init()}();
//# sourceMappingURL=main.min.js.map
