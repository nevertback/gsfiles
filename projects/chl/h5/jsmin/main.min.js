!function(i){var a={WxCode:"//image.gamersky.com/webimg13/wap/h5/gamecenter.svg"},n={isInIframe:function(){return window.top!==window.self},createLast:function(a){var n="",o=i("#h5GameLast");n+='<h4 class="h5-title-lev1"><i></i>最近玩过</h4>',n+='<ul class="clearfix h5-game-last">',i.each(a,function(i,a){i<4&&(n+="<li>",n+='<a target="_blank" href="//h5.gamersky.com/game/'+a.file+'/">',n+='<img src="//image.gamersky.com/webimg13/web/h5/icon/'+a.file+'.jpg" alt="'+a.name+'">',n+="<span>"+a.name+"</span>",n+="</a>",n+="</li>")}),n+="</ul>",o.html(n).addClass("cur")},addLast:function(i){var a,n=window.localStorage,o=n.getItem("h5last"+i.userid);null!==o&&(a=JSON.parse(n.getItem("h5last"+i.userid)),this.createLast(a))},login:function(){var a=i(".h5HeadLogin"),n="";n+='<a class="h5-btn h5-btn-login h5Login">登录</a>',n+='<a target="_blank" class="h5-btn h5-btn-register" href="http://i.gamersky.com/user/register/">注册</a>',a.html(n),i(document).on("click",".h5Login",function(){i(".gsZpPopLoginClose").show(),i(".gs_zp_pop_login").show(),i(".gsZpPopLoginClose").on("click",function(){i(".gs_zp_pop_login").hide(),i(".gsZpPopLoginClose").hide()})})},postMsg:function(i){this.isInIframe()&&window.parent.postMessage(JSON.stringify({cmd:i}),"*")},isLogin:function(a){function n(a,n){var o=i(".h5PersonalTop"),s="";"Anonymous"===a&&(a="//image.gamersky.com/webimg15/comment/anonymous.jpg",n="未登录"),s+='<img class="h5-personal-top-face h5Login" src="'+a+'" alt="backName">',s+='<div class="h5-personal-top-name h5Login">'+n+"</div>",o.html(s)}function o(){i(".h5LoginOut").on("click",function(){i.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/userlogout",success:function(i){"ok"===i.status&&(e.postMsg("loginOut"),window.location.reload())}})})}function s(s){var t=s.username,c=s.userface.replace(/http:\/\//g,"//"),l=i(".h5HeadLogin"),h="";h+='<img class="h5-head-face" src="'+c+'" alt="backName">',h+='<div class="h5-head-name">'+t+"</div>",h+='<a class="h5-btn h5-btn-login-out h5LoginOut">退出</a>',l.html(h),"personal"===a&&(n(c,t),i("body").append('<div class="h5-personal-login h5LoginOut">退出登录</div>')),o(),window.localStorage&&e.addLast(s),e.postMsg("loginIn")}function t(o){"personal"===a&&(n("Anonymous"),i("body").append('<a class="h5-personal-login h5Login">登录</a>')),e.login()}var e=this;i.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/logincheck",success:function(i){"ok"===i.status?s(i):t(i)}})},swp:function(){var a=i(".h5Swp"),n=a.find(".swiper-pagination");new Swiper(a,{loop:!0,pagination:n,autoplay:3e3,autoplayDisableOnInteraction:!1})},announce:function(){var a=i(".h5Announce");new Swiper(a,{direction:"vertical",loop:!0,autoplay:2e3,autoplayDisableOnInteraction:!1})},giftsFnc:function(){function n(n){var o="";o+='<div class="h5-gifts-pop-mask h5GiftPop h5GiftPopClose"></div>',o+='<div class="h5-gifts-pop h5GiftPop">',o+="<h5>礼包领取说明</h5>",o+='<img class="h5-gifts-pop-svg" src="'+a.WxCode+'">',o+="<p>长按二维码或者搜索“游民星空游戏中心”<br>关注公众号在对话框中输入对应密令即可领取游戏礼包</p>",o+="<span>密令："+n+"</span>",o+='<a class="h5-gifts-pop-close h5GiftPopClose"></a>',o+="</div>",i("body").append(o),i(".h5GiftPopClose").on("click",function(){i(".h5GiftPop").remove()})}var o=window.h5GiftData,s=i("#h5GiftBox"),t="";i.each(o,function(a,n){t+='<div class="h5-gift-item">',t+='<div class="h5gi-top">',t+='<img src="'+n.icon+'">',t+="<h4>"+n.title+"</h4>",t+="</div>",t+='<div class="h5gi-gifts h5giGifts">',i.each(n.gifts,function(i,a){t+='<div class="h5gi-li">',t+='<h5><i class="gs-h5-icon gs-h5-icon-libao"></i>'+a.name+"</h5>",t+='<div class="h5gi-des">'+a.des+"</div>",t+='<a class="h5gi-psw h5giPsw" data-psw="'+a.psw+'">领取</a>',t+="</div>"}),n.gifts.length>1&&(t+='<a class="h5gi-more h5GiftMore"><span class="h5gi-more-down">查看</span><span class="h5gi-more-up">收起</span>更多礼包（共'+n.gifts.length+"个）<i></i></a>"),t+="</div>",t+="</div>"}),s.html(t),s.find(".h5GiftMore").on("click",function(){var a=i(this),n=a.closest(".h5giGifts"),o=a.attr("data-clked");"clicked"===o?(a.attr("data-clked","no"),n.removeClass("cur")):(a.attr("data-clked","clicked"),n.addClass("cur"))}),i(".h5giPsw").on("click",function(){var a=i(this),o=a.data("psw");n(o)})},personalFnc:function(){function a(){e.html("联系客服");var a="";return a+=i(".h5pPopDataService").html()}function n(){e.html("新闻资讯");var a="";return a+="",a+=i(".h5pPopDataNews").html()}function o(i){var o;o="service"===i?a():n(),c.html(o)}var s=i(".h5pPopBtn"),t=i(".h5pPop"),e=t.find(".h5pHead"),c=t.find(".h5pContext");s.on("click",function(){var a=i(this).data("sel");t.addClass("cur"),i("html").css("overflow","hidden"),o(a)}),t.on("click",".h5pPopClose",function(){t.removeClass("cur"),i("html").css("overflow","")})},init:function(){var a=this,n=i(".h5Main"),o=n.data("pos");i(".h5Nav-"+o).addClass("cur"),a.isLogin(o),"index"===o?(a.swp(),a.announce()):"gift"===o?a.giftsFnc():"personal"===o&&a.personalFnc()}};n.init()}(jQuery),function(){var i="//h5.gamersky.com",a={isLogin:function(){function i(){var i=$(".h5PcHead");i.append('<img class="h5-pc-head-notice" src="//image.gamersky.com/webimg15/web/h5/pc-wx.png" alt="notice">')}$.ajax({type:"GET",dataType:"jsonp",url:"//i.gamersky.com/api/logincheck",success:function(a){"ok"!==a.status&&i()}})},msg:function(){window.addEventListener&&window.addEventListener("message",function(i){if(i&&i.data)try{var a=JSON.parse(i.data);switch(a.cmd){case"loginIn":setTimeout(function(){"undefined"==typeof $.cookie("UserCookie")&&window.location.reload()},200);break;case"loginOut":window.location.reload()}}catch(n){SQ.log("浏览器不支持postMessage"+i.data)}})},setTop:function(){function a(){var i,a,o,s,t=$(window),e=(t.width(),t.height());s=.874074,a=e*s,i=a/944*496,o=.07962962*e,n.css({top:o,marginLeft:-i/2+"px",width:i,height:a})}var n=$(".h5View"),o=(n.find(".h5ViewIframe"),$("#mainWapIframe"));a(),$(window).resize(function(){a()}),setTimeout(function(){o.attr("src",i)},500)},init:function(){this.setTop(),this.msg()}};a.init()}();
//# sourceMappingURL=main.min.js.map
