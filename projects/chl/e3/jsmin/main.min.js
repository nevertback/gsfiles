!function(a){var i={getQueryString:function(a){var i=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(i);return null!=e?unescape(e[2]):null},swpTop:function(){new Swiper(".gsE3SwpTop",{slidesPerView:"auto",centeredSlides:!0,loop:!0})},swpList:function(){a(".gsE3SwpList").each(function(){var i=a(this);new Swiper(i,{slidesPerView:"auto"})})},getWant:function(){var i=a(".gsE3game"),e=[];i.each(function(){var i=a(this).data("lib");e.push(i)}),a.ajax({type:"GET",dataType:"jsonp",url:"//cm1.gamersky.com/apirating/getwanrating",data:{Idlist:e+""},success:function(i){if("ok"===i.status){var e=i.result;a.each(e,function(i,e){a(".gsE3game[data-lib="+e.gameId+"]").find(".want i").html(e.wantplayCount)})}}})},BriefingInit:function(){function i(){a(".logoNavs[data-pgkey="+o+"]").addClass("cur")}function e(){var i=a(".gsE3Tab"),e=i.find(".gsE3TabNav"),t=i.find(".gsE3TabItem");e.find("a").on("click",function(){var i=a(this),s=i.index();e.find("a").removeClass("cur").eq(s).addClass("cur"),t.removeClass("cur").eq(s).addClass("cur")})}function t(){function i(){function i(a){var i="";return i+='<div class="ls-top-state"><span>'+s.state+"</span></div>",i+='<div class="ls-top-infos">',i+="<h5>"+s.title+"</h5>",i+="<p><span>"+s.location+"</span><span>"+s.time+'</span><span>评论：<i class="LsComment" data-commid="'+s.commentid+'">'+a+"</i></span></p>"}var e,t=u.find(".liveStreamTop"),s=f;e=i("--"),t.html(e),a.ajax({type:"GET",url:"//cm.gamersky.com/commentapi/count",dataType:"jsonp",data:{topic_source_id:s.commentid},success:function(i){a(".LsComment").html(i.result[s.commentid].comments)}})}function e(i,e,t,s){var n={action:"getlivedatabypage",generalId:f.commentid,page:e,size:i,orderSort:t};a.ajax({type:"GET",url:"//db5.gamersky.com/GraphicLiveAjax.aspx",dataType:"jsonp",data:{jsondata:JSON2.stringify(n)},success:function(a){"ok"===a.status&&"function"==typeof s&&s(a)}})}function t(i){var e="";if(e+="",e+='<div class="live-stream-list-item">',e+='<div class="lsli-time"><i></i>'+i.inputtime+"</div>",e+='<div class="lsli-des">'+i.describe+"</div>",i.list.length>0){var t=i.uploadList+"";t=t.replace(/http:\/\//g,"//"),e+='<div class="liveStreamPicList lsli-pics lsli-pics-num'+i.list.length+'" data-piclist="'+t+'"><ul class="clearfix">',a.each(i.uploadList,function(a,i){i=i.replace("http://","//"),e+='<li><a class="liveStreamPic" data-idx="'+a+'"><img src="'+i+'_550.jpg" alt="LivePics"></a></li>'}),e+="</ul></div>"}return e+="</div>"}function s(i){var e="";return e+="",e+='<div class="live-stream-list-items gsE3LslItems">',a.each(i,function(a,i){e+=t(i)}),e+="</div>",e+='<a class="live-stream-list-more gsE3LslMore">查看更多内容</a>'}function n(i){var e="";return e+="",a.each(i,function(a,i){e+=t(i)}),e}function l(){a(".gsE3LslMore").on("click",function(){var i=a(this);S===!1&&(S=!0,h++,i.html("正在加载..."),e(y,h,w,function(a){v.find(".gsE3LslItems").append(n(a.result)),h*y>=g?i.html("全部加载完成"):(S=!1,i.html("查看更多内容"))}))})}function d(){e(y,h,w,function(a){g=a.total,a.result.length<1?v.html('<div style="height: 1rem;line-height: 1rem;font-size: 0.24rem;color:#888;text-align: center;border-bottom: 1px solid #f5f5f5;">直播尚未开始</div>'):(v.html(s(a.result)),l())})}function r(){a(".liveStreamSort").on("click",function(){var i=a(this);i.hasClass("desc")===!0?(i.removeClass("desc").addClass("asc").find("i").html("正序"),h=1,w="asc"):(i.removeClass("asc").addClass("desc").find("i").html("倒序"),h=1,w="desc"),d()})}function p(){function i(i,e){var t="";t+="",t+='<div class="gs-e3-pop-mask gepPop gepPopClose"></div>',t+='<div class="gs-e3-pop-main gepPop gepPopClose">',e.length>1?(t+='<div class="gs-e3-pop-pics">',t+='<div class="swiper-container gepPopSwp"><div class="swiper-wrapper">',a.each(e,function(a,i){t+='<div class="swiper-slide">',t+='<img src="'+i+'_550.jpg" alt="LivePicPop">',t+="</div>"}),t+="</div></div>",t+="</div>"):(t+='<div class="gs-e3-pop-pic">',t+='<img src="'+e[0]+'_550.jpg" alt="LivePicPop">',t+="</div>"),t+='<div class="gs-e3-pop-bar">',t+='<a class="gs-e3-pop-back gepPopClose"></a>',t+='<a class="gs-e3-pop-look gepPopLook" target="_blank" href="//www.gamersky.com/showimage/id_gamersky.shtml?'+e[i]+'_1920.jpg"></a>',e.length>1&&(t+='<div class="swiper-pagination-custom"></div>'),t+="</div>",t+="</div>",a("body").append(t);var s=a(".gepPop");setTimeout(function(){s.addClass("cur")},50);new Swiper(".gepPopSwp",{initialSlide:i,pagination:".swiper-pagination-custom",paginationType:"fraction",onSlideChangeEnd:function(a){s.find(".gepPopLook").attr("href","//www.gamersky.com/showimage/id_gamersky.shtml?"+e[a.activeIndex]+"_1920.jpg")}});a(".gepPopClose").on("click",function(){s.removeClass("cur"),setTimeout(function(){s.remove()},250)}),s.find("a").on("click",function(a){a.stopPropagation()})}v.on("click",".liveStreamPic",function(){var e,t=a(this),s=t.closest(".liveStreamPicList"),n=s.data("piclist"),o=t.data("idx");e=n.split(","),i(o,e)})}function m(){var i=u.find(".liveStreamComment"),e="";e+='<div id="SOHUCS" sid="'+f.commentid+'"></div>',i.html(e),a.getScript("//j.gamersky.com/web2015/comment/wapjs/jquery.commentconfig.js?"+(new Date).getTime())}var g,u=a("#liveStream"),f=c[o],v=u.find(".liveStreamList"),h=1,y=10,w="desc",S=!1;d(),i(),r(),p(),m()}function s(){function i(i){var t={type:"getwapspecialpage",isCache:!0,cacheTime:60,specialId:3811,isSpecialId:!0,templatekey:l.tmk,page:i};a.ajax({type:"GET",dataType:"jsonp",url:"//db2.gamersky.com/LabelJsonpAjax.aspx",data:{jsondata:JSON2.stringify(t)},beforeSend:function(){n.addClass("loading").html("加载中")},success:function(i){if(i.status="ok"){r=!1,e=i.totalPages;var t=i.body;i.body.indexOf("没有任何记录")>0&&1===d?(t='<li style="text-align: center;line-height: 1.4rem;font-size: 0.24rem;color:#888;">没有任何记录</li>',s.append(t),n.hide()):(s.append(t),n.removeClass("loading").html("查看更多资讯"),a(".cy_comment").cycm(),d===e&&n.addClass("loaded").html("全部加载完成"))}}})}var e,t=a(".gsE3NewsArea"),s=a(".gsE3News"),n=t.find(".gsE3MoreBrief"),l=c[o],d=1,r=!1;n.on("click",function(){r===!1&&(r=!0,d++,d<=e&&i(d))}),i(d)}var n=this,o=n.getQueryString("bf");null===o&&(o="ea");var c=window.LiveStreamData;i(),e(),t(),s()},getMoreList:function(){function i(){var i=parseInt(s.attr("data-page"))+1,r={type:"getwapspecialpage",isCache:!0,cacheTime:60,specialId:o,isSpecialId:c,templatekey:l,page:i};a.ajax({type:"GET",dataType:"jsonp",url:"//db2.gamersky.com/LabelJsonpAjax.aspx",data:{jsondata:JSON2.stringify(r)},beforeSend:function(){t.addClass("loading").html("加载中")},success:function(o){if(o.status="ok"){e=o.totalPages;var c=o.body;n.append(c),t.removeClass("loading").html("查看更多资讯"),a(".cy_comment").cycm(),s.attr("data-page",i),i===e?t.addClass("loaded").html("全部加载完成"):d=!1}}})}var e,t=a(".gsE3More"),s=t.closest(".gsE3MoreArea"),n=s.find(".gsE3MoreList"),o=s.data("specialid"),c=s.data("isspecialid"),l=s.data("templatekey"),d=!1;t.on("click",function(){d===!1&&(d=!0,i())})},pagePosition:function(){var i=this,e=a(".gsE3Page"),t=e.data("pos"),s=e.find(".gsE3Nav");s.find(".gsE3Nav"+t).addClass("cur"),"Index"===t?(i.swpTop(),i.swpList(),i.getWant(),i.getMoreList()):"Live"===t?i.getMoreList():"Briefing"===t&&i.BriefingInit()},init:function(){this.pagePosition()}};i.init()}(jQuery);
//# sourceMappingURL=main.min.js.map
