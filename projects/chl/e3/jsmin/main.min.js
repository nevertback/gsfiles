!function(a){var e={getQueryString:function(a){var e=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null},swpTop:function(){new Swiper(".gsE3SwpTop",{slidesPerView:"auto",centeredSlides:!0,loop:!0})},swpList:function(){a(".gsE3SwpList").each(function(){var e=a(this);new Swiper(e,{slidesPerView:"auto"})})},getWant:function(){var e=a(".gsE3game"),i=[];e.each(function(){var e=a(this).data("lib");i.push(e)}),a.ajax({type:"GET",dataType:"jsonp",url:"//cm1.gamersky.com/apirating/getwanrating",data:{Idlist:i+""},success:function(e){if("ok"===e.status){var i=e.result;a.each(i,function(e,i){a(".gsE3game[data-lib="+i.gameId+"]").find(".want i").html(i.wantplayCount)})}}})},BriefingInit:function(){function e(){a(".logoNavs[data-pgkey="+o+"]").addClass("cur")}function i(){var e=a(".gsE3Tab"),i=e.find(".gsE3TabNav"),t=e.find(".gsE3TabItem");i.find("a").on("click",function(){var e=a(this),s=e.index();i.find("a").removeClass("cur").eq(s).addClass("cur"),t.removeClass("cur").eq(s).addClass("cur")})}function t(){function e(){function e(a){var e="";return e+='<div class="ls-top-state"><span>'+s.state+"</span></div>",e+='<div class="ls-top-infos">',e+="<h5>"+s.title+"</h5>",e+="<p><span>"+s.location+"</span><span>"+s.time+'</span><span>评论：<i class="LsComment" data-commid="'+s.commentid+'">'+a+"</i></span></p>"}var i,t=u.find(".liveStreamTop"),s=f;i=e("--"),t.html(i),a.ajax({type:"GET",url:"//cm.gamersky.com/commentapi/count",dataType:"jsonp",data:{topic_source_id:s.commentid},success:function(e){a(".LsComment").html(e.result[s.commentid].comments)}})}function i(e,i,t,s){var n={action:"getlivedatabypage",generalId:f.commentid,page:i,size:e,orderSort:t};a.ajax({type:"GET",url:"//db5.gamersky.com/GraphicLiveAjax.aspx",dataType:"jsonp",data:{jsondata:JSON2.stringify(n)},success:function(a){"ok"===a.status&&"function"==typeof s&&s(a)}})}function t(e){var i="";if(i+="",i+='<div class="live-stream-list-item">',i+='<div class="lsli-time"><i></i>'+e.inputtime+"</div>",i+='<div class="lsli-des">'+e.describe+"</div>",e.list.length>0){var t=e.uploadList+"";t=t.replace(/http:\/\//g,"//"),i+='<div class="liveStreamPicList lsli-pics lsli-pics-num'+e.list.length+'" data-piclist="'+t+'"><ul class="clearfix">',a.each(e.uploadList,function(a,e){e=e.replace("http://","//"),i+='<li><a class="liveStreamPic" data-idx="'+a+'"><img src="'+e+'_550.jpg" alt="LivePics"></a></li>'}),i+="</ul></div>"}return i+="</div>"}function s(e){var i="";return i+="",i+='<div class="live-stream-list-items gsE3LslItems">',a.each(e,function(a,e){i+=t(e)}),i+="</div>",i+='<a class="live-stream-list-more gsE3LslMore">查看更多内容</a>'}function n(e){var i="";return i+="",a.each(e,function(a,e){i+=t(e)}),i}function c(){a(".gsE3LslMore").on("click",function(){var e=a(this);S===!1&&(S=!0,h++,e.html("正在加载..."),i(y,h,w,function(a){v.find(".gsE3LslItems").append(n(a.result)),h*y>=g?e.html("全部加载完成"):(S=!1,e.html("查看更多内容"))}))})}function d(){i(y,h,w,function(a){g=a.total,a.result.length<1?v.html('<div style="height: 1rem;line-height: 1rem;font-size: 0.24rem;color:#888;text-align: center;border-bottom: 1px solid #f5f5f5;">直播尚未开始</div>'):(v.html(s(a.result)),c())})}function r(){a(".liveStreamSort").on("click",function(){var e=a(this);e.hasClass("desc")===!0?(e.removeClass("desc").addClass("asc").find("i").html("正序"),h=1,w="asc"):(e.removeClass("asc").addClass("desc").find("i").html("倒序"),h=1,w="desc"),d()})}function p(){function e(e,i){var t="";t+="",t+='<div class="gs-e3-pop-mask gepPop gepPopClose"></div>',t+='<div class="gs-e3-pop-main gepPop gepPopClose">',i.length>1?(t+='<div class="gs-e3-pop-pics">',t+='<div class="swiper-container gepPopSwp"><div class="swiper-wrapper">',a.each(i,function(a,e){t+='<div class="swiper-slide">',t+='<img src="'+e+'_550.jpg" alt="LivePicPop">',t+="</div>"}),t+="</div></div>",t+="</div>"):(t+='<div class="gs-e3-pop-pic">',t+='<img src="'+i[0]+'_550.jpg" alt="LivePicPop">',t+="</div>"),t+='<div class="gs-e3-pop-bar">',t+='<a class="gs-e3-pop-back gepPopClose"></a>',t+='<a class="gs-e3-pop-look gepPopLook" target="_blank" href="//www.gamersky.com/showimage/id_gamersky.shtml?'+i[e]+'_1920.jpg"></a>',i.length>1&&(t+='<div class="swiper-pagination-custom"></div>'),t+="</div>",t+="</div>",a("body").append(t);var s=a(".gepPop");setTimeout(function(){s.addClass("cur")},50);new Swiper(".gepPopSwp",{initialSlide:e,pagination:".swiper-pagination-custom",paginationType:"fraction",onSlideChangeEnd:function(a){s.find(".gepPopLook").attr("href","//www.gamersky.com/showimage/id_gamersky.shtml?"+i[a.activeIndex]+"_1920.jpg")}});a(".gepPopClose").on("click",function(){s.removeClass("cur"),setTimeout(function(){s.remove()},250)}),s.find("a").on("click",function(a){a.stopPropagation()})}v.on("click",".liveStreamPic",function(){var i,t=a(this),s=t.closest(".liveStreamPicList"),n=s.data("piclist"),o=t.data("idx");i=n.split(","),e(o,i)})}function m(){var e=u.find(".liveStreamComment"),i="";i+='<div id="SOHUCS" sid="'+f.commentid+'"></div>',e.html(i),a.getScript("//j.gamersky.com/web2015/comment/wapjs/jquery.commentconfig.js?"+(new Date).getTime())}var g,u=a("#liveStream"),f=l[o],v=u.find(".liveStreamList"),h=1,y=10,w="desc",S=!1;d(),e(),r(),p(),m()}function s(){function e(e){var t={type:"getwapspecialpage",isCache:!0,cacheTime:60,specialId:3811,isSpecialId:!0,templatekey:c.tmk,page:e};a.ajax({type:"GET",dataType:"jsonp",url:"//db2.gamersky.com/LabelJsonpAjax.aspx",data:{jsondata:JSON2.stringify(t)},beforeSend:function(){n.addClass("loading").html("加载中")},success:function(e){if(e.status="ok"){r=!1,i=e.totalPages;var t=e.body;e.body.indexOf("没有任何记录")>0&&1===d?(t='<li style="text-align: center;line-height: 1.4rem;font-size: 0.24rem;color:#888;">没有任何记录</li>',s.append(t),n.hide()):(s.append(t),n.removeClass("loading").html("查看更多资讯"),a(".cy_comment").cycm(),d===i&&n.addClass("loaded").html("全部加载完成"))}}})}var i,t=a(".gsE3NewsArea"),s=a(".gsE3News"),n=t.find(".gsE3MoreBrief"),c=l[o],d=1,r=!1;n.on("click",function(){r===!1&&(r=!0,d++,d<=i&&e(d))}),e(d)}var n=this,o=n.getQueryString("bf"),c=a(".gsE3LogoNav").data("now");null===o&&(o="undefined"!=typeof c&&""!==c?c:"ea");var l=window.LiveStreamData;e(),i(),t(),s()},getMoreList:function(){function e(){var e=parseInt(s.attr("data-page"))+1,r={type:"getwapspecialpage",isCache:!0,cacheTime:60,specialId:o,isSpecialId:c,templatekey:l,page:e};a.ajax({type:"GET",dataType:"jsonp",url:"//db2.gamersky.com/LabelJsonpAjax.aspx",data:{jsondata:JSON2.stringify(r)},beforeSend:function(){t.addClass("loading").html("加载中")},success:function(o){if(o.status="ok"){i=o.totalPages;var c=o.body;n.append(c),t.removeClass("loading").html("查看更多资讯"),a(".cy_comment").cycm(),s.attr("data-page",e),e===i?t.addClass("loaded").html("全部加载完成"):d=!1}}})}var i,t=a(".gsE3More"),s=t.closest(".gsE3MoreArea"),n=s.find(".gsE3MoreList"),o=s.data("specialid"),c=s.data("isspecialid"),l=s.data("templatekey"),d=!1;t.on("click",function(){d===!1&&(d=!0,e())})},pagePosition:function(){var e=this,i=a(".gsE3Page"),t=i.data("pos"),s=i.find(".gsE3Nav");s.find(".gsE3Nav"+t).addClass("cur"),"Index"===t?(e.swpTop(),e.swpList(),e.getWant(),e.getMoreList()):"Live"===t?e.getMoreList():"Briefing"===t&&e.BriefingInit()},init:function(){this.pagePosition()}};e.init()}(jQuery);
//# sourceMappingURL=main.min.js.map
