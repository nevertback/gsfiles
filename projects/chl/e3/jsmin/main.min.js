!function(a){var i={getQueryString:function(a){var i=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(i);return null!=e?unescape(e[2]):null},swpTop:function(){new Swiper(".gsE3SwpTop",{slidesPerView:"auto",centeredSlides:!0,loop:!0})},swpList:function(){a(".gsE3SwpList").each(function(){var i=a(this);new Swiper(i,{slidesPerView:"auto"})})},getWant:function(){var i=a(".gsE3game"),e=[];i.each(function(){var i=a(this).data("lib");e.push(i)}),a.ajax({type:"GET",dataType:"jsonp",url:"//cm1.gamersky.com/apirating/getwanrating",data:{Idlist:e+""},success:function(i){if("ok"===i.status){var e=i.result;a.each(e,function(i,e){a(".gsE3game[data-lib="+e.gameId+"]").find(".want i").html(e.wantplayCount)})}}})},BriefingInit:function(){function i(){a(".logoNavs[data-pgkey="+o+"]").addClass("cur")}function e(){var i=a(".gsE3Tab"),e=i.find(".gsE3TabNav"),s=i.find(".gsE3TabItem");e.find("a").on("click",function(){var i=a(this),t=i.index();e.find("a").removeClass("cur").eq(t).addClass("cur"),s.removeClass("cur").eq(t).addClass("cur")})}function s(){function i(){function i(a){var i="";return i+='<div class="ls-top-state"><span>'+t.state+"</span></div>",i+='<div class="ls-top-infos">',i+="<h5>"+t.title+"</h5>",i+="<p><span>"+t.location+"</span><span>"+t.time+'</span><span>评论：<i class="LsComment" data-commid="'+t.commentid+'">'+a+"</i></span></p>"}var e,s=u.find(".liveStreamTop"),t=v;e=i("--"),s.html(e),a.ajax({type:"GET",url:"//cm.gamersky.com/commentapi/count",dataType:"jsonp",data:{topic_source_id:t.commentid},success:function(i){a(".LsComment").html(i.result[t.commentid].comments)}})}function e(i,e,s,t){var n={action:"getlivedatabypage",generalId:v.commentid,page:e,size:i,orderSort:s};a.ajax({type:"GET",url:"//db5.gamersky.com/GraphicLiveAjax.aspx",dataType:"jsonp",data:{jsondata:JSON2.stringify(n)},success:function(a){"ok"===a.status&&"function"==typeof t&&t(a)}})}function s(i){var e="";if(e+="",e+='<div class="live-stream-list-item">',e+='<div class="lsli-time"><i></i>'+i.inputtime+"</div>",e+='<div class="lsli-des">'+i.describe+"</div>",i.list.length>0){var s=i.uploadList+"";s=s.replace(/http:\/\//g,"//"),e+='<div class="liveStreamPicList lsli-pics lsli-pics-num'+i.list.length+'" data-piclist="'+s+'"><ul class="clearfix">',a.each(i.uploadList,function(a,i){i=i.replace("http://","//"),e+='<li><a class="liveStreamPic" data-idx="'+a+'"><img src="'+i+'_550.jpg" alt="LivePics"></a></li>'}),e+="</ul></div>"}return e+="</div>"}function t(i){var e="";return e+="",e+='<div class="live-stream-list-items gsE3LslItems">',a.each(i,function(a,i){e+=s(i)}),e+="</div>",e+='<a class="live-stream-list-more gsE3LslMore">查看更多内容</a>'}function n(i){var e="";return e+="",a.each(i,function(a,i){e+=s(i)}),e}function l(){a(".gsE3LslMore").on("click",function(){var i=a(this);S===!1&&(S=!0,h++,i.html("正在加载..."),e(w,h,y,function(a){f.find(".gsE3LslItems").append(n(a.result)),h*w>=g?i.html("全部加载完成"):(S=!1,i.html("查看更多内容"))}))})}function p(){e(w,h,y,function(a){g=a.total,f.html(t(a.result)),l()})}function d(){a(".liveStreamSort").on("click",function(){var i=a(this);i.hasClass("desc")===!0?(i.removeClass("desc").addClass("asc").find("i").html("正序"),h=1,y="asc"):(i.removeClass("asc").addClass("desc").find("i").html("倒序"),h=1,y="desc"),p()})}function r(){function i(i,e){var s="";s+="",s+='<div class="gs-e3-pop-mask gepPop gepPopClose"></div>',s+='<div class="gs-e3-pop-main gepPop gepPopClose">',e.length>1?(s+='<div class="gs-e3-pop-pics">',s+='<div class="swiper-container gepPopSwp"><div class="swiper-wrapper">',a.each(e,function(a,i){s+='<div class="swiper-slide">',s+='<img src="'+i+'_550.jpg" alt="LivePicPop">',s+="</div>"}),s+="</div></div>",s+="</div>"):(s+='<div class="gs-e3-pop-pic">',s+='<img src="'+e[0]+'_550.jpg" alt="LivePicPop">',s+="</div>"),s+='<div class="gs-e3-pop-bar">',s+='<a class="gs-e3-pop-back gepPopClose"></a>',s+='<a class="gs-e3-pop-look gepPopLook" target="_blank" href="//www.gamersky.com/showimage/id_gamersky.shtml?'+e[i]+'_1920.jpg"></a>',e.length>1&&(s+='<div class="swiper-pagination-custom"></div>'),s+="</div>",s+="</div>",a("body").append(s);var t=a(".gepPop");setTimeout(function(){t.addClass("cur")},50);new Swiper(".gepPopSwp",{initialSlide:i,pagination:".swiper-pagination-custom",paginationType:"fraction",onSlideChangeEnd:function(a){t.find(".gepPopLook").attr("href","//www.gamersky.com/showimage/id_gamersky.shtml?"+e[a.activeIndex]+"_1920.jpg")}});a(".gepPopClose").on("click",function(){t.removeClass("cur"),setTimeout(function(){t.remove()},250)}),t.find("a").on("click",function(a){a.stopPropagation()})}f.on("click",".liveStreamPic",function(){var e,s=a(this),t=s.closest(".liveStreamPicList"),n=t.data("piclist"),o=s.data("idx");e=n.split(","),i(o,e)})}function m(){var i=u.find(".liveStreamComment"),e="";e+='<div id="SOHUCS" sid="'+v.commentid+'"></div>',i.html(e),a.getScript("//j.gamersky.com/web2015/comment/wapjs/jquery.commentconfig.js?"+(new Date).getTime())}var g,u=a("#liveStream"),v=c[o],f=u.find(".liveStreamList"),h=1,w=10,y="desc",S=!1;p(),i(),d(),r(),m()}function t(){function i(i){var s={type:"getwapspecialpage",isCache:!0,cacheTime:60,specialId:3811,isSpecialId:!0,templatekey:l.tmk,page:i};a.ajax({type:"GET",dataType:"jsonp",url:"//db2.gamersky.com/LabelJsonpAjax.aspx",data:{jsondata:JSON2.stringify(s)},beforeSend:function(){n.addClass("loading").html("加载中")},success:function(i){if(i.status="ok"){d=!1,e=i.totalPages;var s=i.body;t.append(s),n.removeClass("loading").html("查看更多资讯"),a(".cy_comment").cycm(),p===e&&n.addClass("loaded").html("全部加载完成")}}})}var e,s=a(".gsE3NewsArea"),t=a(".gsE3News"),n=s.find(".gsE3MoreBrief"),l=c[o],p=1,d=!1;n.on("click",function(){d===!1&&(d=!0,p++,p<=e&&i(p))}),i(p)}var n=this,o=n.getQueryString("bf");null===o&&(o="ea");var c=window.LiveStreamData;i(),e(),s(),t()},getMoreList:function(){function i(){var i=parseInt(t.attr("data-page"))+1,d={type:"getwapspecialpage",isCache:!0,cacheTime:60,specialId:o,isSpecialId:c,templatekey:l,page:i};a.ajax({type:"GET",dataType:"jsonp",url:"//db2.gamersky.com/LabelJsonpAjax.aspx",data:{jsondata:JSON2.stringify(d)},beforeSend:function(){s.addClass("loading").html("加载中")},success:function(o){if(o.status="ok"){e=o.totalPages;var c=o.body;n.append(c),s.removeClass("loading").html("查看更多资讯"),a(".cy_comment").cycm(),t.attr("data-page",i),i===e?s.addClass("loaded").html("全部加载完成"):p=!1}}})}var e,s=a(".gsE3More"),t=s.closest(".gsE3MoreArea"),n=t.find(".gsE3MoreList"),o=t.data("specialid"),c=t.data("isspecialid"),l=t.data("templatekey"),p=!1;s.on("click",function(){p===!1&&(p=!0,i())})},pagePosition:function(){var i=this,e=a(".gsE3Page"),s=e.data("pos"),t=e.find(".gsE3Nav");t.find(".gsE3Nav"+s).addClass("cur"),"Index"===s?(i.swpTop(),i.swpList(),i.getWant(),i.getMoreList()):"Live"===s?i.getMoreList():"Briefing"===s&&i.BriefingInit()},init:function(){this.pagePosition()}};i.init()}(jQuery);
//# sourceMappingURL=main.min.js.map
