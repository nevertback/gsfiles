{"version":3,"sources":["main.js"],"names":["$","fn","gsPopup","options","addSource","sid","sty","sourceDom","html","addPopup","opts","popupDom","style","append","inTimer","setTimeout","addClass","getScript","Txplayer","containerId","vid","width","height","autoplay","showBullet","showLogo","showRecommendOnEnd","closest","css","removePopup","clearTimeout","removeClass","outTimer","remove","hide","closePopup","on","defaults","afterOpen","optionsEd","extend","btn","this","gerCss","$this","dw","data","dh","diysty","wh","window","popupOptions","pos","diy","offset","top","jQuery","isDrawed","isLogin","lid","prizeCfg","pid","pnm","prizeAlert","notice","repeat","gs","draw","cirTimer","fnTimer","$sel","$start","defaultStyle","selCount","spd","slowRio","animLoop","drawFnc","buildAlert","prizename","alertRepeat","alert","setSelBox","num","endAnim","that","setAnim","cirAnim","animCount","setInterval","anim","loopAnim","loop","animTimer","clearInterval","start","cookie","show","getOl","callback","userInfo","parseJSON","apiCfg","url","jsondata","JSON2","stringify","action","userId","userid","lotteryId","ajax","type","dataType","success","console","log","status","res","result","prizeId","prizeName","each","i","item","match","randomArr","push","rm","Math","round","random","length","bindClick","backId","init"],"mappings":"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","file":"main.min.js","sourcesContent":["(function($){\r\n    $.fn.gsPopup = function(options){\r\n        var defaults = {\r\n        \t//弹出后回调函数\r\n        \tafterOpen:''\r\n\t\t};\r\n        var optionsEd = $.extend(defaults,options);\r\n        var btn = $(this),outTimer,inTimer;\r\n        function addSource(sid,sty) {\r\n            var sourceDom;\r\n            switch (sty) {\r\n                case 'video_tgs':\r\n                    sourceDom = '<embed wmode=\"direct\" flashvars=\"vid=' + sid + '&amp;tpid=0&amp;showend=1&amp;showcfg=1&amp;searchbar=1&amp;skin=http://imgcache.qq.com/minivideo_v1/vd/res/skins/TencentPlayerMiniSkin.swf&amp;shownext=1&amp;list=2&amp;autoplay=1\" src=\"http://imgcache.qq.com/tencentvideo_v1/player/TPout.swf?max_age=86400&amp;v=20140714\" quality=\"high\" name=\"tenvideo_flash_player_1492679771297\" id=\"tenvideo_flash_player_1492679771297\" bgcolor=\"#000000\" width=\"100%\" height=\"100%\" align=\"middle\" allowscriptaccess=\"always\" allowfullscreen=\"true\" type=\"application/x-shockwave-flash\" pluginspage=\"http://get.adobe.com/cn/flashplayer/\">';\r\n                    return sourceDom;\r\n                    break;\r\n                case 'video_tgs2':\r\n                    sourceDom = '<div id=\"tgsVideo\"></div>';\r\n                    return sourceDom;\r\n                    break;\r\n                case 'video_yk':\r\n                    sourceDom = '<embed height=\"100%\" flashvars=\"isAutoPlay=true\" allowscriptaccess=\"sameDomain\" width=\"100%\" align=\"middle\" quality=\"high\" invokeurls=\"false\" src=\"http://player.youku.com/player.php/sid/'+sid+'/v.swf\" type=\"application/x-shockwave-flash\" wmode=\"transparent\">';\r\n                    return sourceDom;\r\n                    break;\r\n                case 'video_bl':\r\n                    sourceDom = '<iframe height=\"100%\" width=\"100%\" id=\"vedioSrc\" frameborder=\"0\" allowfullscreen src=\"'+sid+'\"></iframe>';\r\n                    return sourceDom;\r\n                    break;\r\n                case 'video_other':\r\n                    sourceDom = sid;\r\n                    return sourceDom;\r\n                    break;\r\n                case 'pics':\r\n                    sourceDom = '<img src=\"'+sid+'\" alt=\"popimgs\" width=\"100%\" height=\"100%\">';\r\n                    return sourceDom;\r\n                    break;\r\n                case 'custom':\r\n                    sourceDom = $(sid).html();\r\n                    return sourceDom;\r\n                    break;\r\n            }\r\n        }\r\n        function addPopup(opts) {\r\n            var popupDom = '';\r\n            popupDom += '<div id=\"gsPopupMask\" class=\"gsPopupMask\"></div>';\r\n            popupDom += '<div id=\"gsPopup\" class=\"gsPopup\" style=\"';\r\n            popupDom += opts.style;\r\n            popupDom += '\"><div class=\"gsPopupCon\">';\r\n            popupDom += addSource(opts.sid,opts.sty);\r\n            popupDom += '</div><a  class=\"gsPopupClose\" id=\"gsPopupClose\"></a></div>';\r\n            $('body').append(popupDom);\r\n            inTimer = setTimeout(function () {\r\n                $('#gsPopupMask').addClass('cur');\r\n                $('#gsPopup').addClass('cur');\r\n            },10);\r\n            if(opts.sty === 'video_tgs2'){\r\n                $.getScript(\"http://vm.gtimg.cn/tencentvideo/txp/js/txplayer.js\",function(){\r\n                    var player = new Txplayer({\r\n                        containerId: 'tgsVideo',\r\n                        vid: opts.sid,\r\n                        width: '100%',\r\n                        height: opts.height,\r\n                        autoplay:true,\r\n                        showBullet:false,\r\n                        showLogo: false,\r\n                        showRecommendOnEnd:false\r\n                    });\r\n                    $('#tgsVideo').closest('.gsPopupCon').css('overflow','hidden');\r\n                });\r\n            }\r\n        }\r\n        function removePopup() {\r\n        \tclearTimeout(inTimer);\r\n            $('#gsPopupMask').removeClass('cur');\r\n            $('#gsPopup').removeClass('cur');\r\n            outTimer = setTimeout(function () {\r\n                $('#gsPopupMask').remove();\r\n                $('#gsPopup').hide().remove();\r\n            },150);\r\n        }\r\n        function closePopup() {\r\n            $('#gsPopupClose').on('click',removePopup);\r\n            $('#gsPopupMask').on('click',removePopup);\r\n        }\r\n        btn.on('click',function () {\r\n            clearTimeout(outTimer);\r\n            var $this = $(this),dw = $this.data('w'),dh = $this.data('h'),diysty=$this.data('diy'),\r\n                wh = $(window).height(),gerCss,\r\n                popupOptions = {\r\n                    pos:'fixed',\r\n                    width:dw,\r\n                    height:dh,\r\n                    sid:$this.data('sid'),\r\n                    sty:$this.data('sty'),\r\n                    diy:diysty\r\n                };\r\n            gerCss = 'width:'+popupOptions.width+'px;height:'+popupOptions.height+'px;';\r\n            popupOptions.style = 'position:'+popupOptions.pos+';top:50%;left:50%;margin-left:-'+popupOptions.width/2+'px;margin-top:-'+popupOptions.height/2+'px;'+gerCss;\r\n            if(dh>wh){\r\n                popupOptions.pos = 'absolute';\r\n                popupOptions.style = 'position:'+popupOptions.pos+';top:'+$this.offset().top+'px;left:50%;margin-left:-'+popupOptions.width/2+'px;'+gerCss;\r\n            }\r\n            addPopup(popupOptions);\r\n            closePopup();\r\n            if(typeof optionsEd.afterOpen === 'function'){\r\n                optionsEd.afterOpen();\r\n\t\t\t}\r\n        });\r\n    }\r\n})(jQuery);\r\n$('.popupBtn').gsPopup();\r\n(function ($) {\r\n    var isDrawed = false,isLogin = false,\r\n        lid = 27, //28\r\n        prizeCfg=[\r\n            {\r\n                pid:301,\r\n                pnm:'雷蛇萨诺键盘'\r\n            },\r\n            {\r\n                pid:540, //544\r\n                pnm:'守望手机壳'\r\n            },\r\n            {\r\n                pid:0,\r\n                pnm:'谢谢参与'\r\n            },\r\n            {\r\n                pid:302,\r\n                pnm:'太攀皇蛇钻石星辰版游戏鼠标'\r\n            },\r\n            {\r\n                pid:0,\r\n                pnm:'谢谢参与'\r\n            },\r\n            {\r\n                pid:542, //545\r\n                pnm:'温斯顿小手办'\r\n            },\r\n            {\r\n                pid:543, //546\r\n                pnm:'战网点1000点'\r\n            },\r\n            {\r\n                pid:0,\r\n                pnm:'谢谢参与'\r\n            }\r\n        ],\r\n        prizeAlert = false,\r\n        notice = {\r\n        repeat:'同一用户有1次抽奖机会哟~'\r\n    };\r\n\tvar gs = {\r\n        draw:function () {\r\n            var $sel = $('#drawSel'),\r\n                $start = $('#drawBegin'),\r\n                defaultStyle = 'draw-select',\r\n                selCount = 0,\r\n                cirTimer,fnTimer,spd = 500,slowRio = 3,animLoop = 3;\r\n            var drawFnc = {\r\n                buildAlert:function (prizename) {\r\n                    return '恭喜您获得'+prizename+'请关注站内通知';\r\n                },\r\n                alertRepeat:function () {\r\n                    alert(notice.repeat);\r\n                },\r\n                setSelBox:function (num) {\r\n                    $sel.removeClass().addClass(defaultStyle+' '+defaultStyle+num);\r\n                },\r\n                endAnim:function () {\r\n                    var that = this;\r\n                    that.setAnim(selCount);\r\n                    //确保最终位置\r\n                    setTimeout(function () {\r\n                        that.setSelBox(selCount);\r\n                        if(prizeAlert){\r\n                            alert(prizeAlert);\r\n                        }\r\n                    },spd*slowRio+1000);\r\n\r\n                },\r\n                cirAnim:function () {\r\n                    var that = this,animCount = 0;\r\n                    cirTimer = setInterval(function () {\r\n                        animCount++;\r\n                        if(animCount > 7){\r\n                            animCount = 0;\r\n                        }\r\n                        that.setSelBox(animCount);\r\n                    },spd/8);\r\n                },\r\n                setAnim:function (num) {\r\n                    var that = this,animCount = 0;\r\n                    fnTimer = setInterval(function () {\r\n                        animCount++;\r\n                        if(animCount <= num){\r\n                            that.setSelBox(animCount);\r\n                        }\r\n                    },spd*slowRio/8);\r\n                },\r\n                anim:function () {\r\n                    var that = this,loop = animLoop,animTimer;\r\n                    that.cirAnim();\r\n                    function loopAnim() {\r\n                        loop--;\r\n                        animTimer = setTimeout(function () {\r\n                            if(loop >0){\r\n                                loopAnim();\r\n                            }else{\r\n                                clearInterval(cirTimer);\r\n                                clearTimeout(animTimer);\r\n                                that.endAnim();\r\n                            }\r\n                        },spd);\r\n                    }\r\n                    loopAnim();\r\n                },\r\n                start:function (num) {\r\n                    selCount = num;\r\n                    this.anim();\r\n                },\r\n                isLogin:function () {\r\n                    if(typeof $.cookie(\"UserCookie\") === 'undefined'){\r\n                        $('.QZshade,.QZlogin').show();\r\n                        return false;\r\n                    }else{\r\n                        return true;\r\n                    }\r\n                },\r\n                getOl:function (callback) {\r\n                    var userInfo = $.parseJSON($.cookie(\"UserCookie\")),that = this;\r\n                    var apiCfg = {\r\n                        url:'http://db5.gamersky.com/LotteryAjax.aspx',\r\n                        data:{\r\n                            jsondata:JSON2.stringify({\r\n                                action:\"sweepstakes\",\r\n                                userId:userInfo.userid,\r\n                                lotteryId:lid\r\n                            })\r\n                        }\r\n                    };\r\n                    $.ajax({\r\n                        type: \"GET\",\r\n                        url:apiCfg.url,\r\n                        dataType:'jsonp',\r\n                        data:apiCfg.data,\r\n                        success:function (data) {\r\n                            isDrawed = true;\r\n                            console.log(data);\r\n                            if(data.status === 'ok'){\r\n                                var res = data.result[0],pid = res.prizeId;\r\n                                prizeAlert = that.buildAlert(res.prizeName);\r\n                                $.each(prizeCfg,function (i,item) {\r\n                                    if(item.pid === pid){\r\n                                        callback(i);\r\n                                    }\r\n                                });\r\n                            }else{\r\n                                if(data.result.match('同一用户只能抽') !== null&&typeof data.result.match('同一用户只能抽') === 'object'){\r\n                                    that.alertRepeat();\r\n                                }else{\r\n                                    var randomArr = [];\r\n                                    $.each(prizeCfg,function (i,item) {\r\n                                        if(item.pid === 0){\r\n                                            randomArr.push(i)\r\n                                        }\r\n                                    });\r\n                                    var rm = Math.round(Math.random()*(randomArr.length-1));\r\n                                    callback(randomArr[rm]);\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                },\r\n                bindClick:function () {\r\n                    var that = this;\r\n                    $start.on('click',function () {\r\n                        isLogin = that.isLogin();\r\n                        if(isLogin === true){\r\n                            if(isDrawed === false){\r\n                                that.getOl(function (backId) {\r\n                                    that.start(backId);\r\n                                });\r\n                            }else{\r\n                                that.alertRepeat();\r\n                            }\r\n                        }\r\n                    });\r\n                },\r\n                init:function () {\r\n                    this.setSelBox(selCount);\r\n                    this.bindClick();\r\n                }\r\n            };\r\n            drawFnc.init();\r\n        },\r\n        init:function () {\r\n            this.draw();\r\n        }\r\n\t};\r\n    gs.init();\r\n})(jQuery);"]}